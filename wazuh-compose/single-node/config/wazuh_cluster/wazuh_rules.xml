<group name="custom_rules">
  <rule id="100100" level="5">
    <description>Detects multiple failed SSH login attempts within a short period, indicative of a brute-force attack</description>
    <match>sshd\[\d+\]: Failed password for .* from .* port \d+ ssh2</match>
    <group>SSH Brute-force</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="100101" level="4">
    <description>Detects successful SSH login after multiple failed attempts, which may indicate a successful brute-force attack</description>
    <match>sshd\[\d+\]: Accepted password for .* from .* port \d+ ssh2</match>
    <group>SSH Brute-force</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="100102" level="5">
    <description>Detects the usage of unauthorized SSH keys, which may indicate unauthorized access</description>
    <match>sshd\[\d+\]: Accepted publickey for .* from .* port \d+ ssh2: .*</match>
    <group>Unauthorized SSH Key Usage</group>
    <mitre>
      <id>T1078.004</id>
    </mitre>
  </rule>
  <rule id="100103" level="4">
    <description>Detects the addition of new SSH keys to authorized_keys file, possibly indicating unauthorized SSH key installation</description>
    <match>echo .* &gt;&gt; ~/.ssh/authorized_keys</match>
    <group>Unauthorized SSH Key Usage</group>
    <mitre>
      <id>T1098.004</id>
    </mitre>
  </rule>
  <rule id="100104" level="3">
    <description>Detects abnormal SSH login times, such as logins during unusual hours</description>
    <match>sshd\[\d+\]: Accepted password for .* from .* port \d+ ssh2</match>
    <group>Suspicious SSH Activity</group>
    <mitre>
      <id>T1036.004</id>
    </mitre>
  </rule>
  <rule id="100105" level="9">
    <description>Detects unauthorized Docker container creation attempts</description>
    <match>sudo docker (run|create)</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1609</id>
    </mitre>
  </rule>
  <rule id="100106" level="8">
    <description>Monitors for Docker container deployments from untrusted sources</description>
    <match>docker pull (?!.*trusted_repo)</match>
    <group>Untrusted Source</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100107" level="7">
    <description>Detects suspicious Docker configuration changes, such as enabling privileged mode</description>
    <match>sudo docker run .*--privileged</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1036.004</id>
    </mitre>
  </rule>
  <rule id="100108" level="9">
    <description>Alerts on attempts to escalate privileges within Docker containers</description>
    <match>docker exec .*--user root</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100109" level="10">
    <description>Detects the use of Docker escape techniques to break out of containers</description>
    <match>mount --bind / /mnt</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="100110" level="5">
    <description>Detects unauthorized attempts to create Docker containers using 'docker run' command</description>
    <match>sudo\s+docker\s+run\s+.*</match>
    <group>Unauthorized Docker Deployment</group>
    <mitre>
      <id>T1609</id>
    </mitre>
  </rule>
  <rule id="100111" level="4">
    <description>Detects attempts to execute Docker commands from a non-root user without proper privileges</description>
    <match>docker\s+[a-zA-Z]+\s+.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="100112" level="4">
    <description>Detects anomalous Docker container creation with excessive resource allocation</description>
    <match>docker\s+run\s+.*(--memory|-m|--cpus)\s+.*</match>
    <group>Resource Abuse</group>
    <mitre>
      <id>T1496</id>
    </mitre>
  </rule>
  <rule id="100113" level="3">
    <description>Detects Docker container deployments from suspicious sources by monitoring the use of non-standard images</description>
    <match>docker\s+run\s+.*\s+[^\s]+/[^\s]+:\S+</match>
    <group>Suspicious Image Source</group>
    <mitre>
      <id>T1074</id>
    </mitre>
  </rule>
  <rule id="100114" level="5">
    <description>Detects attempts to start Docker containers with overly permissive security options</description>
    <match>docker\s+run\s+.*(--privileged|--cap-add|--security-opt)\s+.*</match>
    <group>Security Misconfiguration</group>
    <mitre>
      <id>T1047</id>
    </mitre>
  </rule>
  <rule id="100115" level="5">
    <description>Detect unauthorized modification of /etc/passwd file, indicating possible privilege escalation attempt.</description>
    <match>^\s*chattr\s*\-i\s+/etc/passwd\s*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100116" level="4">
    <description>Detect creation or modification of hidden files in high-value directories, indicating potential persistence mechanisms.</description>
    <match>^\s*(touch|echo|cat)\s+\.[^/]+\s*</match>
    <group>Persistence</group>
    <mitre>
      <id>T1158</id>
    </mitre>
  </rule>
  <rule id="100117" level="5">
    <description>Detect unauthorized modification of /etc/ssh/sshd_config file, indicating potential backdoor installation.</description>
    <match>^\s*echo\s+&quot;PermitRootLogin\s+yes&quot;\s*&gt;&gt;\s+/etc/ssh/sshd_config\s*</match>
    <group>Backdoor</group>
    <mitre>
      <id>T1169</id>
    </mitre>
  </rule>
  <rule id="100118" level="5">
    <description>Detect changes to critical binaries in /usr/bin and /bin, indicating possible trojaned binaries.</description>
    <match>^\s*cp\s+[^\s]+\s+/usr/bin/[^\s]+\s*</match>
    <group>Trojan</group>
    <mitre>
      <id>T1105</id>
    </mitre>
  </rule>
  <rule id="100119" level="4">
    <description>Detect unauthorized modification of /var/log files, indicating potential log tampering to cover tracks.</description>
    <match>^\s*(rm|echo|cat)\s+/var/log/[^\s]+\s*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100120" level="5">
    <description>Detects large volume of outbound data transfers, indicating potential data exfiltration.</description>
    <match>.*\s-w\s[0-9]{3,}\s.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100121" level="4">
    <description>Detects outbound connections to known malicious IP addresses, indicative of data exfiltration or command-and-control.</description>
    <match>.*\s-d\s(\d{1,3}\.){3}\d{1,3}\s.*</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100122" level="4">
    <description>Detects unusual outbound traffic patterns that deviate from normal behavior, possibly indicating exfiltration.</description>
    <match>.*\s-p\s[1-9]\d{1,3}\s.*</match>
    <group>Anomalous Activity</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="100123" level="3">
    <description>Detects outbound traffic to high-risk domains, suggesting a potential data breach.</description>
    <match>.*\s-d\s[a-zA-Z0-9.-]+\.(ru|cn|kp|ir|sy)\s.*</match>
    <group>Suspicious Domain</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100124" level="3">
    <description>Detects outbound traffic over uncommon ports, indicating potential exfiltration channels.</description>
    <match>.*\s-p\s(\d{5,}|\d{1,2}|\d{4})\s.*</match>
    <group>Unusual Port Activity</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100125" level="5">
    <description>Detects attempts to disable SELinux by modifying the configuration file</description>
    <match>sed -i 's/SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100126" level="4">
    <description>Detects usage of setenforce command to change SELinux mode to permissive or disabled</description>
    <match>setenforce\s+(0|permissive|disabled)</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100127" level="5">
    <description>Detects SELinux module unload operations</description>
    <match>semodule -r</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100128" level="4">
    <description>Detects attempts to modify SELinux policies directly</description>
    <match>audit2allow|audit2why|semanage</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100129" level="5">
    <description>Detects removal of SELinux packages</description>
    <match>rpm -e selinux-policy|yum remove selinux-policy</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100130" level="9">
    <description>Detects large volume of outbound traffic to unknown IP addresses, potentially indicating data exfiltration.</description>
    <match>^.*\s+OUTBOUND\s+.*\s+[0-9]{1,5}\s+\d{2,}\.\d{2,}\.\d{2,}\.\d{2,}.*$</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048.003</id>
    </mitre>
  </rule>
  <rule id="100131" level="10">
    <description>Monitors outbound traffic to known malicious IP addresses.</description>
    <match>^.*\s+OUTBOUND\s+.*\s+(8\.8\.8\.8|1\.1\.1\.1|203\.0\.113\.0).*$</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048.003</id>
    </mitre>
  </rule>
  <rule id="100132" level="8">
    <description>Tracks high-frequency outbound connections to a single IP, indicating potential beaconing behavior for data exfiltration.</description>
    <match>^.*\s+OUTBOUND\s+.*\s+([0-9]{1,5})\s+\d{2,}\.\d{2,}\.\d{2,}\.\d{2,}.*$</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100133" level="7">
    <description>Detects outbound traffic on uncommon ports, which could indicate data exfiltration via non-standard protocols.</description>
    <match>^.*\s+OUTBOUND\s+.*\s+(1025|3389|8080)\s+.*$</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048.003</id>
    </mitre>
  </rule>
  <rule id="100134" level="6">
    <description>Monitors outbound traffic spikes during non-business hours, indicating potential unauthorized data transfer.</description>
    <match>^.*\s+OUTBOUND\s+.*\s+\d{2,}\.\d{2,}\.\d{2,}\.\d{2,}.*\s+(00|01|02|03|04|05|22|23):[0-5][0-9].*$</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1029</id>
    </mitre>
  </rule>
  <rule id="100135" level="5">
    <description>Detect attempts to disable SELinux via setenforce 0 command</description>
    <match>setenforce\s+0</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100136" level="4">
    <description>Detect modification of SELinux config file to disable SELinux on reboot</description>
    <match>sed\s+-i\s+'s/SELINUX=enforcing/SELINUX=disabled/'\s+/etc/selinux/config</match>
    <group>SELinux Configuration Tampering</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100137" level="4">
    <description>Detect usage of semanage to modify SELinux policy to permissive</description>
    <match>semanage\s+permissive\s+-a\s+.*</match>
    <group>SELinux Policy Modification</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100138" level="5">
    <description>Detect attempts to disable SELinux via kernel boot parameters</description>
    <match>kernel\.command_line.*selinux=0</match>
    <group>Kernel Parameter Manipulation</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100139" level="3">
    <description>Detect attempts to remove SELinux packages via package manager</description>
    <match>(yum|apt-get|dnf)\s+remove\s+-y\s+selinux\*</match>
    <group>SELinux Package Removal</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100140" level="9">
    <description>Detection of SELinux being disabled using setenforce command</description>
    <match>setenforce\s+0</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100141" level="8">
    <description>Detection of SELinux configuration file being modified to permissive mode</description>
    <match>sed\s+-i\s+'s/SELINUX=enforcing/SELINUX=permissive/'\s+/etc/selinux/config</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100142" level="7">
    <description>Detection of the SELinux policy being reloaded to permissive mode</description>
    <match>load_policy\s+permissive</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100143" level="8">
    <description>Detection of SELinux being disabled via kernel boot parameter</description>
    <match>selinux=0</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100144" level="7">
    <description>Detection of SELinux mode being set to permissive using echo command</description>
    <match>echo\s+0\s+&gt;\s+/sys/fs/selinux/enforce</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100145" level="9">
    <description>Detects large outbound data transfers to external IP addresses, which may indicate data exfiltration.</description>
    <match>(?:\b(?:[1-9]?[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}\b(?:[1-9]?[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]):([1-9]?[0-9]{1,4}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100146" level="8">
    <description>Identifies unusual outbound traffic to known malicious IP addresses.</description>
    <match>(\b(?:[1-9]?[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}\b(?:[1-9]?[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]):([1-9]?[0-9]{1,4}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])</match>
    <group>Malware Communication</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100147" level="7">
    <description>Detects outbound traffic containing sensitive data patterns such as credit card numbers.</description>
    <match>\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|6(?:011|5[0-9]{2})[0-9]{12}|(?:2131|1800|35\d{3})\d{11})\b</match>
    <group>Data Leakage</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="100148" level="6">
    <description>Monitors for outbound traffic to rare or unusual geographic locations, indicating potential exfiltration.</description>
    <match>(?:\b(?:[1-9]?[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}\b(?:[1-9]?[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])</match>
    <group>Geographic Anomalies</group>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>
  <rule id="100149" level="5">
    <description>Flags outbound traffic using non-standard ports, which can indicate attempts to bypass security controls.</description>
    <match>:([1-9]?[0-9]{1,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])</match>
    <group>Port Anomalies</group>
    <mitre>
      <id>T1043</id>
    </mitre>
  </rule>
  <rule id="100150" level="5">
    <description>Detect unauthorized changes to /etc/passwd, which could indicate privilege escalation attempts.</description>
    <match>^/etc/passwd$</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100151" level="5">
    <description>Monitor for modifications to /etc/shadow, commonly targeted for password cracking and privilege escalation.</description>
    <match>^/etc/shadow$</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1003</id>
    </mitre>
  </rule>
  <rule id="100152" level="4">
    <description>Track changes to /etc/hosts, which can be used for DNS spoofing and redirecting network traffic.</description>
    <match>^/etc/hosts$</match>
    <group>Network Manipulation</group>
    <mitre>
      <id>T1565</id>
    </mitre>
  </rule>
  <rule id="100153" level="4">
    <description>Detect alterations to /var/log/auth.log, indicating potential attempts to cover tracks.</description>
    <match>^/var/log/auth.log$</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100154" level="5">
    <description>Monitor changes to /root/.ssh/authorized_keys, which could be used for unauthorized access.</description>
    <match>^/root/.ssh/authorized_keys$</match>
    <group>Persistence</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100155" level="5">
    <description>Detects attempts to disable SELinux by setting SELINUX=disabled in /etc/selinux/config</description>
    <match>SELINUX\s*=\s*disabled</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100156" level="4">
    <description>Detects commands attempting to disable SELinux enforcement</description>
    <match>setenforce\s+0</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100157" level="5">
    <description>Detects modifications to SELinux policy files which could indicate an attempt to weaken SELinux protections</description>
    <match>/etc/selinux/.*\.pp</match>
    <group>SELinux Policy Modification</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100158" level="3">
    <description>Detects attempts to execute SELinux management tools with suspicious options</description>
    <match>semanage\s+.*(boolean\s+-m\s+|fcontext\s+.*-a\s+|module\s+-d\s+)</match>
    <group>SELinux Management</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100159" level="4">
    <description>Detects suspicious usage of SELinux permissive command</description>
    <match>setenforce\s+permissive</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100160" level="5">
    <description>Detects large volumes of outbound traffic to a single IP, indicating potential data exfiltration.</description>
    <match>.*\s+[0-9]{1,3}(\.[0-9]{1,3}){3}\s+.*\s+\d+\s+.*\s+\d{5,}\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048.001</id>
    </mitre>
  </rule>
  <rule id="100161" level="4">
    <description>Detects unusual outbound traffic on non-standard ports that may indicate command and control communication.</description>
    <match>.*\s+[0-9]{1,3}(\.[0-9]{1,3}){3}\s+.*\s+\d+\s+.*\s+(?!80|443|22)\d{1,5}\s+.*</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100162" level="4">
    <description>Detects outbound traffic to blacklisted IPs known for malicious activities.</description>
    <match>.*\s+(198\.51\.100\.0|203\.0\.113\.0|192\.0\.2\.0)\s+.*</match>
    <group>Malicious IP</group>
    <mitre>
      <id>T1048.003</id>
    </mitre>
  </rule>
  <rule id="100163" level="3">
    <description>Detects unusual outbound DNS queries that may indicate DNS tunneling.</description>
    <match>.*\s+\S+\.\S+\.\S+\.\S+\.\S+\s+.*</match>
    <group>DNS Tunneling</group>
    <mitre>
      <id>T1071.004</id>
    </mitre>
  </rule>
  <rule id="100164" level="5">
    <description>Detects high-frequency outbound connections to external IPs within a short time frame, indicating potential data exfiltration.</description>
    <match>.*\s+[0-9]{1,3}(\.[0-9]{1,3}){3}\s+.*\s+\d{1,5}\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048.002</id>
    </mitre>
  </rule>
  <rule id="100165" level="5">
    <description>Detect unauthorized modification of system binaries in /bin or /sbin directories</description>
    <match>(/bin/|/sbin/).*(chmod|chown|cp|mv)</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1070.004</id>
    </mitre>
  </rule>
  <rule id="100166" level="4">
    <description>Monitor for changes in SSH configuration files in /etc/ssh</description>
    <match>/etc/ssh/.*(sshd_config|ssh_config)</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100167" level="5">
    <description>Detect creation or modification of hidden files in high-value directories</description>
    <match>(/etc/|/var/|/usr/).*/\..*</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1158</id>
    </mitre>
  </rule>
  <rule id="100168" level="5">
    <description>Monitor for changes to /etc/passwd or /etc/shadow files indicating potential user account compromise</description>
    <match>/etc/(passwd|shadow).*</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1003.008</id>
    </mitre>
  </rule>
  <rule id="100169" level="4">
    <description>Detect unauthorized changes to critical system logs in /var/log</description>
    <match>/var/log/.*(auth.log|secure|messages|syslog)</match>
    <group>Log Tampering</group>
    <mitre>
      <id>T1070.001</id>
    </mitre>
  </rule>
  <rule id="100170" level="9">
    <description>Detects unusually high volume of outbound traffic indicating potential data exfiltration</description>
    <match>^(?:.*\s+)?(tcp|udp)\s+\d+\s+\d+\s+(?:[0-9]{1,3}\.){3}[0-9]{1,3}\s+\d+\s+\d{5,}.*$</match>
    <group>Network Activity</group>
    <mitre>
      <id>T1048.001</id>
    </mitre>
  </rule>
  <rule id="100171" level="10">
    <description>Detects outbound traffic to known malicious IP addresses</description>
    <match>^(?:.*\s+)?(tcp|udp)\s+\d+\s+\d+\s+(?:[0-9]{1,3}\.){3}[0-9]{1,3}\s+\d+.*\s+(?:1\.1\.1\.1|8\.8\.8\.8).*</match>
    <group>Network Activity</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100172" level="8">
    <description>Detects outbound traffic on non-standard ports which may indicate tunneling</description>
    <match>^(?:.*\s+)?(tcp|udp)\s+\d+\s+\d+\s+(?:[0-9]{1,3}\.){3}[0-9]{1,3}\s+(?!(80|443|53)\b)\d{2,5}.*$</match>
    <group>Network Activity</group>
    <mitre>
      <id>T1090.002</id>
    </mitre>
  </rule>
  <rule id="100173" level="7">
    <description>Detects outbound connections to rare domains that may indicate domain generation algorithm (DGA) activity</description>
    <match>^(?:.*\s+)?(tcp|udp)\s+\d+\s+\d+\s+(?:[0-9]{1,3}\.){3}[0-9]{1,3}\s+\d+\s+\S*\.(xyz|top|info).*</match>
    <group>Network Activity</group>
    <mitre>
      <id>T1071.004</id>
    </mitre>
  </rule>
  <rule id="100174" level="8">
    <description>Detects frequent outbound SSH connections which may indicate unauthorized access</description>
    <match>^(?:.*\s+)?(tcp|udp)\s+\d+\s+22\s+(?:[0-9]{1,3}\.){3}[0-9]{1,3}\s+\d+.*$</match>
    <group>Network Activity</group>
    <mitre>
      <id>T1021.004</id>
    </mitre>
  </rule>
  <rule id="100175" level="4">
    <description>Detect unauthorized Docker container deployments using 'docker run' by non-administrative users.</description>
    <match>\bsudo\s+docker\s+run\b</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="100176" level="5">
    <description>Detect Docker container deployments with privileged mode enabled, which could lead to privilege escalation.</description>
    <match>\bdocker\s+run\s+--privileged\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100177" level="4">
    <description>Monitor for Docker containers being launched with sensitive host volume mounts.</description>
    <match>\bdocker\s+run\s+.*-v\s+/etc/passwd:/etc/passwd\b</match>
    <group>Sensitive Data Exposure</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100178" level="3">
    <description>Detect Docker deployments with potentially malicious container images from untrusted registries.</description>
    <match>\bdocker\s+run\s+.*\b(?:untrusted_registry|malicious_image)\b</match>
    <group>Supply Chain Compromise</group>
    <mitre>
      <id>T1195</id>
    </mitre>
  </rule>
  <rule id="100179" level="3">
    <description>Monitor Docker events for unusual restart policies which might indicate persistence mechanisms.</description>
    <match>\bdocker\s+run\s+.*--restart\s+always\b</match>
    <group>Persistence</group>
    <mitre>
      <id>T1504</id>
    </mitre>
  </rule>
  <rule id="100180" level="9">
    <description>Detection of SELinux being set to permissive mode via setenforce command</description>
    <match>setenforce\s+0</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100181" level="8">
    <description>Detection of SELinux being disabled by modifying the SELinux configuration file</description>
    <match>(?i)^SELINUX\s*=\s*disabled</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100182" level="8">
    <description>Detection of SELinux being disabled via kernel boot parameters</description>
    <match>(?i)selinux=0</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100183" level="7">
    <description>Detection of suspicious chmod commands that could affect SELinux policy files</description>
    <match>chmod\s+\d{3,4}\s+/etc/selinux/.*</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100184" level="7">
    <description>Detection of suspicious chcon commands that could alter SELinux security contexts</description>
    <match>chcon\s+--reference=.*\s+/etc/selinux/.*</match>
    <group>SELinux Bypass</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100185" level="5">
    <description>Detect multiple failed SSH login attempts indicating a brute-force attack.</description>
    <match>Failed password for .* from .* port .* ssh2</match>
    <group>SSH Brute Force</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="100186" level="4">
    <description>Detect successful SSH login from a previously unused IP address, indicating possible unauthorized access.</description>
    <match>Accepted password for .* from .* port .* ssh2</match>
    <group>Unauthorized SSH Access</group>
    <mitre>
      <id>T1078.004</id>
    </mitre>
  </rule>
  <rule id="100187" level="4">
    <description>Detect addition of new SSH keys to authorized_keys file, which may indicate unauthorized key insertion.</description>
    <match>echo 'ssh-rsa .*' &gt;&gt; ~/.ssh/authorized_keys</match>
    <group>Unauthorized SSH Key Usage</group>
    <mitre>
      <id>T1098.004</id>
    </mitre>
  </rule>
  <rule id="100188" level="3">
    <description>Detect SSH login attempts with non-existent users, indicating a brute-force attack on usernames.</description>
    <match>Invalid user .* from .* port .*</match>
    <group>SSH Brute Force</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="100189" level="2">
    <description>Detect use of SSH protocol version 1, which is deprecated and may indicate an attempt to exploit known vulnerabilities.</description>
    <match>SSH-1.5-.*</match>
    <group>Deprecated Protocol Usage</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100190" level="10">
    <description>Detect unauthorized modifications to /etc/shadow file, which stores user passwords.</description>
    <match>^.*(/etc/shadow).*(MODIFY|DELETE).*$</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100191" level="9">
    <description>Monitor changes to critical system binaries in /bin directory.</description>
    <match>^.*(/bin/).*(MODIFY|DELETE).*$</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1089</id>
    </mitre>
  </rule>
  <rule id="100192" level="8">
    <description>Detect unauthorized modifications to SSH configuration files in /etc/ssh directory.</description>
    <match>^.*(/etc/ssh/).*(MODIFY|DELETE).*$</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100193" level="8">
    <description>Monitor changes to sudoers file which controls user privileges.</description>
    <match>^.*(/etc/sudoers).*(MODIFY|DELETE).*$</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100194" level="7">
    <description>Detect modifications to system log files in /var/log directory.</description>
    <match>^.*(/var/log/).*(MODIFY|DELETE).*$</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100195" level="5">
    <description>Detects multiple failed SSH login attempts indicating a potential brute-force attack</description>
    <match>Failed password for (invalid user|\S+) from [\d.]+ port \d+ ssh2</match>
    <group>SSH Brute-force</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="100196" level="4">
    <description>Detects successful SSH login attempts after a series of failed attempts which may indicate a brute-force attack</description>
    <match>(Accepted password for (invalid user|\S+) from [\d.]+ port \d+ ssh2).*(Failed password for (invalid user|\S+) from [\d.]+ port \d+ ssh2){3,}</match>
    <group>SSH Brute-force</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="100197" level="4">
    <description>Detects the addition of new SSH keys to the authorized_keys file, which can indicate unauthorized access</description>
    <match>^.*(echo|cat).*ssh-rsa.*&gt;&gt;.*\.ssh/authorized_keys</match>
    <group>Unauthorized SSH Key</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100198" level="5">
    <description>Detects suspicious activity by monitoring for SSH login attempts from blacklisted IP addresses</description>
    <match>Failed password for (invalid user|\S+) from (10\.0\.0\.1|10\.0\.0\.2|10\.0\.0\.3) port \d+ ssh2</match>
    <group>SSH Brute-force</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="100199" level="3">
    <description>Detects extensive usage of SSH keys within a short period which may indicate key abuse</description>
    <match>Accepted publickey for (invalid user|\S+) from [\d.]+ port \d+ ssh2.*(Accepted publickey for (invalid user|\S+) from [\d.]+ port \d+ ssh2){5,}</match>
    <group>Unauthorized SSH Key</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100200" level="9">
    <description>Detect unauthorized modifications to /etc/passwd file, which can indicate user enumeration or privilege escalation.</description>
    <match>^/etc/passwd$</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100201" level="8">
    <description>Monitor changes to /etc/ssh/sshd_config, indicating potential unauthorized SSH configuration changes.</description>
    <match>^/etc/ssh/sshd_config$</match>
    <group>Initial Access</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100202" level="9">
    <description>Detect modifications to /etc/sudoers file, which can grant unauthorized sudo privileges.</description>
    <match>^/etc/sudoers$</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1548</id>
    </mitre>
  </rule>
  <rule id="100203" level="8">
    <description>Monitor changes to critical binaries in /bin directory, which can indicate binary replacement or trojanization.</description>
    <match>^/bin/.*$</match>
    <group>Execution</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="100204" level="7">
    <description>Detect unauthorized modifications to /var/log/auth.log, which can indicate log tampering to cover tracks.</description>
    <match>^/var/log/auth.log$</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100205" level="5">
    <description>Monitor for unauthorized changes in /etc/passwd file, indicating potential user account tampering.</description>
    <match>^/etc/passwd$</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100206" level="5">
    <description>Detect modifications in /etc/shadow file, which could indicate attempts to alter password hashes.</description>
    <match>^/etc/shadow$</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1556</id>
    </mitre>
  </rule>
  <rule id="100207" level="4">
    <description>Watch for changes in /etc/ssh/sshd_config, signaling possible SSH configuration tampering.</description>
    <match>^/etc/ssh/sshd_config$</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1600</id>
    </mitre>
  </rule>
  <rule id="100208" level="4">
    <description>Monitor alterations in /etc/sudoers file, which could indicate privilege escalation attempts.</description>
    <match>^/etc/sudoers$</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1548</id>
    </mitre>
  </rule>
  <rule id="100209" level="5">
    <description>Detect changes in critical binary directories like /bin and /sbin, which could indicate malicious binary replacements.</description>
    <match>^(/bin/|/sbin/).*</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100210" level="5">
    <description>Detects multiple failed SSH login attempts from a single IP address, indicating a possible brute-force attack.</description>
    <match>sshd\[\d+\]: Failed password for .* from (\d+\.\d+\.\d+\.\d+)</match>
    <group>SSH Brute-Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100211" level="4">
    <description>Detects successful SSH login after several failed attempts, which may indicate a successful brute-force attack.</description>
    <match>sshd\[\d+\]: Accepted .* password for .* from (\d+\.\d+\.\d+\.\d+) .*</match>
    <group>SSH Brute-Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100212" level="5">
    <description>Detects unauthorized SSH key usage from an IP address not previously associated with the user.</description>
    <match>sshd\[\d+\]: Accepted publickey for .* from (\d+\.\d+\.\d+\.\d+)</match>
    <group>Unauthorized SSH Key Usage</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100213" level="4">
    <description>Detects addition of new SSH keys to authorized_keys file, which may indicate an unauthorized access attempt.</description>
    <match>echo .* &gt;&gt; ~/.ssh/authorized_keys</match>
    <group>Unauthorized SSH Key Usage</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100214" level="3">
    <description>Detects SSH login attempts using root account, which is generally considered risky and should be monitored.</description>
    <match>sshd\[\d+\]: .* root from (\d+\.\d+\.\d+\.\d+)</match>
    <group>SSH Brute-Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100215" level="5">
    <description>Detect unauthorized Docker container creation attempts</description>
    <match>docker run --name [^ ]+</match>
    <group>unauthorized-container</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="100216" level="4">
    <description>Monitor Docker daemon socket access</description>
    <match>(/var/run/docker.sock)</match>
    <group>unauthorized-access</group>
    <mitre>
      <id>T1529</id>
    </mitre>
  </rule>
  <rule id="100217" level="5">
    <description>Detect Docker container privilege escalation attempts</description>
    <match>docker exec -u root [^ ]+</match>
    <group>privilege-escalation</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="100218" level="4">
    <description>Monitor attempts to modify Docker configuration files</description>
    <match>(echo|sed|vim|nano) [^ ]+ /etc/docker/daemon.json</match>
    <group>configuration-change</group>
    <mitre>
      <id>T1553</id>
    </mitre>
  </rule>
  <rule id="100219" level="3">
    <description>Detect suspicious network activity within Docker containers</description>
    <match>docker network connect [^ ]+</match>
    <group>suspicious-network</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100220" level="5">
    <description>Detects attempts to run a Docker container with a privileged flag</description>
    <match>docker run.*--privileged</match>
    <group>Unauthorized Docker Deployment</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100221" level="4">
    <description>Detects the usage of Docker exec command to access a running container</description>
    <match>docker exec.*</match>
    <group>Unauthorized Docker Access</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100222" level="4">
    <description>Detects the creation of a new Docker container with a host network</description>
    <match>docker run.*--network host</match>
    <group>Network Misconfiguration</group>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>
  <rule id="100223" level="3">
    <description>Detects suspicious activity of pulling a Docker image from an untrusted registry</description>
    <match>docker pull.*myuntrustedregistry\.com</match>
    <group>Untrusted Docker Image</group>
    <mitre>
      <id>T1608</id>
    </mitre>
  </rule>
  <rule id="100224" level="5">
    <description>Detects the usage of Docker API without proper authentication</description>
    <match>curl.*unix:///var/run/docker.sock</match>
    <group>Unauthorized API Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100225" level="5">
    <description>Detect multiple failed SSH login attempts within a short period, indicating a brute-force attack.</description>
    <match>Failed password for .* from .* port .* ssh2</match>
    <group>SSH Brute-Force</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="100226" level="4">
    <description>Detect successful SSH login from an unusual or blacklisted IP address.</description>
    <match>Accepted password for .* from (?:10\.0\.0\.1|192\.168\.1\.100)</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078.004</id>
    </mitre>
  </rule>
  <rule id="100227" level="5">
    <description>Detect usage of unauthorized SSH keys, which may indicate a compromised account.</description>
    <match>Accepted publickey for .* from .* port .* ssh2: RSA .*</match>
    <group>SSH Key Misuse</group>
    <mitre>
      <id>T1552.004</id>
    </mitre>
  </rule>
  <rule id="100228" level="3">
    <description>Detect SSH logins during unusual hours, which may indicate unauthorized access attempts.</description>
    <match>Accepted password for .* from .* port .* ssh2</match>
    <group>Suspicious Activity</group>
    <mitre>
      <id>T1078.004</id>
    </mitre>
  </rule>
  <rule id="100229" level="4">
    <description>Detect SSH login attempts using an invalid username, indicating potential reconnaissance or brute-force activity.</description>
    <match>Invalid user .* from .* port .*</match>
    <group>Reconnaissance</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="100230" level="5">
    <description>Detects multiple failed SSH login attempts indicative of a brute-force attack</description>
    <match>Failed password for invalid user .* from .* port .* ssh2</match>
    <group>SSH Brute Force</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="100231" level="4">
    <description>Detects unauthorized addition of SSH keys to the authorized_keys file</description>
    <match>Accepted publickey for .* from .* port .* ssh2: RSA</match>
    <group>Unauthorized SSH Key Usage</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100232" level="5">
    <description>Detects excessive SSH login attempts from a single IP address within a short time frame</description>
    <match>Failed password for .* from .* port .* ssh2</match>
    <group>SSH Brute Force</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="100233" level="3">
    <description>Detects use of SSH keys not configured in known_hosts file</description>
    <match>POSSIBLE BREAK-IN ATTEMPT! .* from .*</match>
    <group>Unauthorized SSH Key Usage</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100234" level="4">
    <description>Detects SSH login attempts by root user</description>
    <match>Accepted password for root from .* port .* ssh2</match>
    <group>Suspicious SSH Activity</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100235" level="9">
    <description>Detection of SELinux being set to permissive mode</description>
    <match>setenforce\s+0</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1548.002</id>
    </mitre>
  </rule>
  <rule id="100236" level="8">
    <description>Detection of SELinux configuration file modification</description>
    <match>sed\s+-i\s+['&quot;]s/SELINUX=enforcing/SELINUX=disabled/g['&quot;]\s+/etc/selinux/config</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100237" level="7">
    <description>Detection of SELinux being disabled via boot parameters</description>
    <match>echo\s+['&quot;]SELINUX=disabled['&quot;]\s+&gt;&gt;\s+/etc/sysconfig/selinux</match>
    <group>Persistence</group>
    <mitre>
      <id>T1547.001</id>
    </mitre>
  </rule>
  <rule id="100238" level="8">
    <description>Detection of attempts to remove SELinux packages</description>
    <match>yum\s+remove\s+-y\s+selinux\*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1070.004</id>
    </mitre>
  </rule>
  <rule id="100239" level="7">
    <description>Detection of SELinux policy module removal</description>
    <match>semodule\s+-r\s+.*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100240" level="5">
    <description>Detects the use of 'docker run' command with '--privileged' flag, indicative of a high-risk container deployment.</description>
    <match>docker\s+run\s+.*--privileged</match>
    <group>Privileged Container Deployment</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100241" level="4">
    <description>Monitors for Docker commands executed by non-root users, which could indicate potential unauthorized container deployments.</description>
    <match>docker\s+(run|start|create|exec)\s+.*</match>
    <group>Unauthorized User Deployment</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100242" level="4">
    <description>Detects Docker containers being run from images hosted on untrusted repositories, which might contain malicious code.</description>
    <match>docker\s+run\s+.*(untrusted_registry|suspicious_repo)\/.*</match>
    <group>Untrusted Image Source</group>
    <mitre>
      <id>T1195</id>
    </mitre>
  </rule>
  <rule id="100243" level="3">
    <description>Identifies Docker deployments that bind container ports to host system ports below 1024, which generally require elevated privileges.</description>
    <match>docker\s+run\s+.*-p\s+[0-9]{1,3}:</match>
    <group>Low Port Binding</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100244" level="5">
    <description>Tracks the use of 'docker exec' to gain an interactive shell inside a running container, a common method for post-exploitation activities.</description>
    <match>docker\s+exec\s+-it\s+.*sh</match>
    <group>Interactive Shell Access</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100245" level="10">
    <description>Detects the creation of scheduled tasks using 'schtasks' to execute malware.</description>
    <match>(?i)schtasks.* /create .* /tr .*(malware|payload|virus).*</match>
    <group>Malware Execution</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100246" level="9">
    <description>Detects modification of existing scheduled tasks to include malicious commands.</description>
    <match>(?i)schtasks.* /change .* /tr .*(malware|payload|virus).*</match>
    <group>Persistence</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100247" level="9">
    <description>Detects the use of PowerShell to create scheduled tasks for malware execution.</description>
    <match>(?i)powershell.* New-ScheduledTask.* -Action .*Start-Process.*(malware|payload|virus).*</match>
    <group>Malware Execution</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100248" level="8">
    <description>Detects suspicious scheduled task names often used by malware.</description>
    <match>(?i)schtasks.* /create .* /tn .*\b(update|patch|service|install)\b.*</match>
    <group>Malware Execution</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100249" level="7">
    <description>Detects the use of 'at' command to schedule tasks for malware execution.</description>
    <match>(?i)at .* .*(malware|payload|virus).*</match>
    <group>Malware Execution</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100250" level="9">
    <description>Detects creation of suspicious scheduled tasks with names commonly used by malware</description>
    <match>\b(schtasks\.exe|taskeng\.exe)\b.*\b(create|change)\b.*\b(/tn|/tr)\b.*\b(malicious|update|system)\b</match>
    <group>Scheduled Task Creation</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100251" level="8">
    <description>Detects execution of scheduled tasks with unusual scripts or commands</description>
    <match>\b(schtasks\.exe|taskeng\.exe)\b.*\b(/run|/create)\b.*\b(/tr)\b.*\b(powershell|cmd|vbs|js)\b</match>
    <group>Scheduled Task Execution</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100252" level="7">
    <description>Detects scheduled tasks being created or modified by non-administrative users</description>
    <match>\b(schtasks\.exe|taskeng\.exe)\b.*\b(create|change)\b.*\b(/ru)\b.*\b(\S+)\b</match>
    <group>Scheduled Task Privilege Abuse</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100253" level="6">
    <description>Detects scheduled tasks that are set to execute at an unusually high frequency</description>
    <match>\b(schtasks\.exe|taskeng\.exe)\b.*\b(create|change)\b.*\b(/sc)\b.*\b(minute|hourly)\b.*\b(/mo)\b.*\b(1|5|10)\b</match>
    <group>High Frequency Scheduled Tasks</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100254" level="7">
    <description>Detects deletion of scheduled tasks which could indicate cleanup activity by malware</description>
    <match>\b(schtasks\.exe|taskeng\.exe)\b.*\b(delete)\b.*\b(/tn)\b.*</match>
    <group>Scheduled Task Deletion</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100255" level="9">
    <description>Detects creation of scheduled tasks via schtasks.exe for potential malware execution</description>
    <match>.*\\schtasks\.exe.*\/create.*\/tn.*</match>
    <group>Persistence</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100256" level="8">
    <description>Detects suspicious scheduled task creation with hidden task parameter</description>
    <match>.*\\schtasks\.exe.*\/create.*\/tn.*\/tr.*\/f.*</match>
    <group>Persistence</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100257" level="10">
    <description>Detects scheduled task creation with powershell.exe for possible malicious scripts</description>
    <match>.*\\schtasks\.exe.*\/create.*\/tn.*\/tr.*powershell\.exe.*</match>
    <group>Execution</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100258" level="7">
    <description>Detects modification of existing scheduled tasks which could indicate attack persistence</description>
    <match>.*\\schtasks\.exe.*\/change.*\/tn.*</match>
    <group>Persistence</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100259" level="6">
    <description>Detects deletion of scheduled tasks which may indicate an attempt to clean traces of an attack</description>
    <match>.*\\schtasks\.exe.*\/delete.*\/tn.*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100260" level="9">
    <description>Detects brute force attempts through multiple failed RDP login attempts</description>
    <match>EventID=4625.*LogonType=10</match>
    <group>Brute Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100261" level="8">
    <description>Detects successful RDP login from unusual or blacklisted IP addresses</description>
    <match>EventID=4624.*LogonType=10.*IPAddress=(10\.0\.0\.1|192\.168\.1\.[2-254])</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1021.001</id>
    </mitre>
  </rule>
  <rule id="100262" level="7">
    <description>Detects changes to RDP settings, which could indicate an attempt to enable unauthorized access</description>
    <match>EventID=7045.*ServiceName=.*RDP</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100263" level="8">
    <description>Detects attempts to bypass RDP restrictions by enabling the Remote Desktop Protocol</description>
    <match>EventID=7040.*ServiceName=.*TermService.*StartType=2</match>
    <group>Bypass Security</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100264" level="6">
    <description>Detects unusual RDP session durations which might indicate unauthorized access or data exfiltration</description>
    <match>EventID=4779.*SessionDuration&gt;3600</match>
    <group>Suspicious Activity</group>
    <mitre>
      <id>T1021.001</id>
    </mitre>
  </rule>
  <rule id="100265" level="5">
    <description>Detects use of Mimikatz for credential dumping</description>
    <match>.*mimikatz.*</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1003</id>
    </mitre>
  </rule>
  <rule id="100266" level="4">
    <description>Detects suspicious process creation with high privileges</description>
    <match>.*(CreateProcess).*(SYSTEM|Administrator).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1055</id>
    </mitre>
  </rule>
  <rule id="100267" level="4">
    <description>Detects modification of registry keys for auto-elevation</description>
    <match>.*(reg.exe|regedit.exe).*(HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100268" level="3">
    <description>Detects usage of PsExec for remote command execution</description>
    <match>.*psexec.*</match>
    <group>Execution</group>
    <mitre>
      <id>T1569.002</id>
    </mitre>
  </rule>
  <rule id="100269" level="4">
    <description>Detects creation of new local administrator accounts</description>
    <match>.*(net user).*(/add).*(/admin).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1136.001</id>
    </mitre>
  </rule>
  <rule id="100270" level="9">
    <description>Detects unauthorized changes to the AutoRun key in the Windows registry, which is commonly used by malware for persistence.</description>
    <match>.*\\Software\\Microsoft\\Windows\\CurrentVersion\\Run.*</match>
    <group>Persistence</group>
    <mitre>
      <id>T1547.001</id>
    </mitre>
  </rule>
  <rule id="100271" level="8">
    <description>Detects suspicious modifications to the Windows Security Center registry keys, which can indicate attempts to disable security features.</description>
    <match>.*\\System\\CurrentControlSet\\Services\\wscsvc.*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1089</id>
    </mitre>
  </rule>
  <rule id="100272" level="7">
    <description>Detects unauthorized changes to the registry key responsible for enabling Remote Desktop Protocol (RDP), potentially indicating a remote access attempt.</description>
    <match>.*\\System\\CurrentControlSet\\Control\\Terminal Server.*</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1021.001</id>
    </mitre>
  </rule>
  <rule id="100273" level="7">
    <description>Detects changes to the registry key associated with User Account Control (UAC) settings, which can be used by attackers to escalate privileges.</description>
    <match>.*\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1548.002</id>
    </mitre>
  </rule>
  <rule id="100274" level="8">
    <description>Detects modifications to the registry key for Windows Defender settings, indicating potential attempts to disable or alter antivirus protection.</description>
    <match>.*\\Software\\Policies\\Microsoft\\Windows Defender.*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100275" level="5">
    <description>Detects brute force attempts on RDP login</description>
    <match>EventID:4625\s+LogonType:10</match>
    <group>RDP Brute Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100276" level="4">
    <description>Detects successful RDP logins from unusual locations</description>
    <match>EventID:4624\s+LogonType:10\s+SourceNetworkAddress:(?!192.168|10.0|172.16)</match>
    <group>Unusual RDP Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100277" level="5">
    <description>Detects changes in RDP settings (e.g., enabling RDP)</description>
    <match>EventID:4657\s+ObjectName:\s+HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server</match>
    <group>RDP Settings Change</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100278" level="3">
    <description>Detects suspicious RDP session disconnections</description>
    <match>EventID:4779\s+SessionId:\s+.*\s+LogonType:\s+10</match>
    <group>Suspicious RDP Disconnection</group>
    <mitre>
      <id>T1076</id>
    </mitre>
  </rule>
  <rule id="100279" level="4">
    <description>Detects usage of RDP shadowing</description>
    <match>EventID:1149\s+RemoteDesktopServices-RdpCoreTS\s+RDP\s+Shadow</match>
    <group>RDP Shadowing</group>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>
  <rule id="100280" level="5">
    <description>Detects attempts to create a new user with administrative privileges.</description>
    <match>net user .* /add .* /groups:Administrators</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100281" level="4">
    <description>Identifies suspicious activity related to the use of PsExec for remote command execution.</description>
    <match>PsExec.exe .* -s .*</match>
    <group>Remote Execution</group>
    <mitre>
      <id>T1569.002</id>
    </mitre>
  </rule>
  <rule id="100282" level="4">
    <description>Detects the use of the 'Run as' command to execute files with elevated privileges.</description>
    <match>runas /user:Administrator .*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100283" level="5">
    <description>Monitors for suspicious service creation which could be used for privilege escalation.</description>
    <match>sc create .* binPath= .*</match>
    <group>Service Creation</group>
    <mitre>
      <id>T1543</id>
    </mitre>
  </rule>
  <rule id="100284" level="3">
    <description>Detects the use of the 'Task Scheduler' to schedule tasks with elevated privileges.</description>
    <match>schtasks /create .* /ru SYSTEM .*</match>
    <group>Task Scheduling</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100285" level="9">
    <description>Detects use of PsExec, a tool commonly used for remote code execution and lateral movement.</description>
    <match>(?i)\b(psexec.exe)\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1569.002</id>
    </mitre>
  </rule>
  <rule id="100286" level="8">
    <description>Detects suspicious modifications to the Windows Registry for privilege escalation.</description>
    <match>(?i)\b(reg add HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\.*\\ImagePath)\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1547.001</id>
    </mitre>
  </rule>
  <rule id="100287" level="8">
    <description>Detects abnormal use of 'net localgroup' command indicating potential privilege escalation.</description>
    <match>(?i)\b(net localgroup administrators.*add)\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.001</id>
    </mitre>
  </rule>
  <rule id="100288" level="7">
    <description>Detects suspicious use of 'schtasks.exe' for creating scheduled tasks with elevated privileges.</description>
    <match>(?i)\b(schtasks.exe /create /tn .* /tr .* /ru SYSTEM)\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100289" level="7">
    <description>Detects the use of Windows Management Instrumentation (WMI) for executing commands remotely.</description>
    <match>(?i)\b(wmic process call create)\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1047</id>
    </mitre>
  </rule>
  <rule id="100290" level="5">
    <description>Detects the creation of a new user with administrative privileges, which could indicate a privilege escalation attempt.</description>
    <match>(?i)net user .+ /add.* /domain.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100291" level="4">
    <description>Detects suspicious changes to local security policies, which could be indicative of a privilege escalation attempt.</description>
    <match>(?i)secedit /configure /db .+ /cfg .+</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1222</id>
    </mitre>
  </rule>
  <rule id="100292" level="5">
    <description>Detects the use of tools that can exploit known vulnerabilities to escalate privileges on a Windows server.</description>
    <match>(?i)psexec .* -s .*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1059.003</id>
    </mitre>
  </rule>
  <rule id="100293" level="3">
    <description>Detects the clearing of event logs, which is a common technique used by attackers to cover their tracks after a privilege escalation.</description>
    <match>(?i)wevtutil cl .*</match>
    <group>Covering Tracks</group>
    <mitre>
      <id>T1070.001</id>
    </mitre>
  </rule>
  <rule id="100294" level="4">
    <description>Detects suspicious modifications to the Windows registry associated with privilege escalation techniques.</description>
    <match>(?i)reg add HKLM\\Software\\Policies\\Microsoft\\Windows\\.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100295" level="4">
    <description>Detects unauthorized changes to the Windows Security Center registry key</description>
    <match>(?i)HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Security Center</match>
    <group>Unauthorized Registry Modification</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100296" level="4">
    <description>Detects unauthorized modifications to the Windows Defender registry settings</description>
    <match>(?i)HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender</match>
    <group>Security Software Tampering</group>
    <mitre>
      <id>T1089</id>
    </mitre>
  </rule>
  <rule id="100297" level="5">
    <description>Detects changes to the Userinit registry key often used for persistence</description>
    <match>(?i)HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit</match>
    <group>Persistence Mechanism</group>
    <mitre>
      <id>T1547.001</id>
    </mitre>
  </rule>
  <rule id="100298" level="4">
    <description>Detects unauthorized changes to registry keys related to Windows firewall settings</description>
    <match>(?i)HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\WindowsFirewall</match>
    <group>Firewall Configuration Tampering</group>
    <mitre>
      <id>T1562.004</id>
    </mitre>
  </rule>
  <rule id="100299" level="3">
    <description>Detects modifications to the registry key for disabling Windows Task Manager</description>
    <match>(?i)HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DisableTaskMgr</match>
    <group>System Tool Tampering</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100300" level="5">
    <description>Detects PowerShell commands attempting to download files from the internet, which is commonly used in malware delivery.</description>
    <match>powershell.*(Invoke-WebRequest|curl|wget).*</match>
    <group>Malware Delivery</group>
    <mitre>
      <id>T1105</id>
    </mitre>
  </rule>
  <rule id="100301" level="4">
    <description>Detects PowerShell commands that include Base64 encoded content, often used to obfuscate malicious scripts.</description>
    <match>powershell.*-EncodedCommand.*</match>
    <group>Obfuscation</group>
    <mitre>
      <id>T1027</id>
    </mitre>
  </rule>
  <rule id="100302" level="5">
    <description>Detects PowerShell commands that attempt to disable security features such as antivirus or firewall.</description>
    <match>powershell.*(Set-MpPreference|Disable-WindowsOptionalFeature).*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1089</id>
    </mitre>
  </rule>
  <rule id="100303" level="5">
    <description>Detects PowerShell commands that attempt to execute scripts from memory, often used in fileless malware attacks.</description>
    <match>powershell.*IEX.*</match>
    <group>Fileless Malware</group>
    <mitre>
      <id>T1059.001</id>
    </mitre>
  </rule>
  <rule id="100304" level="4">
    <description>Detects PowerShell commands that attempt lateral movement by creating scheduled tasks on remote systems.</description>
    <match>powershell.*schtasks.*/create.*/s.*</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100305" level="5">
    <description>Detects execution of encoded PowerShell commands which is commonly used by attackers to obfuscate malicious activities.</description>
    <match>powershell.exe.*-encodedCommand</match>
    <group>Execution</group>
    <mitre>
      <id>T1059.001</id>
    </mitre>
  </rule>
  <rule id="100306" level="4">
    <description>Detects PowerShell scripts that attempt to bypass execution policy, indicative of an attempt to execute potentially malicious scripts.</description>
    <match>powershell.exe.*-ExecutionPolicy Bypass</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1086</id>
    </mitre>
  </rule>
  <rule id="100307" level="5">
    <description>Identifies PowerShell usage of suspicious network connections, which may indicate data exfiltration or communication with a command and control server.</description>
    <match>powershell.exe.*(New-Object Net.WebClient|Invoke-WebRequest|Invoke-RestMethod)</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100308" level="4">
    <description>Detects PowerShell commands that attempt to download files from the internet, which can be used to retrieve malicious payloads.</description>
    <match>powershell.exe.*(Start-BitsTransfer|Invoke-WebRequest|Invoke-Expression)</match>
    <group>Execution</group>
    <mitre>
      <id>T1105</id>
    </mitre>
  </rule>
  <rule id="100309" level="3">
    <description>Identifies PowerShell commands that attempt to interact with the Windows Registry, which can be used for persistence or configuration changes by attackers.</description>
    <match>powershell.exe.*(Get-ItemProperty|Set-ItemProperty|New-ItemProperty|Remove-ItemProperty)</match>
    <group>Persistence</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100310" level="10">
    <description>Detects unauthorized changes to Windows registry key for User Account Control settings</description>
    <match>.*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1088</id>
    </mitre>
  </rule>
  <rule id="100311" level="9">
    <description>Detects modifications to registry key that control Windows Defender settings</description>
    <match>.*\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\.*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100312" level="8">
    <description>Detects changes to registry key related to Remote Desktop Protocol configurations</description>
    <match>.*\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\fDenyTSConnections</match>
    <group>Remote Access</group>
    <mitre>
      <id>T1021.001</id>
    </mitre>
  </rule>
  <rule id="100313" level="7">
    <description>Identifies unauthorized modifications to registry key for Windows automatic updates</description>
    <match>.*\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU</match>
    <group>Persistence</group>
    <mitre>
      <id>T1546.003</id>
    </mitre>
  </rule>
  <rule id="100314" level="6">
    <description>Detects changes to registry keys that disable Windows Firewall</description>
    <match>.*\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\.*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1562.004</id>
    </mitre>
  </rule>
  <rule id="100315" level="5">
    <description>Detects obfuscated PowerShell commands often used for evasion and to bypass detection mechanisms.</description>
    <match>(?i)([\w-]{1,5}\s+){10,}</match>
    <group>Evasion</group>
    <mitre>
      <id>T1027</id>
    </mitre>
  </rule>
  <rule id="100316" level="4">
    <description>Detects PowerShell scripts that download files from the internet, commonly used for initial access or payload delivery.</description>
    <match>(?i)\b(iwr|wget|Invoke-WebRequest)\s+-uri\s+http</match>
    <group>Initial Access</group>
    <mitre>
      <id>T1192</id>
    </mitre>
  </rule>
  <rule id="100317" level="5">
    <description>Detects execution of encoded PowerShell commands, often indicating an attempt to obfuscate malicious activity.</description>
    <match>(?i)\-encodedcommand</match>
    <group>Execution</group>
    <mitre>
      <id>T1059.001</id>
    </mitre>
  </rule>
  <rule id="100318" level="4">
    <description>Detects use of PowerShell to interact with the Windows API, which is commonly used in advanced attacks for various purposes such as credential dumping.</description>
    <match>(?i)\[DllImport\(\&quot;advapi32.dll\&quot;\)\]</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1003</id>
    </mitre>
  </rule>
  <rule id="100319" level="5">
    <description>Detects PowerShell commands that disable security monitoring tools, indicating an attempt to evade detection.</description>
    <match>(?i)(Set-MpPreference\s+-DisableRealtimeMonitoring|Set-MpPreference\s+-DisableBehaviorMonitoring)</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1562</id>
    </mitre>
  </rule>
  <rule id="100320" level="10">
    <description>Detects obfuscated PowerShell command execution often used in malware attacks</description>
    <match>(?i)powershell.*(Invoke-Expression|IEX|iex)</match>
    <group>Malware</group>
    <mitre>
      <id>T1059.001</id>
    </mitre>
  </rule>
  <rule id="100321" level="13">
    <description>Detects PowerShell downloading files from the internet, commonly used in drive-by downloads</description>
    <match>(?i)powershell.*(Invoke-WebRequest|wget|curl|http|https)</match>
    <group>Drive-by Download</group>
    <mitre>
      <id>T1105</id>
    </mitre>
  </rule>
  <rule id="100322" level="8">
    <description>Detects PowerShell commands attempting to disable security tools</description>
    <match>(?i)powershell.*(Set-MpPreference|Add-MpPreference|Disable-)</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1089</id>
    </mitre>
  </rule>
  <rule id="100323" level="7">
    <description>Detects PowerShell commands that create new user accounts, potentially for persistence</description>
    <match>(?i)powershell.*(New-LocalUser|Add-LocalGroupMember|net user)</match>
    <group>Persistence</group>
    <mitre>
      <id>T1136.001</id>
    </mitre>
  </rule>
  <rule id="100324" level="7">
    <description>Detects PowerShell commands that retrieve stored credentials from the Windows Credential Manager</description>
    <match>(?i)powershell.*(Get-Credential|Get-StoredCredential|Get-CredentialManager)</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1555.003</id>
    </mitre>
  </rule>
  <rule id="100325" level="10">
    <description>Detect creation of a new scheduled task using schtasks.exe, commonly used by malware for persistence.</description>
    <match>.*\bschtasks\.exe\b.*\b/create\b.*</match>
    <group>Persistence</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100326" level="9">
    <description>Detect modification of existing scheduled tasks using at.exe, indicating potential malicious activity.</description>
    <match>.*\bat\.exe\b.*</match>
    <group>Persistence</group>
    <mitre>
      <id>T1053.002</id>
    </mitre>
  </rule>
  <rule id="100327" level="9">
    <description>Detect execution of PowerShell commands via scheduled tasks, often used by malware for running scripts.</description>
    <match>.*\bschtasks\.exe\b.*\b/tn\b.*\bpowershell\.exe\b.*</match>
    <group>Execution</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100328" level="8">
    <description>Detect scheduled tasks running suspicious or unknown executables, indicating potential malware execution.</description>
    <match>.*\bschtasks\.exe\b.*\b/tn\b.*\b\.exe\b.*</match>
    <group>Execution</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100329" level="7">
    <description>Detect deletion of scheduled tasks, which can be used by malware to cover tracks.</description>
    <match>.*\bschtasks\.exe\b.*\b/delete\b.*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100330" level="5">
    <description>Detects unauthorized RDP login attempts from suspicious IP addresses</description>
    <match>EventID:4625.*LogonType:10.*SourceNetworkAddress:(?!192\.168\.|10\.|172\.(1[6-9]|2[0-9]|3[01]))</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100331" level="4">
    <description>Detects brute force attacks targeting RDP service</description>
    <match>EventID:4625.*LogonType:10.*Count:&gt;5</match>
    <group>Brute Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100332" level="5">
    <description>Detects successful RDP logins from blacklisted countries</description>
    <match>EventID:4624.*LogonType:10.*SourceNetworkAddress:.*(China|Russia|North Korea)</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100333" level="3">
    <description>Detects unusual time of RDP login attempts</description>
    <match>EventID:4624.*LogonType:10.*TimeGenerated:([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]</match>
    <group>Anomalous Activity</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100334" level="4">
    <description>Detects RDP login attempts with expired accounts</description>
    <match>EventID:4625.*LogonType:10.*AccountExpires</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100335" level="9">
    <description>Detects unauthorized changes to the Windows Security Center service registry keys</description>
    <match>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\wscsvc</match>
    <group>Unauthorized Registry Change</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100336" level="8">
    <description>Identifies modifications to the Windows Defender registry keys</description>
    <match>HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender</match>
    <group>Unauthorized Registry Change</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100337" level="8">
    <description>Detects unauthorized changes to User Account Control (UAC) registry settings</description>
    <match>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System</match>
    <group>Unauthorized Registry Change</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100338" level="7">
    <description>Monitors for changes to Windows Update service registry keys</description>
    <match>HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate</match>
    <group>Unauthorized Registry Change</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100339" level="8">
    <description>Detects unauthorized modifications to the registry keys that control Windows Firewall settings</description>
    <match>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess</match>
    <group>Unauthorized Registry Change</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100340" level="5">
    <description>Detects execution of encoded PowerShell commands, often used to obfuscate malicious activity.</description>
    <match>powershell.*-encodedCommand</match>
    <group>Obfuscation</group>
    <mitre>
      <id>T1027</id>
    </mitre>
  </rule>
  <rule id="100341" level="4">
    <description>Detects PowerShell download and execution commands, which are commonly used for downloading and executing malware.</description>
    <match>powershell.*(New-Object System.Net.WebClient).*(DownloadFile|DownloadString)</match>
    <group>Execution</group>
    <mitre>
      <id>T1059.001</id>
    </mitre>
  </rule>
  <rule id="100342" level="5">
    <description>Detects PowerShell commands attempting to disable security monitoring tools.</description>
    <match>powershell.*Set-MpPreference.*-DisableRealtimeMonitoring</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1562</id>
    </mitre>
  </rule>
  <rule id="100343" level="4">
    <description>Detects PowerShell commands that add a new user to the local administrators group, indicating potential privilege escalation.</description>
    <match>powershell.*Add-LocalGroupMember.*Administrators</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100344" level="3">
    <description>Detects PowerShell scripts that attempt to clear Event Logs, which can be used to cover tracks of malicious activity.</description>
    <match>powershell.*Clear-EventLog</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1070.001</id>
    </mitre>
  </rule>
  <rule id="100345" level="5">
    <description>Detects multiple failed RDP login attempts indicating possible brute-force attack</description>
    <match>EventID=4625.*LogonType=10</match>
    <group>Brute Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100346" level="4">
    <description>Detects successful RDP login from unusual or blacklisted IP addresses</description>
    <match>EventID=4624.*LogonType=10.*IpAddress=(192\.168\.1\.100|123\.123\.123\.123)</match>
    <group>Unusual Activity</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100347" level="3">
    <description>Detects RDP session hijacking by monitoring for unusual session disconnects</description>
    <match>EventID=4778</match>
    <group>Session Hijack</group>
    <mitre>
      <id>T1563</id>
    </mitre>
  </rule>
  <rule id="100348" level="4">
    <description>Detects unusual RDP access times indicating potential unauthorized access</description>
    <match>EventID=4624.*LogonType=10.*TimeGenerated&gt;=230000|TimeGenerated&lt;=050000</match>
    <group>Unusual Activity</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100350" level="5">
    <description>Detect execution of malware via scheduled task creation with suspicious names</description>
    <match>(?i)\bschtasks\.exe\s+/create\s+/tn\s+&quot;.*(virus|malware|trojan|worm).*&quot;</match>
    <group>Scheduled Task Creation</group>
    <mitre>
      <id>T1053</id>
    </mitre>
  </rule>
  <rule id="100351" level="4">
    <description>Detect scheduled task creation from unusual directories</description>
    <match>(?i)\bschtasks\.exe\s+/create\s+/tr\s+&quot;(C:\\Users\\[^\\]+\\AppData\\Local\\Temp|C:\\Windows\\Temp|C:\\Windows\\System32\\Tasks)\\.*&quot;</match>
    <group>Scheduled Task Creation</group>
    <mitre>
      <id>T1053</id>
    </mitre>
  </rule>
  <rule id="100352" level="5">
    <description>Detect scheduled task creation with encoded commands</description>
    <match>(?i)\bschtasks\.exe\s+/create\s+/tr\s+&quot;.*(powershell|cmd)\s+-enc\s+.*&quot;</match>
    <group>Scheduled Task Creation</group>
    <mitre>
      <id>T1053</id>
    </mitre>
  </rule>
  <rule id="100353" level="4">
    <description>Detect scheduled task creation using PowerShell</description>
    <match>(?i)\bpowershell\.exe\s+-command\s+&quot;schtasks\s+/create\s+/tn\s+.*&quot;</match>
    <group>Scheduled Task Creation</group>
    <mitre>
      <id>T1053</id>
    </mitre>
  </rule>
  <rule id="100354" level="3">
    <description>Detect modification of existing scheduled tasks by malware</description>
    <match>(?i)\bschtasks\.exe\s+/change\s+/tn\s+&quot;.*&quot;\s+/tr\s+&quot;.*(virus|malware|trojan|worm).*&quot;</match>
    <group>Scheduled Task Modification</group>
    <mitre>
      <id>T1053</id>
    </mitre>
  </rule>
  <rule id="100355" level="9">
    <description>Detects attempts to create new local administrators via net user command.</description>
    <match>net user .* /add.* /domain</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100356" level="8">
    <description>Identifies suspicious use of PowerShell to bypass execution policy, often used in privilege escalation.</description>
    <match>powershell.exe .* -ExecutionPolicy Bypass</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1086</id>
    </mitre>
  </rule>
  <rule id="100357" level="9">
    <description>Detects the use of the Sticky Keys exploit to gain elevated privileges.</description>
    <match>cmd.exe /c copy .*\sethc.exe</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1015</id>
    </mitre>
  </rule>
  <rule id="100358" level="7">
    <description>Monitors for the usage of PsExec tool for remote execution with elevated privileges.</description>
    <match>psexec.exe .* -u .* -p .*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1569.002</id>
    </mitre>
  </rule>
  <rule id="100359" level="8">
    <description>Detects suspicious modification of user rights assignments in the registry, indicating possible privilege escalation.</description>
    <match>reg.exe add .* /v SeDebugPrivilege</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100360" level="9">
    <description>Detects multiple failed RDP login attempts within a short period, indicating a possible brute-force attack.</description>
    <match>\bEventID=4625\b.*\bLogonType=10\b.*\b(\d+\s+failed logon attempts)\b</match>
    <group>Brute Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100361" level="8">
    <description>Monitors for successful RDP logins from unusual or foreign IP addresses.</description>
    <match>\bEventID=4624\b.*\bLogonType=10\b.*\b(\d+\s+unusual IP address)\b</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100362" level="7">
    <description>Detects RDP logins during non-business hours, which could indicate malicious activity.</description>
    <match>\bEventID=4624\b.*\bLogonType=10\b.*\b(Time=(0[0-6]|2[0-3]):[0-5][0-9])\b</match>
    <group>Suspicious Activity</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="100363" level="6">
    <description>Identifies unusual RDP client versions, suggesting potential use of non-standard or malicious RDP clients.</description>
    <match>\bEventID=4624\b.*\bLogonType=10\b.*\b(ClientName!=Microsoft\b.*\bRemote Desktop)\b</match>
    <group>Anomalous Behavior</group>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>
  <rule id="100364" level="8">
    <description>Detects the creation or modification of RDP-related registry keys, which may indicate persistence mechanisms.</description>
    <match>\bEventID=4657\b.*\bKeyName.*\b(\bRemote\b.*\bDesktop\b.*\bRegistry\b.*\bKey\b)</match>
    <group>Persistence</group>
    <mitre>
      <id>T1112</id>
    </mitre>
  </rule>
  <rule id="100365" level="5">
    <description>Detects unauthorized RDP access attempts using common brute force patterns on Windows servers</description>
    <match>.*(Failed to resolve RDP connection|RDP brute force attempt).*</match>
    <group>brute_force_attack</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100366" level="4">
    <description>Identifies unusual RDP access patterns that deviate from normal behavior, indicating potential unauthorized access</description>
    <match>.*(RDP session established from unusual IP|Anomalous RDP activity detected).*</match>
    <group>anomalous_behavior</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100367" level="4">
    <description>Detects use of compromised credentials for RDP access on Windows servers</description>
    <match>.*(Successful RDP login with compromised credentials|RDP access using stolen credentials).*</match>
    <group>credential_access</group>
    <mitre>
      <id>T1078.001</id>
    </mitre>
  </rule>
  <rule id="100368" level="3">
    <description>Monitors for RDP connection attempts from blacklisted or suspicious IP addresses</description>
    <match>.*(RDP connection attempt from blacklisted IP|Suspicious RDP IP address detected).*</match>
    <group>network_intrusion</group>
    <mitre>
      <id>T1133</id>
    </mitre>
  </rule>
  <rule id="100369" level="3">
    <description>Detects abnormal spike in RDP connection attempts which could indicate a potential attack</description>
    <match>.*(Unusual RDP connection spike|Spike in RDP session attempts).*</match>
    <group>anomalous_behavior</group>
    <mitre>
      <id>T1059.001</id>
    </mitre>
  </rule>
  <rule id="100370" level="10">
    <description>Detect unauthorized installation of known malicious applications</description>
    <match>.*(Install|setup).*(malware_name|badapp).*</match>
    <group>Malware Installation</group>
    <mitre>
      <id>T1072</id>
    </mitre>
  </rule>
  <rule id="100371" level="8">
    <description>Monitor for installation commands executed via terminal</description>
    <match>.*sudo.*installer.*pkg.*</match>
    <group>Command Line Interface</group>
    <mitre>
      <id>T1059.006</id>
    </mitre>
  </rule>
  <rule id="100372" level="9">
    <description>Detect suspicious package installation from untrusted sources</description>
    <match>.*installer.*-pkg.*http.*</match>
    <group>Untrusted Installation</group>
    <mitre>
      <id>T1105</id>
    </mitre>
  </rule>
  <rule id="100373" level="7">
    <description>Monitor for installation of applications outside of the App Store</description>
    <match>.*(download|install).*(dmg|pkg).*</match>
    <group>Unauthorized Software</group>
    <mitre>
      <id>T1072</id>
    </mitre>
  </rule>
  <rule id="100374" level="9">
    <description>Detect auto-installation scripts running without user consent</description>
    <match>.*launchd.*com.apple.installer.*</match>
    <group>Unauthorized Automation</group>
    <mitre>
      <id>T1543.001</id>
    </mitre>
  </rule>
  <rule id="100375" level="5">
    <description>Detect execution of malicious DMG files</description>
    <match>\.dmg$</match>
    <group>Malware Execution</group>
    <mitre>
      <id>T1105</id>
    </mitre>
  </rule>
  <rule id="100376" level="4">
    <description>Detect suspicious script execution from Downloads folder</description>
    <match>/Users/.*/Downloads/.*\.(sh|py|pl)$</match>
    <group>Suspicious Script Execution</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100377" level="5">
    <description>Detect launch of untrusted applications</description>
    <match>com.apple.quarantine</match>
    <group>Untrusted Application Execution</group>
    <mitre>
      <id>T1218</id>
    </mitre>
  </rule>
  <rule id="100378" level="5">
    <description>Detect modifications to system files by non-privileged users</description>
    <match>/System/Library/.*</match>
    <group>System File Tampering</group>
    <mitre>
      <id>T1060</id>
    </mitre>
  </rule>
  <rule id="100379" level="4">
    <description>Detect execution of applications from temporary directories</description>
    <match>/private/var/folders/.*\.(app|exe)$</match>
    <group>Temporary Directory Execution</group>
    <mitre>
      <id>T1204</id>
    </mitre>
  </rule>
  <rule id="100380" level="9">
    <description>Detects suspicious outgoing connections to known malicious IP addresses.</description>
    <match>^(?:.*\b(?:\d{1,3}\.){3}\d{1,3}\b.*)?$</match>
    <group>Network</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100381" level="8">
    <description>Detects unusual DNS queries indicating possible DNS tunneling.</description>
    <match>^(?:.*\b(?:[a-z0-9]{32,})\b.*)?$</match>
    <group>Network</group>
    <mitre>
      <id>T1071.004</id>
    </mitre>
  </rule>
  <rule id="100382" level="7">
    <description>Identifies high number of outgoing SSH connections which may indicate compromise.</description>
    <match>^(?:.*\bssh\b.*)?$</match>
    <group>Network</group>
    <mitre>
      <id>T1021.004</id>
    </mitre>
  </rule>
  <rule id="100383" level="9">
    <description>Alerts on connections to command and control servers.</description>
    <match>^(?:.*\b(?:malicious-domain\.com|badguy-server\.net)\b.*)?$</match>
    <group>Network</group>
    <mitre>
      <id>T1105</id>
    </mitre>
  </rule>
  <rule id="100384" level="6">
    <description>Detects unusual activity related to HTTP/S traffic patterns.</description>
    <match>^(?:.*\b(?:POST|GET) .*HTTP/1\.[01]\b.*)?$</match>
    <group>Network</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100385" level="5">
    <description>Detects execution of a known malicious script via Terminal, indicating potential malware activity.</description>
    <match>.*(curl|wget).*\s+http(s)?:\/\/.*\.sh</match>
    <group>malware,script</group>
    <mitre>
      <id>T1059.004</id>
    </mitre>
  </rule>
  <rule id="100386" level="4">
    <description>Identifies unauthorized changes to system configuration files, which could indicate privilege escalation or persistence mechanisms.</description>
    <match>.*sudo\s+.*(nano|vim|vi|echo)\s+\/etc\/.*</match>
    <group>privilege_escalation,persistence</group>
    <mitre>
      <id>T1546.001</id>
    </mitre>
  </rule>
  <rule id="100387" level="5">
    <description>Monitors for unusual outbound network connections to rare or known malicious IP addresses, signifying potential data exfiltration.</description>
    <match>.*\s+(curl|nc|ncat|wget)\s+.*\s+[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}</match>
    <group>exfiltration,network</group>
    <mitre>
      <id>T1048.001</id>
    </mitre>
  </rule>
  <rule id="100388" level="3">
    <description>Detects the creation of hidden files and directories which may be used to store malicious payloads or sensitive data.</description>
    <match>.*\s+mkdir\s+\.\w+</match>
    <group>defense_evasion,persistence</group>
    <mitre>
      <id>T1158</id>
    </mitre>
  </rule>
  <rule id="100389" level="4">
    <description>Alerts on the modification of system binaries by unauthorized users, which could indicate an attempt to implant a rootkit.</description>
    <match>.*sudo\s+.*cp\s+.*\s+\/usr\/bin\/.*</match>
    <group>defense_evasion,persistence</group>
    <mitre>
      <id>T1036.005</id>
    </mitre>
  </rule>
  <rule id="100390" level="5">
    <description>Detects execution of a suspicious script that could indicate a malware infection</description>
    <match>.*(curl|wget).*http.*\.sh</match>
    <group>Malware</group>
    <mitre>
      <id>T1059.004</id>
    </mitre>
  </rule>
  <rule id="100391" level="4">
    <description>Detects unusual network activity indicative of data exfiltration</description>
    <match>.*scp.*</match>
    <group>Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100392" level="4">
    <description>Detects unauthorized modification of system files</description>
    <match>.*sudo.*(chmod|chown).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100393" level="3">
    <description>Detects suspicious process spawning from a web browser</description>
    <match>.*(Safari|Chrome|Firefox).* -c .*</match>
    <group>Execution</group>
    <mitre>
      <id>T1059.003</id>
    </mitre>
  </rule>
  <rule id="100394" level="3">
    <description>Detects abnormal system resource usage that may indicate a DDoS attack</description>
    <match>.*sysctl.*kern\.boottime.*</match>
    <group>Denial of Service</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100395" level="9">
    <description>Detects unauthorized installation of rootkits potentially compromising system integrity</description>
    <match>rootkit_installer|rootkit_tool</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1069</id>
    </mitre>
  </rule>
  <rule id="100396" level="8">
    <description>Detects abnormal network traffic patterns indicating potential data exfiltration</description>
    <match>unusual_traffic|exfiltration</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100397" level="7">
    <description>Detects execution of known cryptomining scripts that could degrade system performance</description>
    <match>crypto_miner|mining_script</match>
    <group>Cryptojacking</group>
    <mitre>
      <id>T1496</id>
    </mitre>
  </rule>
  <rule id="100398" level="7">
    <description>Detects suspicious changes to system configuration files indicating potential system compromise</description>
    <match>config_change|suspicious_modification</match>
    <group>System Compromise</group>
    <mitre>
      <id>T1087</id>
    </mitre>
  </rule>
  <rule id="100399" level="6">
    <description>Detects unusual high CPU usage by processes indicating potential malware or unwanted software</description>
    <match>high_cpu|unusual_process_behavior</match>
    <group>Resource Abuse</group>
    <mitre>
      <id>T1490</id>
    </mitre>
  </rule>
  <rule id="100400" level="5">
    <description>Detects unauthorized attempts to escalate privileges using sudo command</description>
    <match>^(sudo\s+[^\s]+\s+.+)$</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1548</id>
    </mitre>
  </rule>
  <rule id="100401" level="5">
    <description>Identifies unusual network traffic indicating potential data exfiltration</description>
    <match>^(curl\s+-[oO]\s+.+\s+https?://[^\s]+/.*)$</match>
    <group>Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100402" level="4">
    <description>Detects execution of scripts from temporary directories</description>
    <match>^(/tmp/|/var/tmp/|/private/tmp/).+\.sh\s*$</match>
    <group>Execution</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100403" level="3">
    <description>Monitors for suspicious use of system information discovery commands</description>
    <match>^(system_profiler|ioreg|ifconfig|netstat)\s+.*$</match>
    <group>Discovery</group>
    <mitre>
      <id>T1082</id>
    </mitre>
  </rule>
  <rule id="100404" level="4">
    <description>Detects modification of system launch agents or daemons</description>
    <match>^(sudo\s+launchctl\s+(load|unload|remove|bootstrap)\s+.+)$</match>
    <group>Persistence</group>
    <mitre>
      <id>T1543</id>
    </mitre>
  </rule>
  <rule id="100405" level="5">
    <description>Detect unauthorized modifications to /etc/passwd file</description>
    <match>sudo\s+.*(nano|vim|vi)\s+/etc/passwd</match>
    <group>File Integrity</group>
    <mitre>
      <id>T1222</id>
    </mitre>
  </rule>
  <rule id="100406" level="4">
    <description>Detect creation of new hidden files in /usr/local/bin</description>
    <match>sudo\s+.*touch\s+/usr/local/bin/\.[a-zA-Z0-9_]+</match>
    <group>Persistence</group>
    <mitre>
      <id>T1158</id>
    </mitre>
  </rule>
  <rule id="100407" level="4">
    <description>Detect unauthorized access to system log files</description>
    <match>sudo\s+.*cat\s+/var/log/.*</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1003</id>
    </mitre>
  </rule>
  <rule id="100408" level="5">
    <description>Detect unauthorized changes to /etc/hosts file</description>
    <match>sudo\s+.*(nano|vim|vi)\s+/etc/hosts</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1562</id>
    </mitre>
  </rule>
  <rule id="100409" level="3">
    <description>Detect unauthorized execution of scripts in /Library/Scripts</description>
    <match>sudo\s+.*(sh|bash|python|perl)\s+/Library/Scripts/.*</match>
    <group>Execution</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100410" level="5">
    <description>Detects potential data exfiltration via DNS tunneling</description>
    <match>.*(nslookup|dig|host).*\s+.*example\.com.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1071.004</id>
    </mitre>
  </rule>
  <rule id="100411" level="4">
    <description>Suspicious outbound connection to known malicious IPs</description>
    <match>.*(curl|wget).*\s+.*\b(198\.51\.100\.0|203\.0\.113\.0)\b.*</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100412" level="3">
    <description>Unusual TCP connections to high-numbered ports</description>
    <match>.*(nc|netcat).*\s+.*-p\s+[1-9][0-9]{3,4}.*</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1021.001</id>
    </mitre>
  </rule>
  <rule id="100413" level="3">
    <description>Detected usage of network scanning tools</description>
    <match>.*(nmap|masscan).*</match>
    <group>Discovery</group>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
  <rule id="100414" level="4">
    <description>Suspicious DNS requests to newly registered domains</description>
    <match>.*(dig|nslookup).*\s+.*\b(newlyregistereddomain\.com)\b.*</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1071.004</id>
    </mitre>
  </rule>
  <rule id="100415" level="5">
    <description>Detects unauthorized installation of known malicious applications</description>
    <match>.*(MalwareName1|MalwareName2|MalwareName3).*</match>
    <group>installation, malware</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100416" level="4">
    <description>Detects installation of applications from unverified sources</description>
    <match>.*(InstallerName1|InstallerName2).*</match>
    <group>installation, unverified source</group>
    <mitre>
      <id>T1204</id>
    </mitre>
  </rule>
  <rule id="100417" level="5">
    <description>Detects installation of applications using sudo without user consent</description>
    <match>.*sudo.*(install|pkgutil).*</match>
    <group>installation, privilege escalation</group>
    <mitre>
      <id>T1548</id>
    </mitre>
  </rule>
  <rule id="100418" level="3">
    <description>Detects installation of applications during off-hours</description>
    <match>.*(installer|pkgutil).*(0[0-6]|2[0-3]):[0-5][0-9].*</match>
    <group>installation, off-hours activity</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100419" level="4">
    <description>Detects installation of applications that modify system files</description>
    <match>.*(install|pkgutil).*system/Library.*</match>
    <group>installation, system modification</group>
    <mitre>
      <id>T1169</id>
    </mitre>
  </rule>
  <rule id="100420" level="9">
    <description>Detects unauthorized installation of applications via suspicious package installers</description>
    <match>.*(installer|pkgutil).*</match>
    <group>Unauthorized Installation</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100421" level="10">
    <description>Detects installation of applications using sudo commands without user consent</description>
    <match>.*sudo.*(installer|brew install).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100422" level="8">
    <description>Detects use of curl or wget to download and install applications</description>
    <match>.*(curl|wget).*(dmg|pkg).*</match>
    <group>Suspicious Download</group>
    <mitre>
      <id>T1105</id>
    </mitre>
  </rule>
  <rule id="100423" level="7">
    <description>Detects installation of applications from unauthorized remote locations</description>
    <match>.*scp.*(dmg|pkg).*</match>
    <group>Remote Code Execution</group>
    <mitre>
      <id>T1021.002</id>
    </mitre>
  </rule>
  <rule id="100424" level="8">
    <description>Detects execution of suspicious scripts related to application installation</description>
    <match>.*(osascript|AppleScript).*install.*</match>
    <group>Scripting</group>
    <mitre>
      <id>T1059.002</id>
    </mitre>
  </rule>
  <rule id="100425" level="5">
    <description>Detects unauthorized installation of applications using sudo command</description>
    <match>sudo\s+installer\s+-pkg</match>
    <group>Unauthorized Installation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100426" level="4">
    <description>Detects use of curl to download and install packages, which may indicate a script-based attack</description>
    <match>curl\s+-O\s+.*\.pkg</match>
    <group>Suspicious Download</group>
    <mitre>
      <id>T1105</id>
    </mitre>
  </rule>
  <rule id="100427" level="4">
    <description>Detects the use of open command to install applications, which could be used to bypass security restrictions</description>
    <match>open\s+.*\.pkg</match>
    <group>Bypass Security</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100428" level="3">
    <description>Detects installation of applications via Homebrew, which may be used by attackers to install malicious software</description>
    <match>brew\s+install\s+</match>
    <group>Package Manager Abuse</group>
    <mitre>
      <id>T1129</id>
    </mitre>
  </rule>
  <rule id="100429" level="5">
    <description>Detects execution of installer command with elevated privileges, indicating potential unauthorized software installation</description>
    <match>sudo\s+installer</match>
    <group>Elevated Privileges</group>
    <mitre>
      <id>T1543</id>
    </mitre>
  </rule>
  <rule id="100430" level="10">
    <description>Detects network connections to known malicious IP addresses originating from macOS devices</description>
    <match>.*\s(\d{1,3}\.){3}\d{1,3}\s.*</match>
    <group>Malicious IP Connection</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100431" level="9">
    <description>Identifies the use of suspicious DNS queries that could indicate domain generation algorithm (DGA) activity on macOS devices</description>
    <match>.*\s[a-z0-9]{12,}\.(com|net|org|info|biz)\s.*</match>
    <group>Suspicious DNS Activity</group>
    <mitre>
      <id>T1568.002</id>
    </mitre>
  </rule>
  <rule id="100432" level="9">
    <description>Detects unusual outbound traffic patterns that could indicate data exfiltration from macOS devices</description>
    <match>.*\s(\d{1,3}\.){3}\d{1,3}\s.*\s\d{5,}\s.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100433" level="8">
    <description>Flags network connections to TOR exit nodes from macOS devices, which may indicate anonymity-seeking behavior</description>
    <match>.*\s(\d{1,3}\.){3}\d{1,3}\s.*</match>
    <group>TOR Connection</group>
    <mitre>
      <id>T1090.003</id>
    </mitre>
  </rule>
  <rule id="100434" level="10">
    <description>Detects attempts to connect to known command and control (C2) servers from macOS devices</description>
    <match>.*\s(\d{1,3}\.){3}\d{1,3}\s.*</match>
    <group>C2 Communication</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100435" level="9">
    <description>Detect execution of unauthorized or unknown DMG files</description>
    <match>.*\.dmg$</match>
    <group>Malware Execution</group>
    <mitre>
      <id>T1092</id>
    </mitre>
  </rule>
  <rule id="100436" level="10">
    <description>Identify scripts or applications attempting to modify system binaries</description>
    <match>(/bin/|/usr/bin/|/sbin/|/usr/sbin/).*</match>
    <group>System Modification</group>
    <mitre>
      <id>T1060</id>
    </mitre>
  </rule>
  <rule id="100437" level="8">
    <description>Detect execution of scripts from Downloads folder</description>
    <match>(/Users/.*/Downloads/.*\.sh|/Users/.*/Downloads/.*\.py)</match>
    <group>Suspicious Execution</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100438" level="7">
    <description>Monitor for abnormal network connections by applications</description>
    <match>.*(curl|wget|nc|socat|ssh).*</match>
    <group>Network Activity</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100439" level="9">
    <description>Detect persistence mechanisms through launch agents or daemons</description>
    <match>(/Library/LaunchAgents/|/Library/LaunchDaemons/).*\.plist</match>
    <group>Persistence</group>
    <mitre>
      <id>T1160</id>
    </mitre>
  </rule>
  <rule id="100440" level="5">
    <description>Detects unauthorized modification of system binaries in /bin directory</description>
    <match>/bin/.*</match>
    <group>System Integrity</group>
    <mitre>
      <id>T1070.004</id>
    </mitre>
  </rule>
  <rule id="100441" level="5">
    <description>Identifies unauthorized access to /etc/sudoers file</description>
    <match>/etc/sudoers</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1069.001</id>
    </mitre>
  </rule>
  <rule id="100442" level="4">
    <description>Monitors suspicious changes to system startup scripts in /Library/StartupItems</description>
    <match>/Library/StartupItems/.*</match>
    <group>Persistence</group>
    <mitre>
      <id>T1037.001</id>
    </mitre>
  </rule>
  <rule id="100443" level="4">
    <description>Detects unauthorized access to keychain database files</description>
    <match>/Library/Keychains/.*</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1555.001</id>
    </mitre>
  </rule>
  <rule id="100444" level="4">
    <description>Identifies suspicious activity in /System/Library/LaunchDaemons directory</description>
    <match>/System/Library/LaunchDaemons/.*</match>
    <group>Execution</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="100445" level="5">
    <description>Detect execution of suspicious DMG file from an untrusted source</description>
    <match>.*\.dmg$</match>
    <group>malware</group>
    <mitre>
      <id>T1204.002</id>
    </mitre>
  </rule>
  <rule id="100446" level="4">
    <description>Detect usage of curl to download files from the internet</description>
    <match>curl.*-O.*</match>
    <group>malware</group>
    <mitre>
      <id>T1105</id>
    </mitre>
  </rule>
  <rule id="100447" level="5">
    <description>Detect execution of macOS Gatekeeper bypass techniques</description>
    <match>spctl.*--add.*</match>
    <group>malware</group>
    <mitre>
      <id>T1140</id>
    </mitre>
  </rule>
  <rule id="100448" level="4">
    <description>Detect suspicious launch agent creation in LaunchAgents directory</description>
    <match>/Library/LaunchAgents/.*\.plist</match>
    <group>malware</group>
    <mitre>
      <id>T1159</id>
    </mitre>
  </rule>
  <rule id="100449" level="3">
    <description>Detect execution of scripts from the Downloads directory</description>
    <match>/Users/.*/Downloads/.*\.sh</match>
    <group>malware</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100450" level="9">
    <description>Detects unauthorized installation of applications via command-line tools like 'installer'</description>
    <match>.*installer.*-pkg.*</match>
    <group>Installation</group>
    <mitre>
      <id>T1176</id>
    </mitre>
  </rule>
  <rule id="100451" level="8">
    <description>Identifies suspicious use of 'curl' to download and execute scripts</description>
    <match>.*curl.*-o.*\.sh.*&amp;&amp;.*sh.*</match>
    <group>Execution</group>
    <mitre>
      <id>T1059.004</id>
    </mitre>
  </rule>
  <rule id="100452" level="7">
    <description>Monitors for unauthorized application installation using 'brew' package manager</description>
    <match>.*brew install.*</match>
    <group>Installation</group>
    <mitre>
      <id>T1546.004</id>
    </mitre>
  </rule>
  <rule id="100453" level="8">
    <description>Detects use of 'osascript' to install applications via AppleScript</description>
    <match>.*osascript.*install.*</match>
    <group>Execution</group>
    <mitre>
      <id>T1059.002</id>
    </mitre>
  </rule>
  <rule id="100454" level="6">
    <description>Identifies modification of system settings for application installation</description>
    <match>.*sudo spctl --master-disable.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1548.002</id>
    </mitre>
  </rule>
  <rule id="100455" level="5">
    <description>Detect execution of a malicious DMG file with known malware signatures.</description>
    <match>.*\.dmg$</match>
    <group>Malware Execution</group>
    <mitre>
      <id>T1204</id>
    </mitre>
  </rule>
  <rule id="100456" level="4">
    <description>Monitor for suspicious script execution from DMG mounts, indicating potential malware.</description>
    <match>/Volumes/.*\.sh$</match>
    <group>Script Execution</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100457" level="4">
    <description>Detect changes to macOS settings or configurations that could indicate malware persistence.</description>
    <match>/Library/LaunchDaemons/.*\.plist$</match>
    <group>Persistence</group>
    <mitre>
      <id>T1160</id>
    </mitre>
  </rule>
  <rule id="100458" level="5">
    <description>Identify unauthorized network connections initiated by suspicious processes from DMG files.</description>
    <match>/Volumes/.*\.app/Contents/MacOS/.*</match>
    <group>Network Activity</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100459" level="3">
    <description>Monitor for unauthorized modifications to system directories from DMG mounts.</description>
    <match>/Volumes/.*(/System|/Library)/.*</match>
    <group>File Modification</group>
    <mitre>
      <id>T1222</id>
    </mitre>
  </rule>
  <rule id="100460" level="5">
    <description>Detects unauthorized modifications to /etc/sudoers file which can grant root privileges.</description>
    <match>sudoers\sfile\schanged</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1548.002</id>
    </mitre>
  </rule>
  <rule id="100461" level="4">
    <description>Monitors unauthorized access to /var/db/SystemPolicyConfiguration/KextPolicy, indicating potential attempts to load malicious kernel extensions.</description>
    <match>KextPolicy\sfile\saccess</match>
    <group>Persistence</group>
    <mitre>
      <id>T1547.009</id>
    </mitre>
  </rule>
  <rule id="100462" level="4">
    <description>Detects unauthorized changes to /Library/Preferences/com.apple.loginwindow.plist which can indicate login item modification for persistence.</description>
    <match>com\.apple\.loginwindow\.plist\schanged</match>
    <group>Persistence</group>
    <mitre>
      <id>T1547.001</id>
    </mitre>
  </rule>
  <rule id="100463" level="3">
    <description>Monitors unauthorized access to /Library/Security/SecurityAgentPlugins, indicating potential tampering with security agent plugins.</description>
    <match>SecurityAgentPlugins\saccess</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1547.009</id>
    </mitre>
  </rule>
  <rule id="100464" level="3">
    <description>Detects unauthorized changes to /System/Library/LaunchDaemons, which can indicate the addition of malicious daemons for persistence.</description>
    <match>LaunchDaemons\schanged</match>
    <group>Persistence</group>
    <mitre>
      <id>T1547.011</id>
    </mitre>
  </rule>
  <rule id="100465" level="5">
    <description>Detect unauthorized modification of system integrity protection settings</description>
    <match>.*csrutil.*enable.*</match>
    <group>System Integrity</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100466" level="4">
    <description>Monitor attempts to access the sudoers file without authorization</description>
    <match>.*(vi|nano|vim|cat)\s+/etc/sudoers.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100467" level="3">
    <description>Detect unauthorized access to the /etc/passwd file</description>
    <match>.*cat\s+/etc/passwd.*</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1003</id>
    </mitre>
  </rule>
  <rule id="100468" level="3">
    <description>Monitor attempts to modify the /etc/hosts file</description>
    <match>.*(vi|nano|vim|cat)\s+/etc/hosts.*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100469" level="4">
    <description>Detect unauthorized access to keychain files</description>
    <match>.*security\s+dump-keychain.*</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1555.001</id>
    </mitre>
  </rule>
  <rule id="100470" level="5">
    <description>Detects unusually high outbound network traffic, indicating potential data exfiltration</description>
    <match>^(?:[0-9]{1,3}\.){3}[0-9]{1,3}\s+\d+\s+\d+$</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100471" level="4">
    <description>Detects unauthorized remote access via SSH, potentially indicating a compromised system</description>
    <match>sshd\[\d+\]: Accepted password for .* from (?:[0-9]{1,3}\.){3}[0-9]{1,3} port \d+ ssh2</match>
    <group>Remote Access</group>
    <mitre>
      <id>T1021.004</id>
    </mitre>
  </rule>
  <rule id="100472" level="4">
    <description>Detects DNS requests to known malicious domains, which may indicate malware communication</description>
    <match>query: .*\.maliciousdomain\.com</match>
    <group>Malware</group>
    <mitre>
      <id>T1071.004</id>
    </mitre>
  </rule>
  <rule id="100473" level="3">
    <description>Detects unusual port scanning activities, which might indicate network reconnaissance</description>
    <match>nmap .* (?:[0-9]{1,3}\.){3}[0-9]{1,3}</match>
    <group>Reconnaissance</group>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
  <rule id="100474" level="3">
    <description>Detects anomalous outbound connections to rare or suspicious IP addresses</description>
    <match>^(?:[0-9]{1,3}\.){3}[0-9]{1,3}\s+\d+\s+\d+$</match>
    <group>Anomalous Activity</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100475" level="5">
    <description>Detects potential ransomware activity by monitoring for mass encryption of files</description>
    <match>.*\.(docx|xlsx|pdf|jpg|png)$</match>
    <group>Ransomware</group>
    <mitre>
      <id>T1486</id>
    </mitre>
  </rule>
  <rule id="100476" level="4">
    <description>Detects unauthorized system configuration changes indicative of privilege escalation</description>
    <match>/etc/sudoers|/etc/passwd</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100477" level="4">
    <description>Monitors for the presence of common keylogging tools</description>
    <match>.*keylogger.*|.*logKext.*</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1056</id>
    </mitre>
  </rule>
  <rule id="100478" level="3">
    <description>Detects unusual network activity indicative of data exfiltration</description>
    <match>.*curl.*|.*wget.*|.*scp.*</match>
    <group>Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100479" level="4">
    <description>Monitors for suspicious process injection attacks</description>
    <match>.*inject.*|.*dyld.*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1055</id>
    </mitre>
  </rule>
  <rule id="100480" level="9">
    <description>Detection of outbound connections to known malicious IPs indicating potential data exfiltration.</description>
    <match>.*(destination_ip: (?:192\.168\.1\.1|10\.0\.0\.1|172\.16\.0\.1)).*</match>
    <group>Network Threat</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100481" level="8">
    <description>Detection of unusual DNS queries that could indicate DNS tunneling or C2 communication.</description>
    <match>.*(dns_query: (?:example\.malicious\.com|test\.bad\.domain)).*</match>
    <group>Network Threat</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100482" level="7">
    <description>Detection of excessive outbound connections to multiple foreign IPs in a short timeframe, indicating potential botnet activity.</description>
    <match>.*(foreign_ip_count &gt; 100).*</match>
    <group>Network Threat</group>
    <mitre>
      <id>T1090</id>
    </mitre>
  </rule>
  <rule id="100483" level="7">
    <description>Detection of large volumes of outbound traffic on non-standard ports, which may indicate data exfiltration.</description>
    <match>.*(outbound_traffic &gt; 100MB AND port != 80 AND port != 443).*</match>
    <group>Network Threat</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100484" level="6">
    <description>Detection of ARP spoofing attempts indicating potential man-in-the-middle attacks.</description>
    <match>.*(arp_spoof_detected: true).*</match>
    <group>Network Threat</group>
    <mitre>
      <id>T1557</id>
    </mitre>
  </rule>
  <rule id="100485" level="10">
    <description>Detects network connections to known C2 (Command and Control) servers.</description>
    <match>.*(c2server|maliciousdomain|badactor).*(443|80).*</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100486" level="9">
    <description>Identifies unusual outbound traffic patterns indicating potential data exfiltration.</description>
    <match>.*(dataexfil|largeupload|unusualoutbound).*(443|80).*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100487" level="8">
    <description>Detects network scanning activities originating from macOS devices.</description>
    <match>.*(nmap|massscan|zmap).*(443|80|53|22).*</match>
    <group>Network Scanning</group>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
  <rule id="100488" level="7">
    <description>Flags suspicious DNS queries that may indicate DNS tunneling.</description>
    <match>.*(dnstunnel|dnsquery|suspiciousdns).*(53).*</match>
    <group>DNS Tunneling</group>
    <mitre>
      <id>T1071.004</id>
    </mitre>
  </rule>
  <rule id="100489" level="7">
    <description>Monitors for unusual SMB traffic that could indicate lateral movement.</description>
    <match>.*(smbtraffic|smbconnect|lateralmovement).*(445).*</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1021.002</id>
    </mitre>
  </rule>
  <rule id="100490" level="5">
    <description>Detect unauthorized installation of applications using package managers (e.g., Homebrew)</description>
    <match>brew install [^\s]+</match>
    <group>Unauthorized Installation</group>
    <mitre>
      <id>T1129</id>
    </mitre>
  </rule>
  <rule id="100491" level="4">
    <description>Monitor for unauthorized installation of applications via AppleScript</description>
    <match>osascript -e 'do shell script &quot;sudo installer -pkg [^\s]+ -target /&quot;'</match>
    <group>Scripted Installation</group>
    <mitre>
      <id>T1059.002</id>
    </mitre>
  </rule>
  <rule id="100492" level="5">
    <description>Detect unauthorized use of the 'installer' command for application installation</description>
    <match>sudo installer -pkg [^\s]+ -target /</match>
    <group>System Command Execution</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100493" level="3">
    <description>Monitor execution of suspicious scripts from temporary directories</description>
    <match>/tmp/[^\s]+.sh</match>
    <group>Suspicious Script Execution</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100494" level="4">
    <description>Detect unauthorized installation of applications via Python pip</description>
    <match>pip install [^\s]+</match>
    <group>Package Manager Abuse</group>
    <mitre>
      <id>T1129</id>
    </mitre>
  </rule>
  <rule id="100495" level="9">
    <description>Detects malicious DMG files with known malware signatures</description>
    <match>.*\.dmg$</match>
    <group>malicious_dmg</group>
    <mitre>
      <id>T1204.002</id>
    </mitre>
  </rule>
  <rule id="100496" level="8">
    <description>Detects suspicious launch agents or daemons with unusual plist configurations</description>
    <match>/Library/Launch(Agents|Daemons)/.*\.plist$</match>
    <group>suspicious_launch_agent</group>
    <mitre>
      <id>T1160</id>
    </mitre>
  </rule>
  <rule id="100497" level="10">
    <description>Detects execution of known malicious scripts or binaries in macOS</description>
    <match>/tmp/.*\.sh$|/tmp/.*\.py$|/tmp/.*\.exec$</match>
    <group>malicious_script</group>
    <mitre>
      <id>T1059.004</id>
    </mitre>
  </rule>
  <rule id="100498" level="7">
    <description>Detects suspicious modifications to system files by unauthorized processes</description>
    <match>/System/Library/.*</match>
    <group>system_modification</group>
    <mitre>
      <id>T1169</id>
    </mitre>
  </rule>
  <rule id="100499" level="6">
    <description>Detects persistence mechanisms using Login Items</description>
    <match>/Users/.*/Library/Preferences/com.apple.loginitems.plist</match>
    <group>persistence</group>
    <mitre>
      <id>T1547.015</id>
    </mitre>
  </rule>
  <rule id="100500" level="5">
    <description>Detect execution of malicious DMG files</description>
    <match>\.dmg$</match>
    <group>Malware Execution</group>
    <mitre>
      <id>T1204.002</id>
    </mitre>
  </rule>
  <rule id="100501" level="4">
    <description>Detect unusual script execution from DMG mounts</description>
    <match>/Volumes/.*\.sh</match>
    <group>Script Execution</group>
    <mitre>
      <id>T1059.004</id>
    </mitre>
  </rule>
  <rule id="100502" level="5">
    <description>Detect launch of known malicious applications</description>
    <match>(EvilApp|BadApp|MalApp)\.app</match>
    <group>Application Execution</group>
    <mitre>
      <id>T1105</id>
    </mitre>
  </rule>
  <rule id="100503" level="4">
    <description>Detect creation of persistent launch agents by untrusted sources</description>
    <match>/Library/LaunchAgents/.*\.plist</match>
    <group>Persistence</group>
    <mitre>
      <id>T1547.001</id>
    </mitre>
  </rule>
  <rule id="100504" level="5">
    <description>Detect suspicious modifications to system binaries</description>
    <match>/usr/bin/.*</match>
    <group>System Modification</group>
    <mitre>
      <id>T1070.004</id>
    </mitre>
  </rule>
  <rule id="100505" level="5">
    <description>Detects SQL injection attempts using UNION SELECT statement</description>
    <match>.*UNION\s+SELECT.*</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100506" level="4">
    <description>Detects SQL injection attempts using OR 1=1 statement</description>
    <match>.*OR\s+1=1.*</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100507" level="4">
    <description>Detects SQL injection attempts using comment sequence to bypass authentication</description>
    <match>.*--\s.*</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100508" level="5">
    <description>Detects potential SQL injection using sleep function for time-based attacks</description>
    <match>.*SLEEP\(\d+\).*</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100509" level="5">
    <description>Detects SQL injection attempts using stacked queries</description>
    <match>.*;\s*SELECT.*</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100510" level="9">
    <description>Detects unauthorized root access to the MySQL database.</description>
    <match>^\s*GRANT\s+ALL\s+PRIVILEGES\s+ON\s+\*\.\*\s+TO\s+'root'@'%'</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100511" level="8">
    <description>Detects unusual modifications to MySQL user privileges.</description>
    <match>^\s*GRANT\s.*\s+ON\s+\*\.\*\s+TO\s+.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100512" level="8">
    <description>Detects the creation of new MySQL administrative users.</description>
    <match>^\s*CREATE\s+USER\s+'.*'@'.*'\s+IDENTIFIED\s+BY\s+'.*'\s+WITH\s+MAX_USER_CONNECTIONS\s+\d+</match>
    <group>Account Creation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100513" level="7">
    <description>Detects suspicious database schema modifications.</description>
    <match>^\s*(ALTER|DROP)\s+TABLE\s+.*</match>
    <group>Data Destruction</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="100514" level="7">
    <description>Detects data exfiltration attempts through SELECT statements targeting sensitive tables.</description>
    <match>^\s*SELECT\s+.*\s+FROM\s+(users|credit_cards|ssn)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100515" level="5">
    <description>Detects brute force login attempts by monitoring repeated failed login attempts within a short period</description>
    <match>Access denied for user '.*'@'.*' (using password: YES)</match>
    <group>unauthorized-access</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100516" level="5">
    <description>Detects SQL injection attempts by monitoring for suspicious patterns in SQL queries</description>
    <match>SELECT .* FROM .* WHERE .*='.*' OR '1'='1'</match>
    <group>sql-injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100517" level="4">
    <description>Detects unauthorized user creation by monitoring the creation of new users without appropriate privileges</description>
    <match>CREATE USER '.*'@'.*' IDENTIFIED BY '.*'</match>
    <group>unauthorized-user-creation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100518" level="4">
    <description>Detects privilege escalation attempts by monitoring GRANT statements that elevate user privileges</description>
    <match>GRANT ALL PRIVILEGES ON .* TO '.*'@'.*'</match>
    <group>privilege-escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100519" level="5">
    <description>Detects unauthorized data exfiltration by monitoring large data exports</description>
    <match>SELECT .* INTO OUTFILE '.*'</match>
    <group>data-exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100520" level="10">
    <description>Detects unauthorized user creation, which may indicate a compromised account or privilege escalation attempt.</description>
    <match>CREATE\s+USER\s+.*</match>
    <group>Account Compromise</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100521" level="9">
    <description>Monitors for unauthorized changes to database schema, which can be a sign of SQL injection or insider threat.</description>
    <match>ALTER\s+TABLE\s+.*</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100522" level="9">
    <description>Detects the deletion of large amounts of data, which might indicate a data destruction or ransomware attack.</description>
    <match>DELETE\s+FROM\s+.*</match>
    <group>Data Destruction</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="100523" level="8">
    <description>Identifies unauthorized granting of elevated privileges, which can be a sign of privilege escalation or compromised account.</description>
    <match>GRANT\s+ALL\s+PRIVILEGES\s+.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100524" level="7">
    <description>Monitors batch updates that affect multiple rows, which might indicate an attempt to corrupt or manipulate data.</description>
    <match>UPDATE\s+.*\s+SET\s+.*</match>
    <group>Data Manipulation</group>
    <mitre>
      <id>T1565</id>
    </mitre>
  </rule>
  <rule id="100525" level="5">
    <description>Detects SQL injection attempt using UNION SELECT</description>
    <match>UNION\s+SELECT</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100526" level="5">
    <description>Detects SQL injection attempt with OR '1'='1'</description>
    <match>OR\s+'1'='1'</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100527" level="4">
    <description>Detects SQL injection attempt using comment sequence</description>
    <match>--|#|/\*.*\*/</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100528" level="4">
    <description>Detects SQL injection attempt with sleep function to delay execution</description>
    <match>SLEEP\s*\(\s*\d+\s*\)</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100529" level="5">
    <description>Detects SQL injection attempt with UNION ALL SELECT</description>
    <match>UNION\s+ALL\s+SELECT</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100530" level="10">
    <description>Detects large data dumps from MySQL tables, indicating potential data exfiltration.</description>
    <match>SELECT \* FROM [a-zA-Z0-9_]+ INTO OUTFILE</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100531" level="9">
    <description>Detects usage of MySQL's 'mysqldump' utility which could be used for unauthorized data dumps.</description>
    <match>mysqldump --user=.* --password=.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100532" level="8">
    <description>Detects unauthorized user creation which could be used to exfiltrate data.</description>
    <match>CREATE USER '.*'@'.*' IDENTIFIED BY '.*'</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100533" level="7">
    <description>Detects anomalous login attempts from unusual IP addresses indicating potential unauthorized access.</description>
    <match>Access denied for user '.*'@'.*' \(using password: YES\)</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100534" level="6">
    <description>Detects attempts to disable MySQL logging, which could be used to cover tracks of data exfiltration.</description>
    <match>SET GLOBAL general_log = 'OFF'</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100535" level="5">
    <description>Detects brute force attacks by monitoring multiple failed login attempts from the same IP address</description>
    <match>Access denied for user '.*'@'([0-9]{1,3}\.){3}[0-9]{1,3}'</match>
    <group>Brute Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100536" level="4">
    <description>Detects SQL injection attempts by looking for common SQL injection patterns in queries</description>
    <match>('.+--)|(--)|(\|)|(%7C)</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100537" level="4">
    <description>Detects unauthorized data exfiltration attempts by monitoring large data export operations</description>
    <match>SELECT.*INTO OUTFILE</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="100538" level="3">
    <description>Detects privilege escalation attempts by monitoring for GRANT ALL PRIVILEGES commands</description>
    <match>GRANT ALL PRIVILEGES ON .* TO '.*'@'.*'</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1069</id>
    </mitre>
  </rule>
  <rule id="100539" level="2">
    <description>Detects suspicious access patterns by monitoring connections from unusual geographic locations</description>
    <match>Access granted for user '.*'@'([0-9]{1,3}\.){3}[0-9]{1,3}'</match>
    <group>Suspicious Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100540" level="4">
    <description>Detection of unauthorized user creation in MySQL.</description>
    <match>CREATE\s+USER.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100541" level="5">
    <description>Detection of privilege escalation by altering user privileges in MySQL.</description>
    <match>GRANT\s+ALL\s+PRIVILEGES.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100542" level="5">
    <description>Detection of data exfiltration by exporting database tables in MySQL.</description>
    <match>SELECT\s+.*\s+INTO\s+OUTFILE.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100543" level="3">
    <description>Detection of suspicious database schema modification in MySQL.</description>
    <match>ALTER\s+TABLE.*</match>
    <group>Schema Modification</group>
    <mitre>
      <id>T1490</id>
    </mitre>
  </rule>
  <rule id="100544" level="4">
    <description>Detection of potential SQL injection attempts in MySQL.</description>
    <match>';\s*--|\s*OR\s+1=1\s*;.*</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100545" level="5">
    <description>Detect unauthorized GRANT ALL PRIVILEGES to a user</description>
    <match>GRANT\s+ALL\s+PRIVILEGES\s+ON\s+.+\s+TO\s+['&quot;]?.+['&quot;]?@['&quot;]?.+['&quot;]?;</match>
    <group>Unauthorized Privilege Escalation</group>
    <mitre>
      <id>T1069.002</id>
    </mitre>
  </rule>
  <rule id="100546" level="4">
    <description>Detect unauthorized ALTER USER to escalate privileges</description>
    <match>ALTER\s+USER\s+['&quot;]?.+['&quot;]?@['&quot;]?.+['&quot;]?\s+.*(WITH\s+GRANT\s+OPTION|IDENTIFIED\s+BY\s+['&quot;]?.+['&quot;]?);</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="100547" level="3">
    <description>Detect unauthorized REVOKE operations on administrative privileges</description>
    <match>REVOKE\s+(ALL\s+PRIVILEGES|GRANT\s+OPTION)\s+ON\s+.+\s+FROM\s+['&quot;]?.+['&quot;]?@['&quot;]?.+['&quot;]?;</match>
    <group>Unauthorized Privilege Changes</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="100548" level="4">
    <description>Detect unauthorized CREATE USER statement</description>
    <match>CREATE\s+USER\s+['&quot;]?.+['&quot;]?@['&quot;]?.+['&quot;]?\s+IDENTIFIED\s+BY\s+['&quot;]?.+['&quot;]?;</match>
    <group>Unauthorized Account Creation</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="100549" level="5">
    <description>Detect unauthorized DROP USER statement</description>
    <match>DROP\s+USER\s+['&quot;]?.+['&quot;]?@['&quot;]?.+['&quot;]?;</match>
    <group>Unauthorized Account Deletion</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="100550" level="5">
    <description>Detect unauthorized addition of a new MySQL user with administrative privileges</description>
    <match>CREATE USER .* IDENTIFIED BY .*;.*GRANT ALL PRIVILEGES ON \*\.\* TO .*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.002</id>
    </mitre>
  </rule>
  <rule id="100551" level="4">
    <description>Detect unauthorized changes to existing MySQL user privileges</description>
    <match>GRANT (ALL PRIVILEGES|SUPER).* ON \*\.\* TO .*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="100552" level="4">
    <description>Detect unauthorized removal of MySQL user privileges</description>
    <match>REVOKE (ALL PRIVILEGES|SUPER).* ON \*\.\* FROM .*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="100553" level="3">
    <description>Detect unauthorized changes to MySQL user authentication methods</description>
    <match>ALTER USER .* IDENTIFIED WITH .*</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1078.004</id>
    </mitre>
  </rule>
  <rule id="100554" level="4">
    <description>Detect unauthorized deletion of MySQL users</description>
    <match>DROP USER .*</match>
    <group>Account Manipulation</group>
    <mitre>
      <id>T1531</id>
    </mitre>
  </rule>
  <rule id="100555" level="9">
    <description>Detects typical SQL injection attempts using UNION SELECT in MySQL queries</description>
    <match>UNION\s+SELECT</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100556" level="8">
    <description>Detects SQL injection attempts that use boolean-based blind techniques in MySQL queries</description>
    <match>'\s+OR\s+'1'='1</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100557" level="8">
    <description>Detects SQL injection attempts using stacked queries in MySQL</description>
    <match>;\s*SELECT</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100558" level="7">
    <description>Detects use of sleep functions in SQL injection timing attacks in MySQL queries</description>
    <match>SLEEP\s*\(\s*\d+\s*\)</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100559" level="6">
    <description>Detects SQL injection attempts that use comment sequences to bypass filters in MySQL queries</description>
    <match>--\s*|/\*\s*\*/</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100560" level="5">
    <description>Detects brute force login attempts by monitoring for multiple failed login attempts in a short period.</description>
    <match>Access denied for user '.*'@'.*' (using password: YES)</match>
    <group>unauthorized-access</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100561" level="4">
    <description>Detects successful login from an unusual IP address, indicating potential unauthorized access.</description>
    <match>Access granted for user '.*'@'unusual_ip'</match>
    <group>unauthorized-access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100562" level="5">
    <description>Detects attempts to escalate privileges by monitoring for the execution of GRANT ALL PRIVILEGES command.</description>
    <match>GRANT ALL PRIVILEGES ON .* TO '.*'@'.*'</match>
    <group>privilege-escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100563" level="4">
    <description>Detects access to sensitive databases, such as 'mysql' or 'information_schema', which may indicate an attempt to gather information or perform unauthorized actions.</description>
    <match>SELECT .* FROM (mysql|information_schema)\..*</match>
    <group>data-access</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100564" level="5">
    <description>Detects attempts to delete or alter logs, indicating an attempt to cover tracks or tamper with evidence.</description>
    <match>(DELETE|TRUNCATE|ALTER) .* FROM mysql.general_log</match>
    <group>tampering</group>
    <mitre>
      <id>T1070.002</id>
    </mitre>
  </rule>
  <rule id="100565" level="10">
    <description>Detects unauthorized addition of MySQL superuser privileges</description>
    <match>GRANT ALL PRIVILEGES ON \*\.\* TO '\w+'@'\w+'</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100566" level="8">
    <description>Detects unauthorized changes to MySQL user password</description>
    <match>ALTER USER '\w+'@'\w+' IDENTIFIED BY '\w+'</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100567" level="7">
    <description>Detects unauthorized revocation of MySQL user privileges</description>
    <match>REVOKE ALL PRIVILEGES, GRANT OPTION FROM '\w+'@'\w+'</match>
    <group>Privilege De-escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100568" level="9">
    <description>Detects unauthorized creation of new MySQL users with elevated privileges</description>
    <match>CREATE USER '\w+'@'\w+' IDENTIFIED BY '\w+'</match>
    <group>Account Creation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100569" level="6">
    <description>Detects unauthorized granting of MySQL replication privileges</description>
    <match>GRANT REPLICATION SLAVE, REPLICATION CLIENT ON \*\.\* TO '\w+'@'\w+'</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100570" level="9">
    <description>Detects large data export using mysqldump command</description>
    <match>mysqldump\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100571" level="8">
    <description>Detects use of SELECT INTO OUTFILE for exporting data</description>
    <match>SELECT\s+.*\s+INTO\s+OUTFILE\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100572" level="7">
    <description>Detects suspicious use of LOAD DATA INFILE which could be used for data infiltration</description>
    <match>LOAD\s+DATA\s+INFILE\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100573" level="8">
    <description>Detects the use of mysqlpump for large-scale data export</description>
    <match>mysqlpump\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100574" level="9">
    <description>Detects usage of UDFs (User Defined Functions) which can be used for malicious purposes</description>
    <match>CREATE\s+FUNCTION\s+.*\s+RETURNS\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1222</id>
    </mitre>
  </rule>
  <rule id="100575" level="9">
    <description>Detects SQL injection attempts in MySQL queries</description>
    <match>.*([';]+\s*|(--)\s*|\/\*.*\*\/).*</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100576" level="8">
    <description>Monitors for unauthorized user privilege escalations</description>
    <match>.*GRANT\s+(ALL|ALTER|CREATE|DELETE|DROP|EXECUTE|INSERT|SELECT|UPDATE).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100577" level="7">
    <description>Detects abnormal large data deletions in MySQL</description>
    <match>.*DELETE\s+FROM\s+.*\s+WHERE\s+.*;</match>
    <group>Data Deletion</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="100578" level="6">
    <description>Monitors for unusual data export operations</description>
    <match>.*SELECT\s+.*\s+INTO\s+OUTFILE\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100579" level="5">
    <description>Detects unauthorized changes to database schema</description>
    <match>.*ALTER\s+TABLE\s+.*\s+(ADD|DROP|MODIFY|CHANGE)\s+.*;</match>
    <group>Schema Manipulation</group>
    <mitre>
      <id>T1495</id>
    </mitre>
  </rule>
  <rule id="100580" level="5">
    <description>Detects unauthorized user creation</description>
    <match>CREATE USER '.*'@'.*'</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100581" level="5">
    <description>Detects unauthorized database schema changes</description>
    <match>ALTER DATABASE .*</match>
    <group>Database Schema Modification</group>
    <mitre>
      <id>T1496</id>
    </mitre>
  </rule>
  <rule id="100582" level="4">
    <description>Detects SQL injection attempts in query strings</description>
    <match>(UNION SELECT|SELECT .* FROM .* WHERE .* OR .*|'.* OR '1'='1)</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100583" level="4">
    <description>Detects unauthorized table truncation</description>
    <match>TRUNCATE TABLE .*</match>
    <group>Data Destruction</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="100584" level="4">
    <description>Detects unauthorized grant of privileges</description>
    <match>GRANT ALL PRIVILEGES ON .* TO '.*'@'.*'</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100585" level="5">
    <description>Detects usage of mysqldump command which is commonly used for data exfiltration</description>
    <match>\bmysqldump\b</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100586" level="4">
    <description>Detects large SELECT queries that may indicate data exfiltration attempts</description>
    <match>SELECT\s+.*\s+FROM\s+.*</match>
    <group>Suspicious Query</group>
    <mitre>
      <id>T1074</id>
    </mitre>
  </rule>
  <rule id="100587" level="5">
    <description>Detects attempts to write data to an external file using SELECT INTO OUTFILE</description>
    <match>SELECT\s+.*\s+INTO\s+OUTFILE\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100588" level="3">
    <description>Detects usage of LOAD DATA INFILE which can be used to import data for exfiltration</description>
    <match>\bLOAD\s+DATA\s+INFILE\b</match>
    <group>Data Import</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="100589" level="4">
    <description>Detects creation of new user accounts which might be used for unauthorized access and data exfiltration</description>
    <match>CREATE\s+USER\s+.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100590" level="5">
    <description>Detects MySQL database dump using mysqldump command</description>
    <match>(?i)\bmysqldump\b</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100591" level="4">
    <description>Detects unusual large data transfer from MySQL server</description>
    <match>(?i)\bSELECT\b.*\bINTO OUTFILE\b</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100592" level="5">
    <description>Detects use of netcat for MySQL data exfiltration</description>
    <match>(?i)\bnc\b.*\b3306\b</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100593" level="4">
    <description>Detects MySQL data exfiltration via HTTP</description>
    <match>(?i)\bcurl\b.*\b3306\b</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100594" level="5">
    <description>Detects MySQL database dump using mysqlpump command</description>
    <match>(?i)\bmysqlpump\b</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100595" level="9">
    <description>Detects SQL injection attempts using UNION SELECT to fetch unauthorized data</description>
    <match>(?i)(union select)</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100596" level="8">
    <description>Detects SQL injection by identifying patterns of tautology-based injections</description>
    <match>(?i)(' OR '1'='1)</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100597" level="9">
    <description>Detects SQL injection attempts that use stacked queries to execute multiple statements</description>
    <match>(?i)(;\s*select|;\s*insert|;\s*update|;\s*delete|;\s*drop)</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100598" level="7">
    <description>Detects SQL injection attempts aiming to bypass authentication using comments</description>
    <match>(?i)('--|;--|#)</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100599" level="8">
    <description>Detects blind SQL injection attempts by identifying time-based payloads</description>
    <match>(?i)(sleep\s*\()</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100600" level="9">
    <description>Detects large SELECT statements indicating potential data exfiltration</description>
    <match>SELECT\s+.*\s+FROM\s+.*\s+WHERE\s+.*\s+LIMIT\s+\d{6,}</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100601" level="10">
    <description>Detects mysqldump command execution to export databases</description>
    <match>mysqldump\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100602" level="8">
    <description>Detects unauthorized user creating a database dump file</description>
    <match>SELECT\s+.*\s+INTO\s+OUTFILE\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100603" level="7">
    <description>Detects multiple consecutive SELECT statements which may indicate data harvesting</description>
    <match>SELECT\s+.*\s+FROM\s+.*;\s+SELECT\s+.*\s+FROM\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100604" level="8">
    <description>Detects use of UNION SELECT for data extraction</description>
    <match>UNION\s+SELECT\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100605" level="10">
    <description>Detection of unauthorized GRANT ALL PRIVILEGES command execution</description>
    <match>\bGRANT ALL PRIVILEGES\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100606" level="9">
    <description>Detection of unauthorized addition of SUPER privilege to a user</description>
    <match>\bGRANT\s+SUPER\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100607" level="8">
    <description>Detection of unauthorized GRANT EXECUTE privilege to a user</description>
    <match>\bGRANT\s+EXECUTE\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100608" level="7">
    <description>Detection of unauthorized REVOKE ALL PRIVILEGES command execution</description>
    <match>\bREVOKE ALL PRIVILEGES\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100609" level="6">
    <description>Detection of unauthorized ALTER USER command execution</description>
    <match>\bALTER USER\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100610" level="5">
    <description>Detect unauthorized addition of new MySQL users with elevated privileges.</description>
    <match>GRANT ALL PRIVILEGES ON .* TO '.*'@'.*'</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100611" level="4">
    <description>Detect unauthorized changes to existing MySQL user privileges.</description>
    <match>GRANT .* ON .* TO '.*'@'.*'</match>
    <group>Privilege Modification</group>
    <mitre>
      <id>T1087</id>
    </mitre>
  </rule>
  <rule id="100612" level="3">
    <description>Detect unauthorized revocation of privileges from MySQL users.</description>
    <match>REVOKE .* ON .* FROM '.*'@'.*'</match>
    <group>Privilege Reduction</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100613" level="5">
    <description>Detect unauthorized creation of MySQL users with specific administrative privileges.</description>
    <match>CREATE USER '.*'@'.*' IDENTIFIED BY '.*'; GRANT ALL PRIVILEGES ON .* TO '.*'@'.*'</match>
    <group>Account Creation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100614" level="5">
    <description>Detect unauthorized changes to MySQL root user privileges.</description>
    <match>GRANT .* ON .* TO 'root'@'.*'</match>
    <group>Root Privilege Modification</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="100615" level="5">
    <description>Detects brute force attempts with multiple failed login attempts</description>
    <match>Access denied for user.*(password: YES)</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100616" level="4">
    <description>Detects successful login from unauthorized IP addresses</description>
    <match>Access granted for user.*(host: (?!127\.0\.0\.1|192\.168\.1\.1).*)</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100617" level="5">
    <description>Detects use of high-privilege accounts from non-trusted IP addresses</description>
    <match>Access granted for user 'root'.*(host: (?!127\.0\.0\.1|192\.168\.1\.1).*)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100618" level="4">
    <description>Detects unauthorized schema modifications (CREATE, DROP, ALTER)</description>
    <match>Query.*(CREATE|DROP|ALTER) TABLE.*</match>
    <group>Unauthorized Modifications</group>
    <mitre>
      <id>T1496</id>
    </mitre>
  </rule>
  <rule id="100619" level="5">
    <description>Detects data exfiltration attempts with SELECT queries on sensitive tables</description>
    <match>Query.*SELECT.*FROM (credit_cards|ssn|passwords).*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="100620" level="9">
    <description>Detects unauthorized attempts to grant all privileges to a user</description>
    <match>GRANT ALL PRIVILEGES.* TO '.*'@'.*'</match>
    <group>Unauthorized Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100621" level="8">
    <description>Detects unauthorized changes to user roles</description>
    <match>ALTER USER '.*'@'.*' IDENTIFIED BY '.*'</match>
    <group>Privilege Modification</group>
    <mitre>
      <id>T1087</id>
    </mitre>
  </rule>
  <rule id="100622" level="10">
    <description>Detects unauthorized creation of a new user with administrative privileges</description>
    <match>CREATE USER '.*'@'.*' IDENTIFIED BY '.*'; GRANT ALL PRIVILEGES ON \*\.\* TO '.*'@'.*'</match>
    <group>Unauthorized User Creation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100623" level="7">
    <description>Detects unauthorized revocation of all privileges from a user</description>
    <match>REVOKE ALL PRIVILEGES, GRANT OPTION FROM '.*'@'.*'</match>
    <group>Privilege Revocation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100624" level="6">
    <description>Detects unauthorized attempts to drop a user from the database</description>
    <match>DROP USER '.*'@'.*'</match>
    <group>User Deletion</group>
    <mitre>
      <id>T1489</id>
    </mitre>
  </rule>
  <rule id="100625" level="9">
    <description>Detects requests attempting to exploit the Shellshock vulnerability via HTTP headers.</description>
    <match>.*(\(\)|;|\{\})[\s]*echo.*</match>
    <group>Remote Code Execution</group>
    <mitre>
      <id>T1210</id>
    </mitre>
  </rule>
  <rule id="100626" level="8">
    <description>Detects SQL injection attempts in HTTP GET or POST parameters.</description>
    <match>(\%27|\')|(\-\-)|(\%23|#)|((\%3D|=)[^\n]*\%27|\')|((\%3D|=)[^\n]*\-\-)|((\%3D|=)[^\n]*\%23|#)</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100628" level="7">
    <description>Detects Local File Inclusion (LFI) attempts in HTTP parameters.</description>
    <match>(\.{2}\/(\w+\/)+)|(\/etc\/passwd)|(\/etc\/shadow)</match>
    <group>Local File Inclusion</group>
    <mitre>
      <id>T1185</id>
    </mitre>
  </rule>
  <rule id="100629" level="6">
    <description>Detects Directory Traversal attempts in HTTP parameters.</description>
    <match>(\.{2}\/)+</match>
    <group>Directory Traversal</group>
    <mitre>
      <id>T1004</id>
    </mitre>
  </rule>
  <rule id="100632" level="4">
    <description>Identifies attempts to use JavaScript event handlers to execute malicious code</description>
    <match>on\w+\s*=\s*['&quot;]?javascript:.*?['&quot;]?</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100633" level="3">
    <description>Detects suspicious use of document.cookie in URL parameters</description>
    <match>document\.cookie</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100634" level="4">
    <description>Detects attempts to use innerHTML to inject malicious scripts</description>
    <match>innerHTML\s*=\s*['&quot;].*?['&quot;]</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100636" level="4">
    <description>Detects suspicious JavaScript event handlers in query strings</description>
    <match>(onerror|onload|onclick|onmouseover)=</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100638" level="3">
    <description>Detects encoded XSS attack vectors in URL parameters</description>
    <match>(%3C|%3E|%22|%27|%28|%29)</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100639" level="3">
    <description>Detects attempts to inject JavaScript via document.write</description>
    <match>(document.write|document.writeln)</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100640" level="10">
    <description>Detect unauthorized modifications to the Apache configuration file (httpd.conf)</description>
    <match>(?i)\b(?:chmod|chown|mv|rm)\s+.*httpd\.conf\b</match>
    <group>Configuration Modification</group>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
  <rule id="100641" level="9">
    <description>Detect suspicious inclusion of new modules in Apache configuration</description>
    <match>(?i)\b(?:LoadModule)\s+.*\bmod_.*\.so\b</match>
    <group>Module Injection</group>
    <mitre>
      <id>T1222</id>
    </mitre>
  </rule>
  <rule id="100642" level="8">
    <description>Detect unauthorized access to Apache configuration directories</description>
    <match>(?i)\b(?:access\s+.*(?:/etc/apache2|/usr/local/apache2/conf))\b</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100644" level="6">
    <description>Detect unauthorized changes to Apache log configuration</description>
    <match>(?i)\b(?:LogFormat|CustomLog|ErrorLog)\b</match>
    <group>Log Configuration</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100646" level="9">
    <description>Detects encoded XSS attacks attempting to bypass basic input filters</description>
    <match>(%3C%73%63%72%69%70%74%3E|%3C%2F%73%63%72%69%70%74%3E|%3C%69%6D%67%20%73%72%63=)</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100649" level="6">
    <description>Detects use of JavaScript URIs which are often used in XSS attacks</description>
    <match>(javascript:|data:text/html|vbscript:|mocha:|livescript:)</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100650" level="10">
    <description>Detects a high number of requests from a single IP address within a short time frame, indicating a potential DDoS attack.</description>
    <match>^([\d.]+) - - \[.+\] &quot;.+&quot; 200 .+$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100651" level="8">
    <description>Identifies requests with unusually large payloads, which can be a sign of a Slowloris attack.</description>
    <match>^([\d.]+) - - \[.+\] &quot;.+&quot; 200 [1-9][0-9]{5,} .+$</match>
    <group>Slowloris</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100652" level="9">
    <description>Detects burst traffic patterns where multiple different IPs make rapid requests to the same endpoint, suggesting a distributed attack.</description>
    <match>^([\d.]+) - - \[.+\] &quot;.+&quot; 200 .+$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100653" level="7">
    <description>Monitors for requests with unusual User-Agent strings, often used by bots in DDoS attacks.</description>
    <match>^([\d.]+) - - \[.+\] &quot;.+&quot; 200 .+ &quot;-&quot; &quot;.*(curl|Wget|bot|crawler).*$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100654" level="6">
    <description>Identifies requests to non-existent URLs, which can indicate a probing attack or a part of a DDoS strategy.</description>
    <match>^([\d.]+) - - \[.+\] &quot;.+&quot; 404 .+$</match>
    <group>Probing</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100655" level="5">
    <description>Detect attempts to exploit Sudo privilege escalation vulnerability (CVE-2019-14287)</description>
    <match>.*sudo.*-u#-1.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100656" level="4">
    <description>Detect suspicious use of LD_PRELOAD environment variable to escalate privileges</description>
    <match>.*LD_PRELOAD.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1055</id>
    </mitre>
  </rule>
  <rule id="100657" level="5">
    <description>Detect attempts to exploit Shellshock vulnerability via HTTP headers</description>
    <match>.*() { :;}; .*</match>
    <group>Remote Code Execution</group>
    <mitre>
      <id>T1210</id>
    </mitre>
  </rule>
  <rule id="100658" level="4">
    <description>Detect creation of unauthorized SUID files</description>
    <match>chmod\s[+]s</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1166</id>
    </mitre>
  </rule>
  <rule id="100659" level="5">
    <description>Detect attempts to modify /etc/passwd file</description>
    <match>.*vi.*\/etc\/passwd.*|.*nano.*\/etc\/passwd.*|.*echo.*&gt;&gt;.*\/etc\/passwd.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100660" level="5">
    <description>Detect unauthorized modifications to Apache configuration files (e.g., httpd.conf)</description>
    <match>.*\s/etc/apache2/httpd\.conf\s.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1505</id>
    </mitre>
  </rule>
  <rule id="100661" level="4">
    <description>Monitor attempts to modify .htaccess files, potentially used to override security settings</description>
    <match>.*\s/var/www/.*\.htaccess\s.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100662" level="3">
    <description>Detect the creation or modification of custom configuration files in the conf.d directory</description>
    <match>.*\s/etc/apache2/conf\.d/.*\.conf\s.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1505</id>
    </mitre>
  </rule>
  <rule id="100663" level="4">
    <description>Monitor unauthorized changes to the Apache environment variables file (envvars)</description>
    <match>.*\s/etc/apache2/envvars\s.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1505</id>
    </mitre>
  </rule>
  <rule id="100664" level="3">
    <description>Detect suspicious modifications to the Apache mime.types file, which may indicate an attempt to execute unauthorized scripts</description>
    <match>.*\s/etc/apache2/mime\.types\s.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1505</id>
    </mitre>
  </rule>
  <rule id="100665" level="10">
    <description>Detects attempts to exploit the Apache Struts vulnerability (CVE-2017-5638) via HTTP requests.</description>
    <match>.*(Content-Type|content-type|multipart/form-data).*\.sh\b.*</match>
    <group>Remote Code Execution</group>
    <mitre>
      <id>T1059.004</id>
    </mitre>
  </rule>
  <rule id="100666" level="9">
    <description>Detects SQL injection attempts in HTTP requests targeting Apache servers.</description>
    <match>.*(\bSELECT\b|\bUNION\b|\bINSERT\b|\bUPDATE\b|\bDELETE\b).*(FROM|WHERE|TABLE).*</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1505</id>
    </mitre>
  </rule>
  <rule id="100668" level="7">
    <description>Detects Directory Traversal attacks attempting to access restricted files in Apache servers.</description>
    <match>.*(\.{2}/|%2E%2E/|\.{2}%5C|%2E%2E%5C).*</match>
    <group>Directory Traversal</group>
    <mitre>
      <id>T1006</id>
    </mitre>
  </rule>
  <rule id="100669" level="9">
    <description>Detects attempts to exploit Apache Tomcat GhostCat vulnerability (CVE-2020-1938).</description>
    <match>.*AJP13:.*</match>
    <group>Remote Code Execution</group>
    <mitre>
      <id>T1210</id>
    </mitre>
  </rule>
  <rule id="100671" level="8">
    <description>Identifies suspicious HTML attributes that are commonly used in XSS payloads.</description>
    <match>(onerror|onload|onmouseover|onclick)\s*=\s*(['&quot;]?)[^&gt;]+\2</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100672" level="8">
    <description>Detects encoded XSS attacks that attempt to bypass input validation by using HTML entities.</description>
    <match>&amp;(#x[0-9a-f]+|#[0-9]+|[a-z]+);</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100673" level="7">
    <description>Monitors for common JavaScript event handlers used in XSS attacks.</description>
    <match>&amp;#x6F;&amp;#x6E;[^=]*=|\u006F\u006E[^=]*=|\b(on\w+\s*=)</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100674" level="6">
    <description>Detects suspicious URLs that contain JavaScript code attempts in query parameters.</description>
    <match>javascript:\w+</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100675" level="9">
    <description>Detects SQL Injection attempts through URL parameters targeting Apache vulnerabilities.</description>
    <match>(?i)(union\s+select|select\s+.*from|insert\s+into|update\s+.*set|delete\s+from).*--</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1505</id>
    </mitre>
  </rule>
  <rule id="100676" level="10">
    <description>Detects attempts to exploit Apache Struts vulnerability (CVE-2017-5638) via malicious Content-Type header.</description>
    <match>(?i)Content-Type:\s*%{.*?\$\{.*?\}}</match>
    <group>Remote Code Execution</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100678" level="8">
    <description>Detects Directory Traversal attacks aimed at accessing restricted directories on Apache server.</description>
    <match>(?i)\.{2}\/(\.{2}\/)+</match>
    <group>Directory Traversal</group>
    <mitre>
      <id>T1006</id>
    </mitre>
  </rule>
  <rule id="100679" level="9">
    <description>Identifies HTTP requests attempting to exploit the Shellshock vulnerability (CVE-2014-6271) in Apache servers.</description>
    <match>(?i)()\s*\{\s*:;\s*\};.*</match>
    <group>Remote Code Execution</group>
    <mitre>
      <id>T1210</id>
    </mitre>
  </rule>
  <rule id="100680" level="5">
    <description>Detects a high volume of requests from a single IP address within a short period, indicating a potential DDoS attack.</description>
    <match>\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b - - \[.*\] &quot;GET /.*&quot; 200 .*</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100681" level="4">
    <description>Identifies a surge in POST requests indicating a potential application layer DDoS attack.</description>
    <match>\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b - - \[.*\] &quot;POST /.*&quot; 200 .*</match>
    <group>Application Layer DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100682" level="3">
    <description>Monitors for unusual spike in 403 Forbidden responses, which could indicate a potential DDoS attack targeting access restrictions.</description>
    <match>\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b - - \[.*\] &quot;GET /.*&quot; 403 .*</match>
    <group>Access Control DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100683" level="4">
    <description>Detects an abnormal number of requests to the same URL path, indicating a potential URL-based DDoS attack.</description>
    <match>\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b - - \[.*\] &quot;GET /specific-path.*&quot; 200 .*</match>
    <group>URL-based DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100684" level="5">
    <description>Monitors for a high number of 500 Internal Server Error responses, which could indicate a DDoS attack overwhelming the server.</description>
    <match>\b(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b - - \[.*\] &quot;GET /.*&quot; 500 .*</match>
    <group>Server Overload DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100685" level="5">
    <description>Detects high volume of requests from a single IP address within a short time frame, indicating potential DDoS attack.</description>
    <match>^([0-9]{1,3}\.){3}[0-9]{1,3} - - \[.*\] &quot;.*&quot; 200 .*&quot;$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100686" level="4">
    <description>Detects unusual spike in POST requests which may indicate a DDoS attack using POST flood.</description>
    <match>&quot;POST .* HTTP/1\.[01]&quot; 200 .*</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499.001</id>
    </mitre>
  </rule>
  <rule id="100687" level="4">
    <description>Detects high frequency of requests to a specific resource, indicating potential layer 7 DDoS attack.</description>
    <match>&quot;GET /specificresource HTTP/1\.[01]&quot; 200 .*</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499.003</id>
    </mitre>
  </rule>
  <rule id="100688" level="3">
    <description>Detects malformed requests potentially used in DDoS attacks to exhaust server resources.</description>
    <match>&quot;\x.*&quot; 400 .*</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499.004</id>
    </mitre>
  </rule>
  <rule id="100689" level="5">
    <description>Detects high volume of concurrent connections from different IPs targeting the same resource, indicating a Distributed DDoS attack.</description>
    <match>^([0-9]{1,3}\.){3}[0-9]{1,3} - - \[.*\] &quot;.*&quot; 200 .*</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100690" level="9">
    <description>Detects attempts to exploit Apache Local File Inclusion (LFI) vulnerabilities to escalate privileges.</description>
    <match>(\.|%2e){2}/</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1006</id>
    </mitre>
  </rule>
  <rule id="100692" level="10">
    <description>Detects exploitation of Apache mod_cgi vulnerabilities to gain unauthorized root access.</description>
    <match>(/cgi-bin/|\.cgi\?)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100693" level="7">
    <description>Monitors for suspicious HTTP requests attempting to manipulate Apache configuration files (e.g., .htaccess) to gain higher privileges.</description>
    <match>(\.(htaccess|htpasswd)\b)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1055</id>
    </mitre>
  </rule>
  <rule id="100694" level="9">
    <description>Detects exploitation attempts on Apache mod_ssl vulnerabilities to escalate privileges.</description>
    <match>(OpenSSL|mod_ssl)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100696" level="4">
    <description>Detects encoded XSS attacks using hex or unicode encoding in input parameters.</description>
    <match>(&amp;#x[0-9A-Fa-f]+;|%u[0-9A-Fa-f]{4})</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100697" level="3">
    <description>Detects suspicious HTML event handlers in user inputs.</description>
    <match>(onmouseover=|onfocus=|onerror=|onload=|onclick=)</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100699" level="2">
    <description>Detects suspicious use of 'src' attribute pointing to external resources.</description>
    <match>(src=\&quot;https?:\/\/|src=\'https?:\/\/)</match>
    <group>XSS</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="100700" level="5">
    <description>Detects attempts to exploit the Apache mod_cgi module to execute unauthorized commands</description>
    <match>.*\b(mod_cgi|mod_cgid)\b.*\b(exec|cmd)\b.*</match>
    <group>Privilege Escalation, Code Execution</group>
    <mitre>
      <id>T1059.001</id>
    </mitre>
  </rule>
  <rule id="100701" level="4">
    <description>Detects suspicious sudo command execution through web requests</description>
    <match>.*\bsudo\b.*</match>
    <group>Privilege Escalation, Command Execution</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100702" level="5">
    <description>Detects attempts to exploit the Shellshock vulnerability via HTTP headers</description>
    <match>.*\()\s*{\s*:;\s*}.+</match>
    <group>Privilege Escalation, Code Injection</group>
    <mitre>
      <id>T1210</id>
    </mitre>
  </rule>
  <rule id="100703" level="3">
    <description>Detects unauthorized access attempts to sensitive files like /etc/passwd</description>
    <match>.*GET\s+/etc/passwd.*</match>
    <group>Privilege Escalation, Information Disclosure</group>
    <mitre>
      <id>T1003</id>
    </mitre>
  </rule>
  <rule id="100704" level="4">
    <description>Detects attempts to escalate privileges via exploitation of SUID/SGID binaries</description>
    <match>.*chmod\s+\d{3,4}\s+.*(/bin/|/sbin/|/usr/bin/|/usr/sbin/).*</match>
    <group>Privilege Escalation, SUID/SGID Exploit</group>
    <mitre>
      <id>T1548.001</id>
    </mitre>
  </rule>
  <rule id="100705" level="5">
    <description>Detect usage of 'sudo' command within Apache server logs, indicating potential privilege escalation</description>
    <match>.*sudo.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100706" level="4">
    <description>Monitor for attempts to modify system files via Apache server, which may indicate privilege escalation</description>
    <match>.*(chmod|chown|chgrp).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1003</id>
    </mitre>
  </rule>
  <rule id="100707" level="5">
    <description>Detect suspicious 'pkexec' command usage in Apache server logs, indicating possible privilege escalation</description>
    <match>.*pkexec.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100708" level="4">
    <description>Monitor Apache logs for attempts to exploit the 'su' command, indicating potential privilege escalation</description>
    <match>.*su\s+-.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1169</id>
    </mitre>
  </rule>
  <rule id="100709" level="5">
    <description>Detect attempts to escalate privileges by executing scripts with elevated permissions via Apache server</description>
    <match>.*(bash|sh)\s+-c\s+.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100710" level="9">
    <description>Detects attempts to execute unauthorized root commands via Apache web server</description>
    <match>sudo\s+[^\s]+\s*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100711" level="8">
    <description>Detects suspicious modifications to /etc/passwd file via Apache web server</description>
    <match>echo\s+['&quot;][^'&quot;]*['&quot;]\s*&gt;\s*/etc/passwd</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.001</id>
    </mitre>
  </rule>
  <rule id="100712" level="9">
    <description>Detects attempts to add new users with root privileges via Apache web server</description>
    <match>useradd\s+-ou\s+0</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="100713" level="8">
    <description>Detects attempts to exploit SUID binaries to escalate privileges via Apache web server</description>
    <match>chmod\s+u\+s</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1548.001</id>
    </mitre>
  </rule>
  <rule id="100714" level="7">
    <description>Detects suspicious logins to root via Apache web server</description>
    <match>su\s+-\s+root</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.002</id>
    </mitre>
  </rule>
  <rule id="100715" level="5">
    <description>Detects SQL Injection attempts in HTTP requests targeting Apache servers.</description>
    <match>(?i)(union select|select.*from.*information_schema.tables|select.*from.*mysql.db)</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100717" level="4">
    <description>Detects Directory Traversal attacks attempting to access restricted files.</description>
    <match>(\.{2}/|\.{2}\\|\.{2,}/|\.{2,}\\)</match>
    <group>Directory Traversal</group>
    <mitre>
      <id>T1006</id>
    </mitre>
  </rule>
  <rule id="100718" level="5">
    <description>Detects Remote Code Execution (RCE) attempts in HTTP requests.</description>
    <match>(\b(exec|system|passthru|shell_exec|popen|proc_open|pcntl_exec)\b)</match>
    <group>Remote Code Execution</group>
    <mitre>
      <id>T1059.001</id>
    </mitre>
  </rule>
  <rule id="100719" level="5">
    <description>Detects attempts to exploit Apache Struts vulnerabilities through crafted HTTP requests.</description>
    <match>(%{.*?}|\$\{.*?\}|\[\[.*?\]\])</match>
    <group>Apache Struts Exploit</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100720" level="9">
    <description>Detects attempts to gain root access via Apache Web Server exploiting CVE-2021-41773</description>
    <match>.*(root|bin|sbin|etc/passwd).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100721" level="8">
    <description>Detects suspicious sudo command execution from Apache process</description>
    <match>.*sudo.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100722" level="7">
    <description>Detects Apache Web Server configuration changes attempting privilege escalation</description>
    <match>.*(AllowOverride|Options).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1222</id>
    </mitre>
  </rule>
  <rule id="100723" level="9">
    <description>Detects execution of shell commands via Apache exploiting CVE-2019-0211</description>
    <match>.*(sh|bash|dash|zsh).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100724" level="8">
    <description>Detects suspicious file uploads to Apache server attempting to gain higher privileges</description>
    <match>.*(\.php3?|\.pl|\.py).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1505</id>
    </mitre>
  </rule>
  <rule id="100725" level="5">
    <description>Detects unauthorized modifications to Apache configuration files.</description>
    <match>.*\b(?:sudo|root)\b.*\b(?:apache2|httpd)\b.*\b(?:conf|config|configuration)\b.*</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1070.004</id>
    </mitre>
  </rule>
  <rule id="100726" level="4">
    <description>Detects changes in Apache configuration through direct file edits.</description>
    <match>.*\b(?:vim|nano|vi|emacs|sed)\b.*\b(?:/etc/apache2|/etc/httpd)\b.*\b(?:conf|config|configuration)\b.*</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1003</id>
    </mitre>
  </rule>
  <rule id="100727" level="4">
    <description>Detects suspicious commands to restart Apache service after modifying configuration.</description>
    <match>.*\b(?:systemctl|service)\b.*\brestart\b.*\b(?:apache2|httpd)\b.*</match>
    <group>Service Manipulation</group>
    <mitre>
      <id>T1569.002</id>
    </mitre>
  </rule>
  <rule id="100728" level="3">
    <description>Detects unauthorized attempts to access or modify .htaccess files.</description>
    <match>.*\b(?:sudo|root)\b.*\b(?:/var/www|/usr/local/apache2/htdocs)\b.*\.htaccess\b.*</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1070.004</id>
    </mitre>
  </rule>
  <rule id="100729" level="3">
    <description>Detects suspicious access to Apache logs potentially indicating log tampering.</description>
    <match>.*\b(?:sudo|root)\b.*\b(?:/var/log/apache2|/var/log/httpd)\b.*</match>
    <group>Log Manipulation</group>
    <mitre>
      <id>T1070.001</id>
    </mitre>
  </rule>
  <rule id="100730" level="5">
    <description>Detects attempts to exploit Apache Struts2 vulnerability (CVE-2017-5638) by checking for payload in Content-Type header</description>
    <match>Content-Type:\s*\w*\W*(\$\{[^}]+\})</match>
    <group>Remote Code Execution</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100731" level="4">
    <description>Detects suspicious requests containing '/etc/passwd' which may indicate an attempt to access sensitive files</description>
    <match>GET\s.*\/etc\/passwd</match>
    <group>Information Disclosure</group>
    <mitre>
      <id>T1185</id>
    </mitre>
  </rule>
  <rule id="100732" level="5">
    <description>Detects attempts to exploit the Apache mod_ssl buffer overflow vulnerability (CVE-2003-0192)</description>
    <match>GET\s.*\%3B\s.*\%3B</match>
    <group>Buffer Overflow</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100733" level="3">
    <description>Detects suspicious User-Agent strings commonly used by web application vulnerability scanners</description>
    <match>User-Agent:\s*(sqlmap|nikto|w3af|acunetix)</match>
    <group>Reconnaissance</group>
    <mitre>
      <id>T1595</id>
    </mitre>
  </rule>
  <rule id="100734" level="4">
    <description>Detects attempts to exploit Apache mod_php remote code execution vulnerability (CVE-2012-1823)</description>
    <match>GET\s.*\?a=\-d\s.*\%3B\s.*</match>
    <group>Remote Code Execution</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100735" level="5">
    <description>Detects high volume of requests from a single IP indicating potential DDoS attack</description>
    <match>^\S+ \S+ \S+ \[.*\] &quot;GET / HTTP/1.1&quot; 200 \S+ &quot;-&quot; &quot;-&quot;$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100736" level="4">
    <description>Detects multiple requests for non-existent URLs indicating potential DDoS attack</description>
    <match>^\S+ \S+ \S+ \[.*\] &quot;GET /nonexistentpage HTTP/1.1&quot; 404 \S+ &quot;-&quot; &quot;-&quot;$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100737" level="5">
    <description>Detects unusually high number of POST requests which may indicate a DDoS attack</description>
    <match>^\S+ \S+ \S+ \[.*\] &quot;POST /.* HTTP/1.1&quot; 200 \S+ &quot;-&quot; &quot;-&quot;$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100738" level="4">
    <description>Detects a surge in requests for .php files indicating potential DDoS attack</description>
    <match>^\S+ \S+ \S+ \[.*\] &quot;GET /.*\.php HTTP/1.1&quot; 200 \S+ &quot;-&quot; &quot;-&quot;$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100739" level="3">
    <description>Detects high volume of requests with unusual User-Agent strings indicating potential DDoS attack</description>
    <match>^\S+ \S+ \S+ \[.*\] &quot;GET /.* HTTP/1.1&quot; 200 \S+ &quot;-&quot; &quot;Mozilla/5.0 \(compatible;.*\)$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100740" level="5">
    <description>Detects IAM policy changes that grant administrative privileges, indicating a potential privilege escalation attempt.</description>
    <match>iam.amazonaws.com.*(AttachPolicy|PutUserPolicy|PutRolePolicy).*&quot;Action&quot;:(.*\*|\*.*)</match>
    <group>privilege_escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100741" level="4">
    <description>Detects the creation of new IAM users with administrative privileges, which might indicate an unauthorized access attempt.</description>
    <match>iam.amazonaws.com.*(CreateUser|AttachUserPolicy|PutUserPolicy).*&quot;Action&quot;:&quot;iam:.*Admin*</match>
    <group>privilege_escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100742" level="4">
    <description>Monitors for changes to the IAM account password policy that reduce security requirements, which may indicate an attempt to weaken security.</description>
    <match>iam.amazonaws.com.*UpdateAccountPasswordPolicy.*&quot;MinimumPasswordLength&quot;:(6|7|8|9)</match>
    <group>defense_evasion</group>
    <mitre>
      <id>T1556</id>
    </mitre>
  </rule>
  <rule id="100743" level="3">
    <description>Detects suspicious IAM role creations with excessive permissions, indicating a potential privilege escalation attempt.</description>
    <match>iam.amazonaws.com.*CreateRole.*&quot;AssumeRolePolicyDocument&quot;:.*\*.*</match>
    <group>privilege_escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100744" level="3">
    <description>Identifies IAM actions that grant cross-account access, which could indicate an attempt to access resources in another account.</description>
    <match>iam.amazonaws.com.*(CreatePolicy|PutUserPolicy|PutRolePolicy).*&quot;Effect&quot;:&quot;Allow&quot;.*&quot;Principal&quot;:\{.*&quot;AWS&quot;:.*\}</match>
    <group>initial_access</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100745" level="5">
    <description>Detects unauthorized access to S3 buckets by non-approved IP addresses.</description>
    <match>s3.amazonaws.com.* - - .* 403 Forbidden</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100746" level="4">
    <description>Identifies large data transfers from S3 buckets to external destinations.</description>
    <match>s3.amazonaws.com.* - - .* 200 OK.* bytes transferred</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="100747" level="4">
    <description>Alerts on the creation of publicly accessible S3 buckets.</description>
    <match>s3.amazonaws.com.* - - .*ACL set to public-read</match>
    <group>Misconfiguration</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100748" level="3">
    <description>Detects unusual data access patterns indicating potential exfiltration.</description>
    <match>s3.amazonaws.com.* - - .* unusual access pattern</match>
    <group>Anomaly Detection</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="100749" level="3">
    <description>Flags the use of temporary credentials to access S3 buckets.</description>
    <match>s3.amazonaws.com.* - - .* AssumeRole.* temporary credentials</match>
    <group>Credential Abuse</group>
    <mitre>
      <id>T1078.002</id>
    </mitre>
  </rule>
  <rule id="100750" level="5">
    <description>Detects unauthorized IAM user access to S3 bucket.</description>
    <match>UnauthorizedAccess:.*s3.amazonaws.com</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1530</id>
    </mitre>
  </rule>
  <rule id="100751" level="4">
    <description>Detects large data transfers from S3 buckets indicating potential data exfiltration.</description>
    <match>LargeDataTransfer:.*s3.amazonaws.com</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="100752" level="4">
    <description>Detects S3 bucket policy changes that grant public access.</description>
    <match>BucketPolicyChange:.*s3.amazonaws.com.*Allow.*&quot;Principal&quot;: &quot;*&quot;</match>
    <group>Policy Change</group>
    <mitre>
      <id>T1530</id>
    </mitre>
  </rule>
  <rule id="100753" level="3">
    <description>Detects unusual data download patterns from S3 buckets.</description>
    <match>UnusualDownloadPattern:.*s3.amazonaws.com</match>
    <group>Anomalous Behavior</group>
    <mitre>
      <id>T1039</id>
    </mitre>
  </rule>
  <rule id="100754" level="3">
    <description>Detects removal of S3 bucket logging configuration.</description>
    <match>RemoveBucketLogging:.*s3.amazonaws.com</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1530</id>
    </mitre>
  </rule>
  <rule id="100755" level="5">
    <description>Detects unauthorized start of EC2 instances by users not in the admin group</description>
    <match>StartInstances.*&quot;userName&quot;:&quot;(?!adminGroup).*&quot;</match>
    <group>UnauthorizedAccess</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100756" level="4">
    <description>Detects multiple EC2 instance stops within a short time period indicating possible disruption</description>
    <match>StopInstances.*&quot;timestamp&quot;:&quot;.*</match>
    <group>DenialOfService</group>
    <mitre>
      <id>T1489</id>
    </mitre>
  </rule>
  <rule id="100757" level="4">
    <description>Detects unauthorized EC2 instance stop commands issued outside of business hours</description>
    <match>StopInstances.*&quot;timestamp&quot;:&quot;(?!.*T08:00:00Z|.*T18:00:00Z).*&quot;</match>
    <group>UnauthorizedAccess</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100758" level="3">
    <description>Detects EC2 instance start commands from unusual IP addresses</description>
    <match>StartInstances.*&quot;sourceIPAddress&quot;:&quot;(?!10\.0\.0\.\d{1,3}|192\.168\.\d{1,3}\.\d{1,3}).*&quot;</match>
    <group>SuspiciousActivity</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100759" level="3">
    <description>Detects high frequency of EC2 instance start and stop indicating potential brute force or misconfiguration</description>
    <match>(StartInstances|StopInstances).*&quot;requestParameters&quot;:{.*&quot;instanceId&quot;:&quot;.*&quot;}</match>
    <group>BruteForce</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100760" level="5">
    <description>Detects unauthorized attempts to access S3 buckets from non-whitelisted IP addresses indicating potential data exfiltration.</description>
    <match>arn:aws:s3:::.*\/(.*)</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100761" level="4">
    <description>Detects sudden large data transfers from S3 buckets to external destinations, which may indicate data exfiltration.</description>
    <match>arn:aws:s3:::.*\/(.*)\b(GET|PUT|COPY|POST|DELETE)\b.*(\d{10,})</match>
    <group>Large Data Transfers</group>
    <mitre>
      <id>T1537</id>
    </mitre>
  </rule>
  <rule id="100762" level="4">
    <description>Detects unusual S3 bucket policy changes that could allow unauthorized access and exfiltration of data.</description>
    <match>arn:aws:s3:::.*\/(.*)\b(put-bucket-policy)\b</match>
    <group>Policy Changes</group>
    <mitre>
      <id>T1484</id>
    </mitre>
  </rule>
  <rule id="100763" level="3">
    <description>Detects excessive S3 ListBucket operations which may indicate recon activity prior to data exfiltration.</description>
    <match>arn:aws:s3:::.*\/(.*)\b(ListBucket)\b</match>
    <group>Reconnaissance</group>
    <mitre>
      <id>T1592</id>
    </mitre>
  </rule>
  <rule id="100764" level="4">
    <description>Detects deletion of S3 bucket access logs which may indicate an attempt to cover tracks of data exfiltration.</description>
    <match>arn:aws:s3:::.*\/(.*)\b(DeleteBucketLogging)\b</match>
    <group>Log Tampering</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100765" level="10">
    <description>Detect unauthorized creation of new IAM users, indicating potential unauthorized access</description>
    <match>CreateUser</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100766" level="9">
    <description>Detect suspicious API calls for deleting CloudTrail logs, which could indicate an attempt to cover tracks</description>
    <match>DeleteTrail</match>
    <group>Log Tampering</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100767" level="8">
    <description>Detect unusual API calls for creating or modifying security groups, indicating potential network compromise</description>
    <match>AuthorizeSecurityGroupIngress|AuthorizeSecurityGroupEgress|RevokeSecurityGroupIngress|RevokeSecurityGroupEgress</match>
    <group>Network Intrusion</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100768" level="7">
    <description>Detect API calls to create EC2 instances in unusual regions, which may indicate suspicious activity</description>
    <match>RunInstances</match>
    <group>Suspicious Activity</group>
    <mitre>
      <id>T1520</id>
    </mitre>
  </rule>
  <rule id="100769" level="9">
    <description>Detect attempts to escalate privileges by attaching policies to IAM roles</description>
    <match>AttachRolePolicy</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100770" level="5">
    <description>Detect unauthorized modifications to AWS security group rules allowing inbound traffic from any IP address.</description>
    <match>\bAuthorizeSecurityGroupIngress\b.*\bCidrIp\b.*\b0\.0\.0\.0/0\b</match>
    <group>Network Security</group>
    <mitre>
      <id>T1136.003</id>
    </mitre>
  </rule>
  <rule id="100771" level="4">
    <description>Detect changes to AWS VPC subnet configurations that could expose internal resources to the public internet.</description>
    <match>\bModifySubnetAttribute\b.*\bMapPublicIpOnLaunch\b.*\btrue\b</match>
    <group>Network Configuration</group>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
  <rule id="100772" level="5">
    <description>Detect attempts to create permissive security group rules that allow all outbound traffic.</description>
    <match>\bAuthorizeSecurityGroupEgress\b.*\bIpProtocol\b.*\b-1\b.*\bCidrIp\b.*\b0\.0\.0\.0/0\b</match>
    <group>Network Security</group>
    <mitre>
      <id>T1133</id>
    </mitre>
  </rule>
  <rule id="100773" level="3">
    <description>Detect deletion of security group rules that may expose services to unauthorized access.</description>
    <match>\bRevokeSecurityGroupIngress\b</match>
    <group>Network Security</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="100774" level="4">
    <description>Detect creation of new VPC peering connections that could be used for lateral movement.</description>
    <match>\bCreateVpcPeeringConnection\b</match>
    <group>Network Configuration</group>
    <mitre>
      <id>T1091</id>
    </mitre>
  </rule>
  <rule id="100775" level="5">
    <description>Detects IAM policy changes that grant administrative privileges</description>
    <match>iam:PutUserPolicy|iam:PutGroupPolicy|iam:PutRolePolicy.*(&quot;Effect&quot;:&quot;Allow&quot;,&quot;Action&quot;:&quot;\*&quot;,&quot;Resource&quot;:&quot;\*&quot;)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100776" level="4">
    <description>Detects creation of new IAM users with administrative privileges</description>
    <match>iam:CreateUser.*(&quot;Effect&quot;:&quot;Allow&quot;,&quot;Action&quot;:&quot;\*&quot;,&quot;Resource&quot;:&quot;\*&quot;)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1098.001</id>
    </mitre>
  </rule>
  <rule id="100777" level="4">
    <description>Detects IAM roles being modified to include administrative privileges</description>
    <match>iam:UpdateAssumeRolePolicy.*(&quot;Effect&quot;:&quot;Allow&quot;,&quot;Action&quot;:&quot;\*&quot;,&quot;Resource&quot;:&quot;\*&quot;)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1098.003</id>
    </mitre>
  </rule>
  <rule id="100778" level="5">
    <description>Detects the use of the root account, which is typically unnecessary and risky</description>
    <match>iam:CreateAccessKey|iam:DeleteAccessKey|iam:UpdateAccessKey.*(&quot;UserName&quot;:&quot;root&quot;)</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100779" level="3">
    <description>Detects unusual activity indicating potential IAM credential compromise</description>
    <match>iam:GenerateCredentialReport|iam:ListAccessKeys.*(&quot;Action&quot;:&quot;iam:GenerateCredentialReport|iam:ListAccessKeys&quot;)</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1580</id>
    </mitre>
  </rule>
  <rule id="100780" level="9">
    <description>Detects unauthorized modifications to security group rules, which might indicate an attempt to open unnecessary ports.</description>
    <match>.*(?:AuthorizeSecurityGroupIngress|AuthorizeSecurityGroupEgress).*</match>
    <group>Unauthorized Changes</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100781" level="8">
    <description>Identifies the creation of overly permissive security groups that allow inbound traffic from any IP address.</description>
    <match>.*CreateSecurityGroup.*(?:0.0.0.0/0|::/0).*</match>
    <group>Overly Permissive Access</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100782" level="7">
    <description>Monitors for the deletion of security group rules, potentially exposing resources to unauthorized access.</description>
    <match>.*(?:RevokeSecurityGroupIngress|RevokeSecurityGroupEgress).*</match>
    <group>Unauthorized Changes</group>
    <mitre>
      <id>T1562</id>
    </mitre>
  </rule>
  <rule id="100783" level="8">
    <description>Detects network configuration changes within VPC that might indicate an attempt to reroute traffic.</description>
    <match>.*(?:CreateRoute|ReplaceRoute|DeleteRoute).*</match>
    <group>Network Configuration Changes</group>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>
  <rule id="100784" level="6">
    <description>Identifies the creation or modification of VPC peering connections, which could be used to access restricted networks.</description>
    <match>.*(?:CreateVpcPeeringConnection|AcceptVpcPeeringConnection|DeleteVpcPeeringConnection).*</match>
    <group>VPC Peering Changes</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100785" level="5">
    <description>Detects unauthorized access to S3 buckets from unusual IP addresses.</description>
    <match>UnauthorizedAccess.*S3.*(IP|ip|address)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="100786" level="5">
    <description>Monitors for large data transfers from S3 buckets to unknown external destinations.</description>
    <match>LargeDataTransfer.*S3.*(external|unknown)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="100787" level="4">
    <description>Identifies S3 bucket policy changes that grant public read access.</description>
    <match>BucketPolicyChange.*S3.*(public|read|access)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1530</id>
    </mitre>
  </rule>
  <rule id="100788" level="4">
    <description>Detects unusual patterns of S3 object downloads that may indicate data scraping.</description>
    <match>UnusualDownloadPattern.*S3.*(scraping|bulk|download)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100789" level="3">
    <description>Flags S3 objects being downloaded by previously unauthorized users.</description>
    <match>UnauthorizedUser.*S3.*(download|object)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100790" level="5">
    <description>Detect unauthorized changes to security group rules allowing inbound traffic from any IP</description>
    <match>.*AuthorizeSecurityGroupIngress.*&quot;CidrIp&quot;:&quot;0.0.0.0/0&quot;.*</match>
    <group>UnauthorizedAccess</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100791" level="4">
    <description>Monitor for changes to VPC network ACLs that allow all traffic (inbound/outbound)</description>
    <match>.*CreateNetworkAclEntry.*&quot;CidrBlock&quot;:&quot;0.0.0.0/0&quot;.*&quot;RuleAction&quot;:&quot;allow&quot;.*</match>
    <group>NetworkMisconfiguration</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100792" level="4">
    <description>Detect modifications to security group rules allowing outbound traffic to any IP</description>
    <match>.*AuthorizeSecurityGroupEgress.*&quot;CidrIp&quot;:&quot;0.0.0.0/0&quot;.*</match>
    <group>DataExfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100793" level="5">
    <description>Identify deletion of VPC flow logs which can indicate an attempt to cover tracks</description>
    <match>.*DeleteFlowLogs.*</match>
    <group>LogTampering</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100794" level="3">
    <description>Detect changes to default security groups which should not normally happen</description>
    <match>.*ModifySecurityGroupRules.*&quot;GroupName&quot;:&quot;default&quot;.*</match>
    <group>Misconfiguration</group>
    <mitre>
      <id>T1531</id>
    </mitre>
  </rule>
  <rule id="100795" level="5">
    <description>Detects unauthorized start of EC2 instances by non-approved users</description>
    <match>StartInstances\s.*\s&quot;userIdentity&quot;:\s*\{&quot;arn&quot;:\s*&quot;arn:aws:iam::(?!123456789012).+?&quot;\}</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100796" level="5">
    <description>Detects unauthorized stop of EC2 instances by non-approved users</description>
    <match>StopInstances\s.*\s&quot;userIdentity&quot;:\s*\{&quot;arn&quot;:\s*&quot;arn:aws:iam::(?!123456789012).+?&quot;\}</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100797" level="4">
    <description>Detects multiple EC2 instance start/stop actions in a short period, indicating potential abuse</description>
    <match>(StartInstances|StopInstances)\s.*\s&quot;userIdentity&quot;:\s*\{&quot;arn&quot;:\s*&quot;arn:aws:iam::[^&quot;]+&quot;\}.+?((StartInstances|StopInstances)\s.*\s&quot;userIdentity&quot;:\s*\{&quot;arn&quot;:\s*&quot;arn:aws:iam::[^&quot;]+&quot;){2,}</match>
    <group>Abuse</group>
    <mitre>
      <id>T1088</id>
    </mitre>
  </rule>
  <rule id="100798" level="4">
    <description>Detects the use of an unauthorized script to start EC2 instances</description>
    <match>RunInstances\s.*\s&quot;userAgent&quot;:\s*&quot;.+?script.+?&quot;</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100799" level="4">
    <description>Detects suspicious start of EC2 instances from unusual IP addresses</description>
    <match>StartInstances\s.*\s&quot;sourceIPAddress&quot;:\s*&quot;(?!192\.168|10\.|172\.(1[6-9]|2[0-9]|3[0-1]))[^&quot;]+&quot;</match>
    <group>Suspicious Activity</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100800" level="10">
    <description>Detects IAM policy changes that grant admin privileges to a user.</description>
    <match>Action:\s*'iam:PutUserPolicy'|Action:\s*'iam:AttachUserPolicy'.*PolicyArn:\s*'.*AdministratorAccess'</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100801" level="9">
    <description>Alerts on creation of new IAM users with programmatic access.</description>
    <match>Action:\s*'iam:CreateUser'.*UserName:\s*'.*'.*CreateAccessKey</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100802" level="8">
    <description>Detects suspicious CloudTrail logs that indicate possible role assumption to gain elevated privileges.</description>
    <match>EventName:\s*'AssumeRole'.*RoleArn:\s*'arn:aws:iam::[0-9]+:role\/Admin'</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100803" level="7">
    <description>Detects API calls that create or update IAM policies with wildcard permissions.</description>
    <match>Action:\s*'iam:CreatePolicy'|Action:\s*'iam:PutRolePolicy'|Action:\s*'iam:PutUserPolicy'.*PolicyDocument.*&quot;Effect&quot;:&quot;Allow&quot;,&quot;Action&quot;:&quot;*&quot;,&quot;Resource&quot;:&quot;*&quot;</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100804" level="10">
    <description>Alerts on the use of root account for any activity.</description>
    <match>UserIdentity:{.*&quot;type&quot;:&quot;Root&quot;.*}</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100805" level="5">
    <description>Detects unauthorized EC2 instance start attempts by non-admin users</description>
    <match>UnauthorizedOperation: ec2:StartInstances</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100806" level="4">
    <description>Detects multiple EC2 instance stop attempts within a short time frame, indicating potential malicious activity</description>
    <match>StopInstances.{1,}StopInstances</match>
    <group>Denial of Service</group>
    <mitre>
      <id>T1489</id>
    </mitre>
  </rule>
  <rule id="100807" level="4">
    <description>Detects start of EC2 instances from unusual IP addresses not used previously</description>
    <match>StartInstances.{1,}sourceIPAddress.*(![previously_known_ips])</match>
    <group>Suspicious Behavior</group>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
  <rule id="100808" level="3">
    <description>Detects stop of high-value EC2 instances outside of business hours</description>
    <match>StopInstances.{1,}ResourceId=high_value_instances.*outside_business_hours</match>
    <group>Suspicious Behavior</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100809" level="5">
    <description>Detects attempts to start EC2 instances using compromised IAM credentials</description>
    <match>StartInstances.{1,}CompromisedCredentials</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100810" level="9">
    <description>Detects attempts to create a new IAM policy with admin privileges</description>
    <match>CreatePolicy.*&quot;PolicyDocument&quot;:.*&quot;Effect&quot;:\s*&quot;Allow&quot;.*&quot;Action&quot;:\s*&quot;\*&quot;.*&quot;Resource&quot;:\s*&quot;\*&quot;</match>
    <group>IAM Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100811" level="8">
    <description>Detects changes to existing IAM policies to add admin privileges</description>
    <match>PutPolicy.*&quot;PolicyDocument&quot;:.*&quot;Effect&quot;:\s*&quot;Allow&quot;.*&quot;Action&quot;:\s*&quot;\*&quot;.*&quot;Resource&quot;:\s*&quot;\*&quot;</match>
    <group>IAM Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100812" level="9">
    <description>Detects the attachment of policies granting full administrative privileges to a user or role</description>
    <match>AttachUserPolicy|AttachRolePolicy.*&quot;PolicyArn&quot;:.*&quot;arn:aws:iam::aws:policy/AdministratorAccess&quot;</match>
    <group>IAM Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100813" level="8">
    <description>Detects the creation of new IAM users with administrative privileges</description>
    <match>CreateUser.*&quot;UserName&quot;:.*&quot;.*&quot;.*&quot;AttachUserPolicy&quot;.*&quot;PolicyArn&quot;:.*&quot;arn:aws:iam::aws:policy/AdministratorAccess&quot;</match>
    <group>IAM Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100814" level="7">
    <description>Detects the use of AssumeRole to gain administrative privileges</description>
    <match>AssumeRole.*&quot;RoleArn&quot;:.*&quot;arn:aws:iam::.*:role/Admin&quot;</match>
    <group>IAM Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100815" level="5">
    <description>Detects high volume data transfer from an S3 bucket, indicating potential data exfiltration.</description>
    <match>s3:GetObject.*s3:ListBucket.*DurationSeconds=\d{4,}</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1537</id>
    </mitre>
  </rule>
  <rule id="100816" level="4">
    <description>Monitors for S3 bucket policies being altered to allow public access, which could be a precursor to data exfiltration.</description>
    <match>s3:PutBucketPolicy.*Allow.*s3:GetObject</match>
    <group>Policy Changes</group>
    <mitre>
      <id>T1529</id>
    </mitre>
  </rule>
  <rule id="100817" level="4">
    <description>Detects unusual S3 API calls from IP addresses not previously seen, suggesting potential unauthorized access.</description>
    <match>s3:GetObject.*s3:ListBucket.*SourceIpAddress=\d+\.\d+\.\d+\.\d+</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100818" level="5">
    <description>Identifies the use of IAM roles with excessive permissions accessing S3 buckets, which might be exploited for data exfiltration.</description>
    <match>s3:GetObject.*iam:AssumeRole.*Action=.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100819" level="5">
    <description>Flags API calls that result in large data downloads from an S3 bucket within a short time frame, indicating possible data theft.</description>
    <match>s3:GetObject.*Size=\d{7,}</match>
    <group>Data Theft</group>
    <mitre>
      <id>T1530</id>
    </mitre>
  </rule>
  <rule id="100820" level="9">
    <description>Detects API calls that disable logging on S3 buckets</description>
    <match>DisableLogging</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1537</id>
    </mitre>
  </rule>
  <rule id="100821" level="8">
    <description>Detects API calls that create EC2 instances with public IP</description>
    <match>RunInstances.*PublicIpAddress</match>
    <group>Resource Exposure</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100822" level="10">
    <description>Detects API calls that modify IAM policies to grant admin privileges</description>
    <match>PutPolicy.*AdministratorAccess</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100823" level="8">
    <description>Detects API calls that create or modify security groups to allow inbound traffic on port 22</description>
    <match>AuthorizeSecurityGroupIngress.*FromPort=22</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1133</id>
    </mitre>
  </rule>
  <rule id="100824" level="9">
    <description>Detects API calls that delete CloudTrail trails</description>
    <match>DeleteTrail</match>
    <group>Anti-Forensics</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100825" level="5">
    <description>Detects unauthorized access attempts to AWS management console</description>
    <match>UnauthorizedAccess:(.*?)(ManagementConsole)</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100826" level="4">
    <description>Detects suspicious API calls to create or delete IAM users</description>
    <match>CreateUser|DeleteUser</match>
    <group>IAM Anomalies</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100827" level="4">
    <description>Detects data exfiltration attempts via S3 bucket access</description>
    <match>GetObject|ListBucket</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1537</id>
    </mitre>
  </rule>
  <rule id="100828" level="3">
    <description>Detects suspicious changes to security groups</description>
    <match>AuthorizeSecurityGroupIngress|AuthorizeSecurityGroupEgress</match>
    <group>Network Security</group>
    <mitre>
      <id>T1133</id>
    </mitre>
  </rule>
  <rule id="100829" level="3">
    <description>Detects unusual API calls from new or unusual IP addresses</description>
    <match>SourceIPAddress:(.*?)(new|unusual)</match>
    <group>Anomalous API Calls</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100830" level="4">
    <description>Detect unauthorized changes to AWS security group rules</description>
    <match>eventName\&quot;:\&quot;AuthorizeSecurityGroupIngress\&quot;</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100831" level="4">
    <description>Detect unauthorized removal of AWS security group rules</description>
    <match>eventName\&quot;:\&quot;RevokeSecurityGroupIngress\&quot;</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100832" level="5">
    <description>Detect changes to network ACLs that allow wide open access</description>
    <match>eventName\&quot;:\&quot;CreateNetworkAclEntry\&quot;.*\&quot;CidrBlock\&quot;:\&quot;0.0.0.0/0\&quot;</match>
    <group>Network Misconfiguration</group>
    <mitre>
      <id>T1049</id>
    </mitre>
  </rule>
  <rule id="100833" level="5">
    <description>Detect changes to VPC route tables that route traffic to unknown IPs</description>
    <match>eventName\&quot;:\&quot;CreateRoute\&quot;.*\&quot;GatewayId\&quot;:\&quot;unknown\&quot;</match>
    <group>Network Misconfiguration</group>
    <mitre>
      <id>T1049</id>
    </mitre>
  </rule>
  <rule id="100834" level="5">
    <description>Detect changes to security group that allow unrestricted access</description>
    <match>eventName\&quot;:\&quot;AuthorizeSecurityGroupIngress\&quot;.*\&quot;CidrIp\&quot;:\&quot;0.0.0.0/0\&quot;</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100835" level="9">
    <description>Detects unauthorized start of EC2 instances by non-admin users</description>
    <match>UnauthorizedUser.*StartInstances</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100836" level="8">
    <description>Identifies multiple failed attempts to start EC2 instances indicating a brute force attack</description>
    <match>FailedStartAttempt.{3,}</match>
    <group>Brute Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100837" level="7">
    <description>Monitors for EC2 instance stop requests from unusual IP addresses</description>
    <match>StopInstancesRequest.*RemoteIP</match>
    <group>Suspicious Activity</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="100838" level="9">
    <description>Detects unauthorized stop of EC2 instances by non-admin users</description>
    <match>UnauthorizedUser.*StopInstances</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100839" level="10">
    <description>Identifies abnormal patterns in EC2 instance start/stop activities indicating potential malware</description>
    <match>AbnormalStartStopPattern</match>
    <group>Malware</group>
    <mitre>
      <id>T1218</id>
    </mitre>
  </rule>
  <rule id="100840" level="10">
    <description>Detects unauthorized use of the AWS Root account</description>
    <match>arn:aws:iam::\d{12}:root</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100841" level="9">
    <description>Detects creation of IAM users with administrative privileges</description>
    <match>iam::CreateUser.*AdministratorAccess</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100842" level="8">
    <description>Detects suspicious API calls to S3 buckets from unfamiliar IP addresses</description>
    <match>s3:GetObject.*SourceIp: \&quot;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\&quot;</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1537</id>
    </mitre>
  </rule>
  <rule id="100843" level="10">
    <description>Detects disabling of CloudTrail logging</description>
    <match>cloudtrail:StopLogging</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100844" level="7">
    <description>Detects unusual API calls that indicate potential account compromise</description>
    <match>ec2:AuthorizeSecurityGroupIngress.*IpProtocol: -1</match>
    <group>Account Compromise</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100845" level="5">
    <description>Detects unauthorized changes to security group rules, such as adding or removing ingress or egress rules.</description>
    <match>event.source: 'ec2.amazonaws.com' and event.name: ('AuthorizeSecurityGroupIngress' or 'AuthorizeSecurityGroupEgress' or 'RevokeSecurityGroupIngress' or 'RevokeSecurityGroupEgress') and not user.identity.arn: 'arn:aws:iam::*:role/authorized_role'</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="100846" level="4">
    <description>Identifies changes to the default security group which should rarely be modified.</description>
    <match>event.source: 'ec2.amazonaws.com' and event.name: ('AuthorizeSecurityGroupIngress' or 'AuthorizeSecurityGroupEgress' or 'RevokeSecurityGroupIngress' or 'RevokeSecurityGroupEgress') and requestParameters.groupId: 'sg-00000000'</match>
    <group>Misconfiguration</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="100847" level="4">
    <description>Monitors for changes to EC2 network ACLs, which can affect multiple instances.</description>
    <match>event.source: 'ec2.amazonaws.com' and event.name: ('CreateNetworkAcl' or 'CreateNetworkAclEntry' or 'DeleteNetworkAcl' or 'DeleteNetworkAclEntry')</match>
    <group>Network Anomaly</group>
    <mitre>
      <id>T1049</id>
    </mitre>
  </rule>
  <rule id="100848" level="5">
    <description>Detects changes to VPC settings, which can impact the entire network infrastructure.</description>
    <match>event.source: 'ec2.amazonaws.com' and event.name: ('ModifyVpcAttribute' or 'CreateVpc' or 'DeleteVpc')</match>
    <group>Network Configuration</group>
    <mitre>
      <id>T1075</id>
    </mitre>
  </rule>
  <rule id="100849" level="3">
    <description>Identifies the creation of new security groups in the AWS environment, which could be a sign of unauthorized access.</description>
    <match>event.source: 'ec2.amazonaws.com' and event.name: 'CreateSecurityGroup' and not user.identity.arn: 'arn:aws:iam::*:role/authorized_role'</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1069</id>
    </mitre>
  </rule>
  <rule id="100850" level="8">
    <description>Detects suspicious AWS Management Console login by an unusual user</description>
    <match>AWS\.ConsoleLogin.*\&quot;errorCode\&quot;:\&quot;InvalidSignatureException\&quot;</match>
    <group>AWS Console Login</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100851" level="7">
    <description>Detects creation of a new access key in AWS</description>
    <match>CreateAccessKey</match>
    <group>AWS IAM</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100852" level="9">
    <description>Detects AWS API calls from unusual geolocation</description>
    <match>aws\.cloudtrail.*\&quot;sourceIPAddress\&quot;:\&quot;.*\&quot;.*\&quot;userAgent\&quot;:\&quot;.*\&quot;</match>
    <group>AWS Geolocation</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100853" level="10">
    <description>Detects disabling of CloudTrail logging in AWS</description>
    <match>StopLogging</match>
    <group>AWS CloudTrail</group>
    <mitre>
      <id>T1531</id>
    </mitre>
  </rule>
  <rule id="100854" level="8">
    <description>Detects changes to Network Access Control Lists (NACL) in AWS</description>
    <match>CreateNetworkAcl|ReplaceNetworkAclEntry|DeleteNetworkAcl</match>
    <group>AWS Network</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="100855" level="9">
    <description>Detects unauthorized start of EC2 instances by non-privileged users</description>
    <match>UnauthorizedStartInstances</match>
    <group>EC2 Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100856" level="8">
    <description>Detects multiple start/stop operations on EC2 instances in a short time window indicating possible brute force attack</description>
    <match>MultipleStartStopInstances</match>
    <group>EC2 Brute Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100857" level="7">
    <description>Detects stop operations on critical EC2 instances during non-business hours</description>
    <match>StopCriticalInstancesNonBusinessHours</match>
    <group>EC2 Anomaly Detection</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100858" level="8">
    <description>Detects start/stop operations from unusual IP addresses indicating potential compromised account</description>
    <match>StartStopInstancesUnusualIP</match>
    <group>EC2 Compromised Account</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="100859" level="6">
    <description>Detects start operations on EC2 instances with unusual instance types indicating possible misuse of resources</description>
    <match>StartInstancesUnusualInstanceType</match>
    <group>EC2 Resource Misuse</group>
    <mitre>
      <id>T1430</id>
    </mitre>
  </rule>
  <rule id="100860" level="9">
    <description>Detects unauthorized addition of inbound rules allowing traffic from 0.0.0.0/0 to port 22 (SSH).</description>
    <match>.*AuthorizeSecurityGroupIngress.*0.0.0.0/0.*22.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100861" level="8">
    <description>Detects unauthorized modification of security group rules to permit all inbound traffic.</description>
    <match>.*UpdateSecurityGroupRuleDescriptions.*0.0.0.0/0.*</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100862" level="7">
    <description>Detects unauthorized deletion of specific security group rules restricting inbound traffic.</description>
    <match>.*RevokeSecurityGroupIngress.*</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1531</id>
    </mitre>
  </rule>
  <rule id="100863" level="8">
    <description>Detects suspicious changes to VPC network ACLs allowing unrestricted inbound traffic.</description>
    <match>.*CreateNetworkAclEntry.*0.0.0.0/0.*</match>
    <group>Network Anomaly</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100864" level="9">
    <description>Detects unauthorized changes to routing tables that could redirect traffic.</description>
    <match>.*ReplaceRoute.*</match>
    <group>Network Anomaly</group>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>
  <rule id="100865" level="5">
    <description>Detects unauthorized access attempts to AWS Management Console</description>
    <match>Failed authentication attempt for user .* in AWS console</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100866" level="4">
    <description>Identifies creation of IAM users with administrative privileges</description>
    <match>CreateUser.* with Admin privileges</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="100867" level="5">
    <description>Detects deletion of CloudTrail logs</description>
    <match>DeleteTrail.*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1070.004</id>
    </mitre>
  </rule>
  <rule id="100868" level="3">
    <description>Monitors for unusual activity in S3 buckets (e.g., mass downloads)</description>
    <match>GetObject.* from suspicious IP</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1537</id>
    </mitre>
  </rule>
  <rule id="100869" level="4">
    <description>Detects disabling of CloudWatch alarms</description>
    <match>DisableAlarmActions.*</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="100870" level="9">
    <description>Detects unusual communication between pods that don't normally interact, indicating a potential lateral movement attack.</description>
    <match>PodA.*PodB|PodB.*PodA</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>
  <rule id="100871" level="8">
    <description>Identifies high volume of traffic between pods, which could indicate data exfiltration.</description>
    <match>Pod[A-Z].*Pod[A-Z].*HighVolume</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100872" level="7">
    <description>Monitors for unusual port scanning activity between pods, which could be a precursor to an attack.</description>
    <match>Pod[A-Z].*PortScan.*Pod[A-Z]</match>
    <group>Reconnaissance</group>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
  <rule id="100873" level="9">
    <description>Detects unauthorized access attempts between pods, potentially indicating credential theft.</description>
    <match>Pod[A-Z].*UnauthorizedAccess.*Pod[A-Z]</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100874" level="6">
    <description>Identifies anomalous traffic patterns that deviate from the established baseline, signaling a potential attack.</description>
    <match>Pod[A-Z].*AnomalousTraffic.*Pod[A-Z]</match>
    <group>Anomaly Detection</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="100875" level="9">
    <description>Detects attempts to create privileged containers which can lead to privilege escalation.</description>
    <match>kubectl\s+(run|create)\s+.*--privileged</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100876" level="10">
    <description>Monitors for the addition of cluster-admin role to any user or service account.</description>
    <match>kubectl\s+(create|edit|patch)\s+rolebinding.*\s+cluster-admin</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100877" level="8">
    <description>Detects suspicious use of kubectl exec into a privileged pod.</description>
    <match>kubectl\s+exec\s+.*--privileged</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1059.004</id>
    </mitre>
  </rule>
  <rule id="100878" level="9">
    <description>Alerts on attempts to modify Kubernetes Role or ClusterRole with escalated privileges.</description>
    <match>kubectl\s+(edit|patch)\s+(role|clusterrole)\s+.*\s+--allow\s+.*all</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="100879" level="7">
    <description>Detects changes to Kubernetes network policies that allow unrestricted access.</description>
    <match>kubectl\s+(apply|create|edit|patch)\s+-f\s+.*networkpolicy.*\s+--allow\s+.*all</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100880" level="9">
    <description>Detect unauthorized modifications to Kubernetes RoleBindings and ClusterRoleBindings.</description>
    <match>.*&quot;kind&quot;:\s*&quot;(RoleBinding|ClusterRoleBinding)&quot;.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100881" level="8">
    <description>Detect creation or modification of Kubernetes ServiceAccounts in default namespaces.</description>
    <match>.*&quot;kind&quot;:\s*&quot;ServiceAccount&quot;.*&quot;namespace&quot;:\s*&quot;default&quot;.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100882" level="8">
    <description>Detect changes to Kubernetes NetworkPolicies that allow traffic from any source.</description>
    <match>.*&quot;kind&quot;:\s*&quot;NetworkPolicy&quot;.*&quot;from&quot;:\s*\[.*&quot;ipBlock&quot;:\s*{.*&quot;cidr&quot;:\s*&quot;0.0.0.0/0&quot;.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100883" level="7">
    <description>Detect creation or modification of Kubernetes ConfigMaps with sensitive data.</description>
    <match>.*&quot;kind&quot;:\s*&quot;ConfigMap&quot;.*&quot;data&quot;:\s*{.*(&quot;password&quot;|&quot;secret&quot;|&quot;token&quot;).*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1562</id>
    </mitre>
  </rule>
  <rule id="100884" level="9">
    <description>Detect unauthorized changes to Kubernetes API server configurations.</description>
    <match>.*&quot;kind&quot;:\s*&quot;Config&quot;.*&quot;apiServer&quot;:.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100885" level="5">
    <description>Detect unauthorized modifications to Kubernetes Secrets</description>
    <match>.*kubectl.*apply.*secret.*</match>
    <group>Kubernetes Configuration</group>
    <mitre>
      <id>T1552</id>
    </mitre>
  </rule>
  <rule id="100886" level="4">
    <description>Detect unauthorized changes to Kubernetes ConfigMaps</description>
    <match>.*kubectl.*apply.*configmap.*</match>
    <group>Kubernetes Configuration</group>
    <mitre>
      <id>T1222</id>
    </mitre>
  </rule>
  <rule id="100887" level="4">
    <description>Detect unauthorized modifications to Kubernetes Network Policies</description>
    <match>.*kubectl.*apply.*networkpolicy.*</match>
    <group>Kubernetes Configuration</group>
    <mitre>
      <id>T1489</id>
    </mitre>
  </rule>
  <rule id="100888" level="5">
    <description>Detect unauthorized changes to Kubernetes RoleBindings</description>
    <match>.*kubectl.*apply.*rolebinding.*</match>
    <group>Kubernetes Configuration</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100889" level="3">
    <description>Detect unauthorized modifications to Kubernetes PersistentVolumeClaims</description>
    <match>.*kubectl.*apply.*persistentvolumeclaim.*</match>
    <group>Kubernetes Configuration</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100890" level="5">
    <description>Detects deployment of a privileged container which could indicate an attempt to gain elevated privileges</description>
    <match>.*&quot;securityContext&quot;:\s*{[^}]*&quot;privileged&quot;:\s*true[^}]*}.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100891" level="4">
    <description>Detects the creation of a container with hostPath volume pointing to sensitive directories</description>
    <match>.*&quot;volumes&quot;:\s*\[.*&quot;hostPath&quot;:\s*{[^}]*&quot;path&quot;:\s*&quot;/(etc|root|var)&quot;[^}]*}.*\].*</match>
    <group>Data Exposure</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100892" level="3">
    <description>Detects use of deprecated Kubernetes API versions which might be vulnerable</description>
    <match>.*&quot;apiVersion&quot;:\s*&quot;v1beta1&quot;.*</match>
    <group>Vulnerability Exploitation</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="100893" level="4">
    <description>Detects creation of containers with excessive resource requests which could lead to denial of service</description>
    <match>.*&quot;resources&quot;:\s*{[^}]*&quot;requests&quot;:\s*{[^}]*&quot;cpu&quot;:\s*&quot;[4-9]000m&quot;[^}]*}.*</match>
    <group>Denial of Service</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100894" level="5">
    <description>Detects container deployments using suspicious images from untrusted registries</description>
    <match>.*&quot;image&quot;:\s*&quot;.*(docker\.io|quay\.io|gcr\.io)/[^/]+/[^:]+:.*&quot;.*</match>
    <group>Supply Chain</group>
    <mitre>
      <id>T1189</id>
    </mitre>
  </rule>
  <rule id="100895" level="5">
    <description>Detect unauthorized access attempts to the Kubernetes API server.</description>
    <match>Unauthorized\saccess\sattempt</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100896" level="4">
    <description>Monitor for suspicious use of kubectl exec command to gain shell access.</description>
    <match>kubectl\sexec\s-i</match>
    <group>Suspicious Activity</group>
    <mitre>
      <id>T1059.004</id>
    </mitre>
  </rule>
  <rule id="100897" level="5">
    <description>Detect abnormal creation of ClusterRoleBinding which may indicate privilege escalation.</description>
    <match>create\sClusterRoleBinding</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="100898" level="4">
    <description>Monitor for changes to Kubernetes network policies which could indicate lateral movement attempts.</description>
    <match>apply\s-f\snetworkpolicy</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1021.001</id>
    </mitre>
  </rule>
  <rule id="100899" level="3">
    <description>Detect suspicious use of kubectl port-forward which may indicate data exfiltration.</description>
    <match>kubectl\sport-forward</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048.003</id>
    </mitre>
  </rule>
  <rule id="100900" level="9">
    <description>Detects deployments of containers with privileged access, which can be exploited for full host control.</description>
    <match>securityContext:\s*\{[^\}]*privileged:\s*true</match>
    <group>Privileged Access</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100901" level="8">
    <description>Detects the use of containers with capabilities that can be abused for unauthorized actions, such as CAP_SYS_ADMIN.</description>
    <match>capabilities:\s*\{[^\}]*add:\s*\[.*CAP_SYS_ADMIN.*\]</match>
    <group>Capability Abuse</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100902" level="7">
    <description>Detects deployments of containers pulling images from untrusted or unauthorized registries, which can introduce malicious code.</description>
    <match>image:\s*&quot;[^\s]*\/(?!trusted-registry)[^\s]*&quot;</match>
    <group>Untrusted Image Source</group>
    <mitre>
      <id>T1587</id>
    </mitre>
  </rule>
  <rule id="100903" level="8">
    <description>Detects containers that run with root user, which can lead to privilege escalation if compromised.</description>
    <match>securityContext:\s*\{[^\}]*runAsUser:\s*0</match>
    <group>Root User</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100904" level="6">
    <description>Detects the creation of overly permissive network policies, which can expose the cluster to network-based attacks.</description>
    <match>networkPolicy:\s*\{[^\}]*egress:\s*\[\{[^\}]*to:\s*\[\{[^\}]*ipBlock:\s*\{[^\}]*cidr:\s*&quot;0\.0\.0\.0\/0&quot;</match>
    <group>Network Policy Misconfiguration</group>
    <mitre>
      <id>T1075</id>
    </mitre>
  </rule>
  <rule id="100905" level="5">
    <description>Detects attempts to create a privileged container</description>
    <match>spec\s*:\s*containers\s*:\s*\[\s*.*\s*securityContext\s*:\s*\{\s*.*\s*privileged\s*:\s*true</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100906" level="5">
    <description>Detects attempts to escalate to root user within a container</description>
    <match>spec\s*:\s*containers\s*:\s*\[\s*.*\s*securityContext\s*:\s*\{\s*.*\s*runAsUser\s*:\s*0</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100907" level="4">
    <description>Detects suspicious use of hostPath volumes which may indicate an attempt to access host filesystem</description>
    <match>spec\s*:\s*volumes\s*:\s*\[\s*.*\s*hostPath\s*:</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1109</id>
    </mitre>
  </rule>
  <rule id="100908" level="5">
    <description>Detects attempts to modify Kubernetes RBAC (Role-Based Access Control) rules</description>
    <match>kind\s*:\s*Role\s*|\s*ClusterRole\s*|\s*RoleBinding\s*|\s*ClusterRoleBinding</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100909" level="4">
    <description>Detects the use of capabilities that can be used for privilege escalation</description>
    <match>spec\s*:\s*containers\s*:\s*\[\s*.*\s*securityContext\s*:\s*\{\s*.*\s*capabilities\s*:\s*\{\s*.*\s*add\s*:\s*\[\s*.*\s*(NET_ADMIN|SYS_ADMIN)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100910" level="10">
    <description>Detects deployment of privileged containers, which can lead to container escape and host compromise</description>
    <match>spec.containers.*.securityContext.privileged: true</match>
    <group>Privileged Container</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="100911" level="9">
    <description>Detects containers running with root user, which can lead to unauthorized access and privilege escalation</description>
    <match>spec.containers.*.securityContext.runAsUser: 0</match>
    <group>Root Container</group>
    <mitre>
      <id>T1609</id>
    </mitre>
  </rule>
  <rule id="100912" level="8">
    <description>Detects the use of sensitive volumes like hostPath in container deployments, which can expose host system files</description>
    <match>spec.volumes.*.hostPath</match>
    <group>HostPath Volume</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="100913" level="8">
    <description>Detects the deployment of containers with dangerous capabilities like SYS_ADMIN, which can lead to container escape</description>
    <match>spec.containers.*.securityContext.capabilities.add: SYS_ADMIN</match>
    <group>Dangerous Capabilities</group>
    <mitre>
      <id>T1612</id>
    </mitre>
  </rule>
  <rule id="100914" level="7">
    <description>Detects the use of default Kubernetes namespace in deployments, which can lead to namespace confusion and security issues</description>
    <match>metadata.namespace: default</match>
    <group>Default Namespace</group>
    <mitre>
      <id>T1613</id>
    </mitre>
  </rule>
  <rule id="100915" level="9">
    <description>Detect unauthorized access attempts using high-privilege service accounts</description>
    <match>Unauthorized access attempt detected for service account .*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100916" level="8">
    <description>Monitor creation of privileged containers</description>
    <match>Creating privileged container .*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100917" level="7">
    <description>Suspicious kubelet API access from external IPs</description>
    <match>External IP .* accessing kubelet API</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1091</id>
    </mitre>
  </rule>
  <rule id="100918" level="6">
    <description>Detect modification of Kubernetes ConfigMaps</description>
    <match>ConfigMap .* modified by .*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1484</id>
    </mitre>
  </rule>
  <rule id="100919" level="5">
    <description>Identify usage of default service account in critical namespaces</description>
    <match>Default service account used in namespace .*</match>
    <group>Misconfiguration</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100920" level="5">
    <description>Detects port scanning activities between Kubernetes pods.</description>
    <match>(?:Nmap|Zmap|Masscan) detected between pods</match>
    <group>Network</group>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
  <rule id="100921" level="5">
    <description>Detects unusual large data transfer between Kubernetes pods indicating potential data exfiltration.</description>
    <match>Large data transfer between pods detected</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="100922" level="4">
    <description>Detects suspicious DNS queries within Kubernetes pods that may indicate command and control communication.</description>
    <match>Suspicious DNS queries within pods</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100923" level="4">
    <description>Detects anomalous lateral movement attempts between Kubernetes pods.</description>
    <match>Lateral movement attempt between pods</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1072</id>
    </mitre>
  </rule>
  <rule id="100924" level="3">
    <description>Detects unauthorized network access attempts between Kubernetes pods.</description>
    <match>Unauthorized network access attempt between pods</match>
    <group>Access</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="100925" level="5">
    <description>Detects attempts to escalate privileges using Kubernetes API server exec commands</description>
    <match>kubectl exec.*--privileged</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100926" level="4">
    <description>Detects creation of privileged containers in Kubernetes</description>
    <match>spec.containers.*.securityContext.privileged: true</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100927" level="4">
    <description>Detects attempts to modify Kubernetes RoleBindings to escalate privileges</description>
    <match>kubectl create rolebinding.*--clusterrole=cluster-admin</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100928" level="3">
    <description>Detects suspicious use of hostPath volumes in Kubernetes, which can be used for privilege escalation</description>
    <match>spec.volumes.*.hostPath.path: /</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100929" level="3">
    <description>Detects the addition of Kubernetes service account tokens into pods, which can be used to escalate privileges</description>
    <match>spec.serviceAccountName:.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100930" level="5">
    <description>Detects attempts to access Kubernetes API server without proper authentication</description>
    <match>Unauthorized access to the Kubernetes API server detected</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100931" level="4">
    <description>Detects known malicious IP addresses attempting to connect to Kubernetes nodes</description>
    <match>Connection attempt from known malicious IP</match>
    <group>Network Intrusion</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100932" level="4">
    <description>Detects excessive failed login attempts to Kubernetes dashboard</description>
    <match>Multiple failed login attempts to Kubernetes dashboard</match>
    <group>Brute Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="100933" level="4">
    <description>Detects suspicious container creation with elevated privileges</description>
    <match>Container created with elevated privileges</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100934" level="3">
    <description>Detects changes to Kubernetes network policies indicating potential lateral movement</description>
    <match>Suspicious changes to Kubernetes network policies</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>
  <rule id="100935" level="10">
    <description>Detects unauthorized attempts to access the Kubernetes API server</description>
    <match>(?i)Unauthorized access attempt.*api-server</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100936" level="9">
    <description>Identifies suspicious kubelet API interactions indicating potential privilege escalation</description>
    <match>(?i)suspicious.*kubelet.*api</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100937" level="8">
    <description>Monitors for potential container breakout attempts from within the cluster</description>
    <match>(?i)container breakout.*attempt</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="100938" level="7">
    <description>Detects abnormal high-volume traffic to the Kubernetes API server indicating potential DDoS attack</description>
    <match>(?i)high-volume traffic.*api-server</match>
    <group>Denial of Service</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100939" level="6">
    <description>Captures unauthorized creation of high-privilege roles in the cluster</description>
    <match>(?i)unauthorized.*creation.*high-privilege roles</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100940" level="5">
    <description>Detect unusual network activity indicating possible lateral movement between Kubernetes pods.</description>
    <match>.*(kube-system|default)-[a-z0-9]+.*</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1570</id>
    </mitre>
  </rule>
  <rule id="100941" level="4">
    <description>Monitor unexpected ingress traffic to sensitive Kubernetes namespaces.</description>
    <match>.*(monitoring|logging)-[a-z0-9]+.*</match>
    <group>Ingress Traffic</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100942" level="4">
    <description>Detect unusual outbound network activity from Kubernetes pods to external IPs.</description>
    <match>.*(pod-[a-z0-9]+).*external-ip.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100943" level="5">
    <description>Identify network connections from Kubernetes pods to known malicious IP addresses.</description>
    <match>.*(pod-[a-z0-9]+).*malicious-ip.*</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1105</id>
    </mitre>
  </rule>
  <rule id="100944" level="3">
    <description>Monitor for high volume of network traffic between Kubernetes pods indicating potential DDoS attack.</description>
    <match>.*(pod-[a-z0-9]+).*high-traffic.*</match>
    <group>Denial of Service</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="100945" level="5">
    <description>Detects the deployment of containers with privileged access</description>
    <match>.*privileged:\s*true.*</match>
    <group>Privileged Access</group>
    <mitre>
      <id>T1201</id>
    </mitre>
  </rule>
  <rule id="100946" level="4">
    <description>Detects containers running with host network access</description>
    <match>.*hostNetwork:\s*true.*</match>
    <group>Network Access</group>
    <mitre>
      <id>T1030</id>
    </mitre>
  </rule>
  <rule id="100947" level="5">
    <description>Detects containers mounting host directory</description>
    <match>.*hostPath:\s*\{.*</match>
    <group>Host Directory Mount</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100948" level="4">
    <description>Detects containers with capabilities escalation</description>
    <match>.*capabilities:\s*\{.*</match>
    <group>Capability Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100949" level="3">
    <description>Detects containers running as root user</description>
    <match>.*runAsUser:\s*0.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1050</id>
    </mitre>
  </rule>
  <rule id="100950" level="5">
    <description>Detects attempts to create privileged containers.</description>
    <match>.*spec.containers.*securityContext.*privileged: true.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100951" level="5">
    <description>Detects modifications to Kubernetes ClusterRoleBindings that grant cluster-admin permissions.</description>
    <match>.*ClusterRoleBinding.*roleRef.*name: cluster-admin.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100952" level="4">
    <description>Detects attempts to run containers with capabilities that could lead to privilege escalation.</description>
    <match>.*spec.containers.*securityContext.*capabilities.*add:.*(ALL|NET_ADMIN|SYS_ADMIN).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100953" level="4">
    <description>Detects the creation of ServiceAccounts with excessive permissions.</description>
    <match>.*ServiceAccount.*secrets.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100954" level="3">
    <description>Detects the use of hostPath volumes which could allow access to the host filesystem.</description>
    <match>.*volumes.*hostPath.*path:.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1069</id>
    </mitre>
  </rule>
  <rule id="100955" level="5">
    <description>Detect unauthorized changes to Kubernetes RoleBindings</description>
    <match>.*&quot;verb&quot;:\s*&quot;update&quot;.*&quot;resource&quot;:\s*&quot;rolebindings&quot;.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100956" level="4">
    <description>Detect creation of high-privilege ServiceAccounts</description>
    <match>.*&quot;kind&quot;:\s*&quot;ServiceAccount&quot;.*&quot;automountServiceAccountToken&quot;:\s*true.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.004</id>
    </mitre>
  </rule>
  <rule id="100957" level="4">
    <description>Detect modifications to Kubernetes NetworkPolicies</description>
    <match>.*&quot;verb&quot;:\s*&quot;update&quot;.*&quot;resource&quot;:\s*&quot;networkpolicies&quot;.*</match>
    <group>Network Manipulation</group>
    <mitre>
      <id>T1489</id>
    </mitre>
  </rule>
  <rule id="100958" level="5">
    <description>Detect deletion of Kubernetes Namespaces</description>
    <match>.*&quot;verb&quot;:\s*&quot;delete&quot;.*&quot;resource&quot;:\s*&quot;namespaces&quot;.*</match>
    <group>Denial of Service</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="100959" level="3">
    <description>Detect unauthorized changes to Kubernetes ConfigMaps</description>
    <match>.*&quot;verb&quot;:\s*&quot;update&quot;.*&quot;resource&quot;:\s*&quot;configmaps&quot;.*</match>
    <group>Configuration Manipulation</group>
    <mitre>
      <id>T1592</id>
    </mitre>
  </rule>
  <rule id="100960" level="5">
    <description>Detects network connections to known malicious IP addresses by Kubernetes pods.</description>
    <match>.*(10\.0\.0\.1|192\.168\.1\.1).*</match>
    <group>Network Anomalies</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100961" level="4">
    <description>Unusual network communication patterns between Kubernetes pods indicating potential lateral movement.</description>
    <match>.*pod-to-pod-communication.*</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>
  <rule id="100962" level="5">
    <description>High volume of outgoing traffic from a single Kubernetes pod suggesting data exfiltration.</description>
    <match>.*excessive-outgoing-traffic.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="100963" level="4">
    <description>Suspicious DNS queries by Kubernetes pods that could indicate command and control activities.</description>
    <match>.*suspicious-dns-query.*</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100964" level="3">
    <description>Network connections from Kubernetes pods to external IP addresses that are not part of the allowed list.</description>
    <match>.*unexpected-external-connection.*</match>
    <group>Network Anomalies</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100965" level="4">
    <description>Detects attempts to create privileged pods</description>
    <match>spec\.containers\[\d+\]\.securityContext\.privileged:\s*true</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100966" level="4">
    <description>Detects modifications to Kubernetes cluster roles with cluster-admin privileges</description>
    <match>subjects:\[\{.*&quot;kind&quot;:&quot;User&quot;.*&quot;name&quot;:&quot;cluster-admin&quot;.*\}\]</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100967" level="3">
    <description>Detects suspicious use of hostPath volume mounts</description>
    <match>spec\.volumes\[\d+\]\.hostPath:\s*\{.*\}</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="100968" level="4">
    <description>Detects attempts to escalate privileges by modifying service account tokens</description>
    <match>spec\.automountServiceAccountToken:\s*true</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1528</id>
    </mitre>
  </rule>
  <rule id="100969" level="3">
    <description>Detects suspicious use of kubectl exec to run commands in a container</description>
    <match>kubectl exec .*-i .* -- .*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="100970" level="9">
    <description>Detect unauthorized access attempts to the Kubernetes API server</description>
    <match>Unauthorized access attempt to API server</match>
    <group>UnauthorizedAccess</group>
    <mitre>
      <id>T1003</id>
    </mitre>
  </rule>
  <rule id="100971" level="8">
    <description>Monitor for escalations to cluster-admin role in Kubernetes</description>
    <match>Role escalation to cluster-admin</match>
    <group>PrivilegeEscalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100972" level="7">
    <description>Detect creation of privileged containers in Kubernetes</description>
    <match>Privileged container creation</match>
    <group>PrivilegeEscalation</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100973" level="6">
    <description>Monitor for suspicious kubectl commands executed within the cluster</description>
    <match>Suspicious kubectl command execution</match>
    <group>SuspiciousActivity</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100974" level="9">
    <description>Detect unauthorized access to Kubernetes secrets</description>
    <match>Unauthorized access to secrets</match>
    <group>CredentialAccess</group>
    <mitre>
      <id>T1552</id>
    </mitre>
  </rule>
  <rule id="100975" level="9">
    <description>Detect creation of a new ClusterRole with escalated privileges</description>
    <match>kind: ClusterRole.*rules:.*apiGroups:.*resources:.*verbs:.*\b(create|delete|update|patch|bind|impersonate)\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100976" level="8">
    <description>Detect exec command in a pod to gain unauthorized access</description>
    <match>exec.*namespace=.*pod=.*container=.*command=.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100977" level="7">
    <description>Detect modification of a RoleBinding to escalate privileges</description>
    <match>kind: RoleBinding.*subjects:.*roleRef:.*ClusterRole</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="100978" level="6">
    <description>Detect service account token creation in a non-system namespace</description>
    <match>kind: ServiceAccount.*secrets:.*name:.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1528</id>
    </mitre>
  </rule>
  <rule id="100979" level="5">
    <description>Detect use of kubectl port-forward to access internal services</description>
    <match>kubectl.*port-forward.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100980" level="5">
    <description>Detect unauthorized modifications to Kubernetes API server configurations.</description>
    <match>.*kube-apiserver.*--insecure-port.*</match>
    <group>Configuration Modification</group>
    <mitre>
      <id>T1003</id>
    </mitre>
  </rule>
  <rule id="100981" level="4">
    <description>Detect changes to Kubernetes RBAC roles that grant excessive permissions.</description>
    <match>.*kind: Role.*rules:.*apiGroups:.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="100982" level="5">
    <description>Detect unauthorized modifications to etcd configurations.</description>
    <match>.*--etcd-servers.*</match>
    <group>Configuration Modification</group>
    <mitre>
      <id>T1003</id>
    </mitre>
  </rule>
  <rule id="100983" level="3">
    <description>Detect changes to Kubernetes network policies that allow unrestricted access.</description>
    <match>.*kind: NetworkPolicy.*spec:.*ingress:.*</match>
    <group>Network Policy Violation</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="100984" level="4">
    <description>Detect unauthorized modifications to Kubernetes audit log configurations.</description>
    <match>.*--audit-log-path.*</match>
    <group>Logging Alteration</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="100985" level="10">
    <description>Detects privilege escalation attempts within Docker containers</description>
    <match>exec.*--privileged</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100986" level="9">
    <description>Detects unauthorized access to Docker socket</description>
    <match>(/var/run/docker.sock|docker\.sock)</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="100987" level="8">
    <description>Detects suspicious container image pulls from untrusted registries</description>
    <match>docker pull (.*\.example\.com|.*\.untrusted\.com)</match>
    <group>Supply Chain Compromise</group>
    <mitre>
      <id>T1195.001</id>
    </mitre>
  </rule>
  <rule id="100988" level="7">
    <description>Detects root access within Docker containers</description>
    <match>exec.*-u root</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100989" level="6">
    <description>Detects attempts to modify Docker daemon configurations</description>
    <match>systemctl.*docker|dockerd.*--config-file</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1496</id>
    </mitre>
  </rule>
  <rule id="100990" level="5">
    <description>Detects unauthorized container starts by a non-root user.</description>
    <match>docker run[^\n]*--user[^\n]*(^|\s)[^0]</match>
    <group>unauthorized-access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="100991" level="4">
    <description>Alerts on suspicious container image downloads from untrusted registries.</description>
    <match>docker pull[^\n]*[^\s]+[:\/](example|untrusted)[^\n]*</match>
    <group>suspicious-download</group>
    <mitre>
      <id>T1195.001</id>
    </mitre>
  </rule>
  <rule id="100992" level="5">
    <description>Detects the use of sensitive or dangerous capabilities in Docker containers.</description>
    <match>docker run[^\n]*--cap-add[^\n]*(SYS_ADMIN|NET_ADMIN|SYS_PTRACE)</match>
    <group>privilege-escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100993" level="5">
    <description>Flags attempts to start Docker containers with privileged mode.</description>
    <match>docker run[^\n]*--privileged</match>
    <group>privilege-escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100994" level="4">
    <description>Detects Docker container starts with suspicious environment variables indicating potential credential theft.</description>
    <match>docker run[^\n]*-e[^\n]*(AWS_ACCESS_KEY_ID|AWS_SECRET_ACCESS_KEY|GCP_PROJECT_ID)</match>
    <group>credential-access</group>
    <mitre>
      <id>T1552</id>
    </mitre>
  </rule>
  <rule id="100995" level="5">
    <description>Detect unauthorized container image downloads from untrusted registries</description>
    <match>docker pull (?!trusted.registry.com)</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1525</id>
    </mitre>
  </rule>
  <rule id="100996" level="4">
    <description>Detect suspicious container starts from non-whitelisted images</description>
    <match>docker run (?!whitelisted.image)</match>
    <group>Execution</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="100997" level="4">
    <description>Detect high-frequency container image downloads indicating possible automated attack</description>
    <match>docker pull .*</match>
    <group>Anomalous Behavior</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="100998" level="5">
    <description>Detect containers running with high privileges</description>
    <match>docker run .*--privileged</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="100999" level="3">
    <description>Detect usage of deprecated Docker APIs indicating possible exploitation attempts</description>
    <match>docker (cp|export|import)</match>
    <group>Exploitation</group>
    <mitre>
      <id>T1210</id>
    </mitre>
  </rule>
  <rule id="101000" level="5">
    <description>Detection of attempts to break out of a Docker container using the host file system</description>
    <match>.*(\/host\/proc\/|\/host\/sys\/|\/host\/dev\/).*</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="101001" level="4">
    <description>Detection of suspicious docker exec commands indicating potential privilege escalation</description>
    <match>.*docker exec.*--privileged.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1609</id>
    </mitre>
  </rule>
  <rule id="101002" level="3">
    <description>Detection of unauthorized modifications to Docker container runtime configurations</description>
    <match>.*docker (update|start|run).*--runtime.*</match>
    <group>Configuration Manipulation</group>
    <mitre>
      <id>T1602</id>
    </mitre>
  </rule>
  <rule id="101003" level="2">
    <description>Detection of abnormal high-frequency container restarts</description>
    <match>.*docker (restart|stop|start).*</match>
    <group>Denial of Service</group>
    <mitre>
      <id>T1603</id>
    </mitre>
  </rule>
  <rule id="101004" level="3">
    <description>Detection of attempts to access sensitive files within a Docker container</description>
    <match>.*(\/etc\/shadow|\/etc\/passwd|\/root\/).*</match>
    <group>Data Theft</group>
    <mitre>
      <id>T1601</id>
    </mitre>
  </rule>
  <rule id="101005" level="10">
    <description>Detect unauthorized addition of privileged capabilities to a Docker container</description>
    <match>docker exec .* --cap-add .*</match>
    <group>docker, privilege_escalation</group>
    <mitre>
      <id>T1592</id>
    </mitre>
  </rule>
  <rule id="101006" level="8">
    <description>Detect changes to Docker container runtime settings that could indicate resource abuse</description>
    <match>docker update .* --cpus|--memory|--cpu-shares .*</match>
    <group>docker, resource_abuse</group>
    <mitre>
      <id>T1496</id>
    </mitre>
  </rule>
  <rule id="101007" level="9">
    <description>Detect attempts to bypass Docker security options by modifying seccomp profiles</description>
    <match>docker run .* --security-opt seccomp=.*</match>
    <group>docker, security_bypass</group>
    <mitre>
      <id>T1562</id>
    </mitre>
  </rule>
  <rule id="101008" level="7">
    <description>Detect creation of Docker containers with exposed host directories</description>
    <match>docker run .* -v /:/host .*</match>
    <group>docker, data_exfiltration</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="101009" level="6">
    <description>Detect unauthorized stopping or starting of Docker containers</description>
    <match>docker (stop|start) .*</match>
    <group>docker, operational_disruption</group>
    <mitre>
      <id>T1489</id>
    </mitre>
  </rule>
  <rule id="101010" level="5">
    <description>Detects attempts to exploit Docker container escape via mounting the host filesystem</description>
    <match>mount.*--bind.*/host</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="101011" level="5">
    <description>Detects the usage of privileged containers which can lead to container escape</description>
    <match>docker run.*--privileged</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="101012" level="4">
    <description>Monitors for suspicious processes running within the container that could indicate escape attempts</description>
    <match>ps aux | grep -E '(sh|bash|zsh)'</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="101013" level="4">
    <description>Detects changes to Docker daemon configurations which could be exploited for container escape</description>
    <match>sed.*-i.*\/etc\/docker\/daemon.json</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="101014" level="3">
    <description>Detects the creation of new Docker containers with suspicious network capabilities</description>
    <match>docker run.*--cap-add.*NET_ADMIN</match>
    <group>Network Misuse</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101015" level="5">
    <description>Detect unauthorized access to Docker socket through /var/run/docker.sock</description>
    <match>.*(/var/run/docker.sock).*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101016" level="4">
    <description>Detect attempts to start a privileged container</description>
    <match>.*(--privileged).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101017" level="5">
    <description>Detect Docker container escape attempts using mounting the host filesystem</description>
    <match>.*(-v /:).*</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101018" level="3">
    <description>Detect suspicious use of Docker exec command to access running containers</description>
    <match>.*(docker exec).*</match>
    <group>Suspicious Activity</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="101019" level="4">
    <description>Detect unauthorized changes to Docker daemon configuration file</description>
    <match>.*(/etc/docker/daemon.json).*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1496</id>
    </mitre>
  </rule>
  <rule id="101020" level="5">
    <description>Detects attempts of privilege escalation within Docker containers.</description>
    <match>exec -u root</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101021" level="5">
    <description>Detects unauthorized access to Docker API.</description>
    <match>GET /containers/json HTTP/1.1 401 Unauthorized</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101022" level="4">
    <description>Detects suspicious network activity from Docker containers indicating possible data exfiltration.</description>
    <match>nc -e /bin/sh</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="101023" level="5">
    <description>Detects the use of container escape techniques.</description>
    <match>unshare --map-root-user</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101024" level="3">
    <description>Detects the presence of cryptocurrency mining scripts within Docker containers.</description>
    <match>minerd</match>
    <group>Cryptojacking</group>
    <mitre>
      <id>T1496</id>
    </mitre>
  </rule>
  <rule id="101025" level="10">
    <description>Detects attempts to break out of the Docker container using known escape techniques.</description>
    <match>exec.*--privileged</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="101026" level="9">
    <description>Monitors for suspicious privileged Docker commands that could indicate an attempt to escalate privileges.</description>
    <match>docker.*run.*--privileged</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101027" level="8">
    <description>Detects unauthorized modifications to Docker container configurations.</description>
    <match>docker.*update.*--restart</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1222</id>
    </mitre>
  </rule>
  <rule id="101028" level="8">
    <description>Detects suspicious usage of Docker commands to mount sensitive host directories inside the container.</description>
    <match>docker.*run.*-v.*:/etc</match>
    <group>Sensitive Data Exposure</group>
    <mitre>
      <id>T1552</id>
    </mitre>
  </rule>
  <rule id="101029" level="7">
    <description>Monitors for unexpected Docker exec commands that may indicate an unauthorized user gaining shell access.</description>
    <match>docker.*exec.*sh</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101030" level="9">
    <description>Detects potential privilege escalation attempts in Docker containers.</description>
    <match>PRIVILEGE_ESCALATION_DETECTED</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101031" level="8">
    <description>Identifies unauthorized access to Docker API without proper authentication.</description>
    <match>UNAUTHORIZED_DOCKER_API_ACCESS</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1527</id>
    </mitre>
  </rule>
  <rule id="101032" level="7">
    <description>Detects the use of known vulnerable Docker images.</description>
    <match>KNOWN_VULNERABLE_DOCKER_IMAGE</match>
    <group>Vulnerable Image</group>
    <mitre>
      <id>T1578</id>
    </mitre>
  </rule>
  <rule id="101033" level="8">
    <description>Monitors and alerts on abnormal network activity from Docker containers.</description>
    <match>ABNORMAL_DOCKER_NETWORK_ACTIVITY</match>
    <group>Network Anomaly</group>
    <mitre>
      <id>T1049</id>
    </mitre>
  </rule>
  <rule id="101034" level="9">
    <description>Detects attempts to escape the Docker container to the host system.</description>
    <match>DOCKER_CONTAINER_ESCAPE_ATTEMPT</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="101035" level="5">
    <description>Detects execution of suspicious binaries inside Docker containers indicating potential container escape attempts.</description>
    <match>.*(runc|nsenter|setns|unshare).*</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="101036" level="5">
    <description>Identifies Docker container running with an insecure privilege or capabilities setting, which could lead to privilege escalation.</description>
    <match>.*(--privileged|--cap-add=ALL).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101037" level="4">
    <description>Monitors for unusual network activity originating from Docker containers, which could indicate command and control communication.</description>
    <match>.*(nc|netcat|curl|wget).*</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101038" level="4">
    <description>Detects potential crypto-mining activities inside Docker containers by monitoring for mining software execution.</description>
    <match>.*(xmrig|minerd|cpuminer).*</match>
    <group>Resource Hijacking</group>
    <mitre>
      <id>T1496</id>
    </mitre>
  </rule>
  <rule id="101039" level="5">
    <description>Alerts on the presence of known malware or unauthorized software being executed within Docker containers.</description>
    <match>.*(malware_name|unauthorized_software).*</match>
    <group>Malware</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="101040" level="5">
    <description>Detects attempts to break out of Docker container using privileged mode.</description>
    <match>docker run.*--privileged</match>
    <group>container_escape</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101041" level="4">
    <description>Detects modification of Docker configuration files which might indicate an attempt to escalate privileges or escape the container.</description>
    <match>chmod.*(/etc/docker/daemon.json|/var/lib/docker/)</match>
    <group>container_tampering</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="101042" level="5">
    <description>Detects unauthorized access to the Docker socket which can lead to container escape and execution of arbitrary commands.</description>
    <match>chmod 666 /var/run/docker.sock</match>
    <group>privilege_escalation</group>
    <mitre>
      <id>T1569</id>
    </mitre>
  </rule>
  <rule id="101043" level="3">
    <description>Detects suspicious network activity within Docker containers that may indicate lateral movement or data exfiltration.</description>
    <match>iptables -A FORWARD|tcpdump -i eth0</match>
    <group>network_anomaly</group>
    <mitre>
      <id>T1040</id>
    </mitre>
  </rule>
  <rule id="101044" level="5">
    <description>Detects execution of known container escape exploits within Docker containers.</description>
    <match>CVE-2019-5736|runc exec|docker exec.*sh</match>
    <group>container_escape_exploit</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101045" level="5">
    <description>Detect unauthorized access to Docker socket</description>
    <match>unix:///var/run/docker.sock</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101046" level="4">
    <description>Detect execution of Docker commands by unauthorized users</description>
    <match>(docker run|docker exec|docker start|docker stop) .*</match>
    <group>Command Execution</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="101047" level="5">
    <description>Detect Docker container escape attempts</description>
    <match>mount .*(--rbind|--make-rshared|--make-rslave)</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101048" level="4">
    <description>Detect modification of Docker daemon configuration</description>
    <match>(systemctl|service) (restart|reload) docker</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1562</id>
    </mitre>
  </rule>
  <rule id="101049" level="3">
    <description>Detect suspicious network activity within Docker containers</description>
    <match>iptables .* -A .* -j DROP</match>
    <group>Network Anomaly</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="101050" level="9">
    <description>Detects downloads of container images from untrusted sources</description>
    <match>docker pull .*\/(?!trusted_registry)[^\s]+</match>
    <group>Suspicious Downloads</group>
    <mitre>
      <id>T1525</id>
    </mitre>
  </rule>
  <rule id="101051" level="8">
    <description>Detects unauthorized starts of containers with privileged access</description>
    <match>docker run .* --privileged</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101052" level="7">
    <description>Detects execution of containers with mounting sensitive host directories</description>
    <match>docker run .* -v (\/etc|\/root|\/var)\:[^\s]+</match>
    <group>Sensitive Data Exposure</group>
    <mitre>
      <id>T1083</id>
    </mitre>
  </rule>
  <rule id="101053" level="6">
    <description>Detects the use of outdated container images with known vulnerabilities</description>
    <match>docker run .*:(?!latest|[\d]+\.[\d]+\.[\d]+)</match>
    <group>Vulnerable Software</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="101054" level="5">
    <description>Detects unusual high frequency of container starts, indicating possible DoS attack</description>
    <match>docker run .*</match>
    <group>Denial of Service</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="101055" level="5">
    <description>Detects unauthorized modifications to Docker daemon configuration file.</description>
    <match>.*docker\s+cp\s+.+\/etc\/docker\/daemon\.json.*</match>
    <group>Unauthorized Configuration Change</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="101056" level="4">
    <description>Detects attempts to start or stop Docker containers by unauthorized users.</description>
    <match>.*docker\s+(start|stop)\s+--.*</match>
    <group>Unauthorized Container Control</group>
    <mitre>
      <id>T1609</id>
    </mitre>
  </rule>
  <rule id="101057" level="4">
    <description>Detects changes to Docker container resource limits (e.g., CPU, memory).</description>
    <match>.*docker\s+update\s+--(cpus|memory).*</match>
    <group>Resource Abuse</group>
    <mitre>
      <id>T1607</id>
    </mitre>
  </rule>
  <rule id="101058" level="3">
    <description>Detects attempts to modify Docker network settings.</description>
    <match>.*docker\s+network\s+(create|connect|disconnect).*</match>
    <group>Network Configuration Change</group>
    <mitre>
      <id>T1613</id>
    </mitre>
  </rule>
  <rule id="101059" level="5">
    <description>Detects the use of privileged containers which could lead to privilege escalation.</description>
    <match>.*docker\s+run\s+--privileged.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101060" level="9">
    <description>Detects unauthorized container image downloads from untrusted sources.</description>
    <match>.*docker pull (?!trusted_registry).*</match>
    <group>Suspicious Container Activity</group>
    <mitre>
      <id>T1525</id>
    </mitre>
  </rule>
  <rule id="101061" level="10">
    <description>Identifies abnormal start of a container with high privileges.</description>
    <match>.*docker run .*--privileged.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101062" level="8">
    <description>Detects the execution of a container with an unknown or unexpected image.</description>
    <match>.*docker run .* (?!known_image).*</match>
    <group>Suspicious Container Activity</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101063" level="7">
    <description>Monitors for large-scale container image downloads, which could indicate a potential data exfiltration or attack preparation.</description>
    <match>.*docker pull .*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="101064" level="8">
    <description>Detects the start of containers with unusual network configurations, which might be used for lateral movement.</description>
    <match>.*docker run .* --network (?!bridge|host).*</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>
  <rule id="101065" level="9">
    <description>Detects unauthorized changes to Docker container runtime configuration</description>
    <match>.*docker run.*--privileged.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101066" level="8">
    <description>Detects modification of Docker container firewall rules which could expose the container to external threats</description>
    <match>.*docker network connect.*</match>
    <group>Network Configuration</group>
    <mitre>
      <id>T1566</id>
    </mitre>
  </rule>
  <rule id="101067" level="7">
    <description>Detects unauthorized changes to Docker container resource limits, which could indicate attempts to abuse container resources</description>
    <match>.*docker update.*(--memory|--cpus).*</match>
    <group>Resource Abuse</group>
    <mitre>
      <id>T1496</id>
    </mitre>
  </rule>
  <rule id="101068" level="9">
    <description>Detects Docker commands that attempt to mount sensitive host directories into a container</description>
    <match>.*docker run.*-v /etc/passwd:/etc/passwd.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1069</id>
    </mitre>
  </rule>
  <rule id="101069" level="6">
    <description>Detects unauthorized changes to Docker container environment variables, which could indicate an attempt to alter container behavior</description>
    <match>.*docker exec.*-e.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1552</id>
    </mitre>
  </rule>
  <rule id="101070" level="10">
    <description>Detects attempts to break out of the container using /proc/self/exe method.</description>
    <match>(/proc/self/exe)</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101071" level="9">
    <description>Monitors for suspicious mounting of sensitive host directories inside the container.</description>
    <match>(mount.* /host/.*)</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1609</id>
    </mitre>
  </rule>
  <rule id="101072" level="9">
    <description>Detects unauthorized access to Docker socket (docker.sock) to gain control over Docker API.</description>
    <match>(docker.sock)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="101073" level="8">
    <description>Monitors for execution of shell commands within the container, indicating potential command injection.</description>
    <match>(exec.*sh|bash)</match>
    <group>Command Injection</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="101074" level="7">
    <description>Detects the creation or modification of suspicious network configurations within the container.</description>
    <match>(ifconfig|iptables|netstat|route)</match>
    <group>Network Misconfiguration</group>
    <mitre>
      <id>T1016</id>
    </mitre>
  </rule>
  <rule id="101075" level="5">
    <description>Detects unauthorized Docker container creation which could indicate a container escape or unauthorized access</description>
    <match>docker create|docker run</match>
    <group>Container Escape, Unauthorized Access</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101076" level="5">
    <description>Alerts on Docker containers running with privileged access which can lead to host compromise</description>
    <match>docker run.*--privileged</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101077" level="4">
    <description>Detects suspicious Docker exec commands which could indicate an attempt to execute commands within a running container</description>
    <match>docker exec.*bash|sh</match>
    <group>Command Execution, Container Escape</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="101078" level="4">
    <description>Alerts on Docker containers being started with sensitive mount points which could expose the host filesystem</description>
    <match>docker run.*-v /:/</match>
    <group>Data Exfiltration, Privilege Escalation</group>
    <mitre>
      <id>T1074</id>
    </mitre>
  </rule>
  <rule id="101079" level="3">
    <description>Detects unusual network activity originating from Docker containers which could indicate lateral movement or exfiltration</description>
    <match>docker network connect|docker network create</match>
    <group>Lateral Movement, Data Exfiltration</group>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
  <rule id="101080" level="9">
    <description>Detect unauthorized access to Docker configuration files</description>
    <match>(?i)(unauthorized|illegal)\saccess\s.*docker.*config</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101081" level="8">
    <description>Identify attempts to modify Docker daemon settings</description>
    <match>(?i)docker\sdaemon.*(modify|change|edit)</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="101082" level="7">
    <description>Monitor suspicious changes in Docker environment variables</description>
    <match>(?i)docker.*env.*(change|modify|update)</match>
    <group>Environment Manipulation</group>
    <mitre>
      <id>T1082</id>
    </mitre>
  </rule>
  <rule id="101083" level="9">
    <description>Detect unauthorized addition of privileged Docker containers</description>
    <match>(?i)docker.*run.*(--privileged)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101084" level="6">
    <description>Identify non-standard network configurations in Docker containers</description>
    <match>(?i)docker.*network.*(config|modify|set)</match>
    <group>Network Anomalies</group>
    <mitre>
      <id>T1049</id>
    </mitre>
  </rule>
  <rule id="101085" level="5">
    <description>Detects suspicious container image downloads from unknown sources</description>
    <match>docker pull .*\/(.*):latest</match>
    <group>Container Image Download</group>
    <mitre>
      <id>T1210</id>
    </mitre>
  </rule>
  <rule id="101086" level="4">
    <description>Detects unauthorized container starts by non-admin users</description>
    <match>docker run .*</match>
    <group>Unauthorized Container Start</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101087" level="3">
    <description>Detects multiple failed attempts to download container images</description>
    <match>docker pull .* (unauthorized: authentication required|error response from daemon)</match>
    <group>Failed Container Image Download</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101088" level="5">
    <description>Detects execution of containers with privileged flag</description>
    <match>docker run .* --privileged</match>
    <group>Privileged Container Execution</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101089" level="4">
    <description>Detects container starts with potentially malicious volume mounts</description>
    <match>docker run .* -v /etc/passwd:/etc/passwd</match>
    <group>Malicious Volume Mount</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="101090" level="9">
    <description>Detection of unauthorized data export via $out aggregation in MongoDB</description>
    <match>\$out</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="101091" level="8">
    <description>Suspicious usage of $merge aggregation for potential data exfiltration</description>
    <match>\$merge</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="101092" level="7">
    <description>Detection of excessive data reads potentially indicating data exfiltration</description>
    <match>(find|findOne)\s*\(\s*\{.*\}\s*\)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1074.002</id>
    </mitre>
  </rule>
  <rule id="101093" level="8">
    <description>Detection of MongoDB collections being copied to external locations using $lookup</description>
    <match>\$lookup</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="101094" level="9">
    <description>Detection of suspicious use of eval function which can be used for data exfiltration</description>
    <match>eval\s*\(</match>
    <group>Code Execution</group>
    <mitre>
      <id>T1059.006</id>
    </mitre>
  </rule>
  <rule id="101095" level="5">
    <description>Detect unauthorized creation of admin users</description>
    <match>.*\{&quot;createUser&quot;.*&quot;roles&quot;:\[.*\{&quot;role&quot;:&quot;root&quot;.*\}\].*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101096" level="4">
    <description>Identify unexpected database drop operations</description>
    <match>.*\{&quot;dropDatabase&quot;.*</match>
    <group>Data Destruction</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="101097" level="4">
    <description>Monitor for suspicious changes to user roles</description>
    <match>.*\{&quot;updateUser&quot;.*&quot;roles&quot;:\[.*\{&quot;role&quot;:&quot;.*admin.*&quot;.*\}\].*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="101098" level="3">
    <description>Detect bulk write operations to sensitive collections</description>
    <match>.*\{&quot;bulkWrite&quot;.*&quot;collection&quot;:&quot;sensitive_collection&quot;.*</match>
    <group>Data Tampering</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="101099" level="3">
    <description>Watch for unusual index modifications</description>
    <match>.*\{&quot;createIndex&quot;.*&quot;collection&quot;:&quot;.*&quot;.*</match>
    <group>Index Manipulation</group>
    <mitre>
      <id>T1071.003</id>
    </mitre>
  </rule>
  <rule id="101100" level="9">
    <description>Detects unauthorized creation of administrative users</description>
    <match>.*\&quot;createUser\&quot;.*\&quot;roles\&quot;:.*\&quot;admin\&quot;.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101101" level="8">
    <description>Detects large deletions of data indicating potential data exfiltration</description>
    <match>.*\&quot;deleteMany\&quot;.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="101102" level="7">
    <description>Detects modifications to critical database configurations</description>
    <match>.*\&quot;update\&quot;.*\&quot;config\&quot;.*</match>
    <group>Configuration Changes</group>
    <mitre>
      <id>T1496</id>
    </mitre>
  </rule>
  <rule id="101103" level="6">
    <description>Detects unusual high-volume writes to the database</description>
    <match>.*\&quot;insertMany\&quot;.*</match>
    <group>Suspicious Behavior</group>
    <mitre>
      <id>T1074</id>
    </mitre>
  </rule>
  <rule id="101104" level="5">
    <description>Detects changes to database roles and permissions</description>
    <match>.*\&quot;grantRolesToUser\&quot;.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101105" level="5">
    <description>Detects unauthorized user role changes indicating possible privilege escalation.</description>
    <match>.*\&quot;role\&quot;:\&quot;dbAdmin\&quot;.*\&quot;action\&quot;:\&quot;updateUser\&quot;.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101106" level="5">
    <description>Detects the creation of new administrative users.</description>
    <match>.*\&quot;createUser\&quot;.*\&quot;roles\&quot;:.*\&quot;role\&quot;:\&quot;dbAdmin\&quot;.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="101107" level="4">
    <description>Detects modifications to user roles granting admin privileges.</description>
    <match>.*\&quot;updateUser\&quot;.*\&quot;roles\&quot;:.*\&quot;role\&quot;:\&quot;root\&quot;.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101108" level="3">
    <description>Detects suspicious direct access to system collections.</description>
    <match>.*\&quot;ns\&quot;:\&quot;admin.system.users\&quot;.*\&quot;command\&quot;:\&quot;find\&quot;.*</match>
    <group>Suspicious Activity</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="101109" level="4">
    <description>Detects attempts to drop databases which might indicate malicious intent.</description>
    <match>.*\&quot;dropDatabase\&quot;.*</match>
    <group>Destructive Action</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="101110" level="9">
    <description>Detects unauthorized access attempts to sensitive collections</description>
    <match>.*db\.sensitive_collection\.(find|insert|update|remove).*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1213</id>
    </mitre>
  </rule>
  <rule id="101111" level="8">
    <description>Flags high volume of data read operations in a short time frame</description>
    <match>.*db\..*\.find\(\).*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="101112" level="8">
    <description>Detects queries that export data to external locations</description>
    <match>.*mongoexport.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="101113" level="7">
    <description>Detects usage of $where operator indicating potential injection or exfiltration attempts</description>
    <match>.*\$where.*</match>
    <group>Injection</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="101114" level="9">
    <description>Flags administrative commands executed by non-admin users</description>
    <match>.*db\.runCommand\(\{.*\}\).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101115" level="5">
    <description>Detects brute force login attempts based on repeated failed login attempts from the same IP</description>
    <match>.*failed login.*from IP.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="101116" level="5">
    <description>Monitors for unauthorized access attempts by detecting login attempts with non-existent usernames</description>
    <match>.*login failed.*non-existent user.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101117" level="4">
    <description>Identifies potential privilege escalation by monitoring changes in user roles or permissions</description>
    <match>.*user role change.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101118" level="4">
    <description>Detects suspicious data export activities that could indicate data exfiltration attempts</description>
    <match>.*exporting data.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="101119" level="3">
    <description>Monitors for unusual database queries that could indicate SQL injection attempts</description>
    <match>.*SELECT.*FROM.*WHERE.*</match>
    <group>Injection Attacks</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="101120" level="10">
    <description>Detects unauthorized data export via MongoDB queries using $out stage in aggregation pipeline</description>
    <match>\$out\s*:\s*\{\s*.*\s*\}</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="101121" level="9">
    <description>Detects queries that attempt to access sensitive information such as credit card numbers</description>
    <match>&quot;credit_card&quot;\s*:\s*\{\s*.*\s*\}</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1074</id>
    </mitre>
  </rule>
  <rule id="101122" level="8">
    <description>Detects large data dumps using find queries with no limit</description>
    <match>find\(\s*\{\s*.*\s*\}\s*\)\s*\.\s*toArray\(\)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101123" level="7">
    <description>Detects use of $merge stage to write query results into another collection, implying potential data exfiltration</description>
    <match>\$merge\s*:\s*\{\s*.*\s*\}</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="101124" level="6">
    <description>Detects queries that attempt to export data to external systems using $lookup with foreign collections</description>
    <match>\$lookup\s*:\s*\{\s*.*\s*from\s*:\s*&quot;external_.*&quot;\s*\}</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1074</id>
    </mitre>
  </rule>
  <rule id="101125" level="5">
    <description>Detects unauthorized user role modifications indicating potential privilege escalation</description>
    <match>.*\.(grantRolesToUser|revokeRolesFromUser|updateUser).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101126" level="4">
    <description>Detects creation of new administrative accounts which could indicate a privilege escalation attack</description>
    <match>.*\.createUser.*(roles.*root|roles.*dbAdmin|roles.*userAdmin).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="101127" level="4">
    <description>Detects changes to MongoDB configuration settings that could be used to escalate privileges</description>
    <match>.*\.setParameter.*(authSchemaVersion|enableLocalhostAuthBypass).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1222</id>
    </mitre>
  </rule>
  <rule id="101128" level="3">
    <description>Detects direct updates to system collections which may indicate privilege abuse</description>
    <match>.*\.(update|replace).*\.(system.users|system.roles).*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101129" level="5">
    <description>Detects the use of the eval command which can be used to execute arbitrary JavaScript with elevated privileges</description>
    <match>.*\.eval.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="101130" level="5">
    <description>Detects unauthorized role escalations to admin roles</description>
    <match>(?i)\bgrantRolesToUser\b.*\badmin\b</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101131" level="4">
    <description>Detects suspicious creation of new user accounts with high privileges</description>
    <match>(?i)\bcreateUser\b.*(\broot\b|\bdbAdmin\b|\buserAdmin\b)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="101132" level="4">
    <description>Detects modification of user privileges to higher levels</description>
    <match>(?i)\bupdateUser\b.*\broles\b.*(\broot\b|\bdbAdmin\b|\buserAdmin\b)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101133" level="5">
    <description>Detects unauthorized access to system collections and configurations</description>
    <match>(?i)\bdb\b\.\bgetCollection\b\(.*\b(system\..*)\b\)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1201</id>
    </mitre>
  </rule>
  <rule id="101134" level="5">
    <description>Detects attempts to bypass authentication mechanisms</description>
    <match>(?i)\b(db\.auth\b.*\bnull\b|\b(db\.logout\b.*\b;\b\s*\bdb\.auth\b.*\b;))</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101135" level="10">
    <description>Detects unauthorized administrative access attempts to MongoDB database</description>
    <match>.*\[Unauthorized\] User .* attempted to access admin database.*</match>
    <group>unauthorized-access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101136" level="9">
    <description>Detects brute force login attempts on MongoDB</description>
    <match>.*\[BruteForce\] Multiple failed login attempts detected from IP .*</match>
    <group>brute-force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="101137" level="8">
    <description>Detects potential data exfiltration by monitoring large data transfers</description>
    <match>.*\[DataExfiltration\] Large volume of data transferred from collection .*</match>
    <group>data-exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="101138" level="7">
    <description>Detects unauthorized changes to MongoDB user roles</description>
    <match>.*\[UnauthorizedChange\] User roles modified without proper authorization.*</match>
    <group>privilege-escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101139" level="6">
    <description>Detects suspicious IP addresses accessing MongoDB</description>
    <match>.*\[SuspiciousIP\] Connection from suspicious IP address .*</match>
    <group>suspicious-activity</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101140" level="5">
    <description>Detects brute-force attacks by monitoring repeated failed login attempts</description>
    <match>.*failed to authenticate.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="101141" level="4">
    <description>Detects unauthorized access attempts from suspicious IP addresses</description>
    <match>.*connection attempt from suspicious IP.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101142" level="5">
    <description>Detects attempts to access MongoDB collections without proper authorization</description>
    <match>.*unauthorized collection access.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078.001</id>
    </mitre>
  </rule>
  <rule id="101143" level="4">
    <description>Detects modification of user roles or permissions</description>
    <match>.*role modification.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101144" level="5">
    <description>Detects suspicious data exfiltration activities</description>
    <match>.*suspicious data export.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1020</id>
    </mitre>
  </rule>
  <rule id="101145" level="5">
    <description>Detects unauthorized user creation in MongoDB.</description>
    <match>.*db\.createUser\(.*</match>
    <group>User Management</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="101146" level="5">
    <description>Monitors for the dropping of critical databases in MongoDB.</description>
    <match>.*db\.dropDatabase\(.*</match>
    <group>Database Operations</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="101147" level="4">
    <description>Detects unauthorized role assignment to a user in MongoDB.</description>
    <match>.*db\.grantRolesToUser\(.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101148" level="4">
    <description>Monitors for the deletion of collections in MongoDB.</description>
    <match>.*db\.collection\.drop\(.*</match>
    <group>Database Operations</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="101149" level="3">
    <description>Detects the modification of user roles in MongoDB.</description>
    <match>.*db\.updateUser\(.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101150" level="5">
    <description>Detect unauthorized changes to admin user roles</description>
    <match>.*\{&quot;role&quot;:\s*&quot;admin&quot;.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101151" level="4">
    <description>Detect creation of new roles by non-admin users</description>
    <match>.*\{&quot;createRole&quot;.*</match>
    <group>Unauthorized Role Creation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101152" level="3">
    <description>Detect modification of user roles outside of business hours</description>
    <match>.*\{&quot;updateUser&quot;.*</match>
    <group>Suspicious Activity</group>
    <mitre>
      <id>T1078.001</id>
    </mitre>
  </rule>
  <rule id="101153" level="4">
    <description>Detect deletion of user roles without prior admin approval</description>
    <match>.*\{&quot;dropRole&quot;.*</match>
    <group>Unauthorized Role Deletion</group>
    <mitre>
      <id>T1488</id>
    </mitre>
  </rule>
  <rule id="101154" level="5">
    <description>Detect assignment of high-privilege roles to new users</description>
    <match>.*\{&quot;grantRolesToUser&quot;.*&quot;role&quot;:\s*&quot;dbOwner&quot;.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1069</id>
    </mitre>
  </rule>
  <rule id="101155" level="4">
    <description>Detect unauthorized addition of admin roles to MongoDB users</description>
    <match>.*\{&quot;roles&quot;:\[.*&quot;role&quot;:&quot;(dbAdmin|userAdmin|clusterAdmin)&quot;.*\]\}.*</match>
    <group>Unauthorized Role Assignment</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101156" level="4">
    <description>Detect unauthorized removal of admin roles from MongoDB users</description>
    <match>.*\{&quot;$pull&quot;:\{&quot;roles&quot;:\{&quot;role&quot;:&quot;(dbAdmin|userAdmin|clusterAdmin)&quot;.*\}\}\}.*</match>
    <group>Unauthorized Role Removal</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101157" level="5">
    <description>Detect creation of new users with high privileges in MongoDB</description>
    <match>.*\{&quot;createUser&quot;:.*&quot;roles&quot;:\[.*&quot;role&quot;:&quot;(dbAdmin|userAdmin|clusterAdmin)&quot;.*\]\}.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="101158" level="4">
    <description>Detect unauthorized changes to user roles in MongoDB</description>
    <match>.*\{&quot;updateUser&quot;:.*&quot;roles&quot;:\[.*\]\}.*</match>
    <group>Role Modification</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101159" level="3">
    <description>Detect unauthorized attempts to grant roles that do not exist in the predefined role sets</description>
    <match>.*\{&quot;roles&quot;:\[\{&quot;role&quot;:&quot;[^&quot;\]]*&quot;.*\}\]\}.*</match>
    <group>Suspicious Role Assignment</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101160" level="4">
    <description>Detection of large data export via MongoDB queries which may indicate data exfiltration.</description>
    <match>db\..*\.find\(\{.*\}\)\.limit\(\d{4,}\)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1030</id>
    </mitre>
  </rule>
  <rule id="101161" level="3">
    <description>Unusual user access pattern indicating possible data exfiltration attempts.</description>
    <match>db.getUsers\(\)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1040</id>
    </mitre>
  </rule>
  <rule id="101162" level="4">
    <description>Detecting the use of MongoDB's aggregation framework for large data retrievals.</description>
    <match>db\..*\.aggregate\(\[\{\$match: \{.*\}, \$group: \{.*\}, \$limit: \d{4,}\}\]\)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1074</id>
    </mitre>
  </rule>
  <rule id="101163" level="5">
    <description>Monitoring for export commands that may indicate data exfiltration.</description>
    <match>mongoexport --db .* --collection .* --out .*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="101164" level="4">
    <description>Detection of unauthorized IP addresses attempting to access MongoDB.</description>
    <match>db.currentOp\(\{\$all: true\}\)\.inprog\[\{.*client: \&quot;(?!127\.0\.0\.1|::1|your.whitelisted.ip).+\&quot;.*\}\]</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101165" level="5">
    <description>Detects unauthorized root user creation in MongoDB</description>
    <match>db\.system\.users\.insert\({.*&quot;user&quot;\s*:\s*&quot;root&quot;.*}</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101166" level="4">
    <description>Detects large-scale data deletion in MongoDB collections</description>
    <match>db\.[a-zA-Z0-9_]+\.remove\({})</match>
    <group>Data Destruction</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="101167" level="4">
    <description>Detects unauthorized changes to MongoDB configurations</description>
    <match>db\.adminCommand\({.*&quot;setParameter&quot;.*})</match>
    <group>Configuration Changes</group>
    <mitre>
      <id>T1496</id>
    </mitre>
  </rule>
  <rule id="101168" level="3">
    <description>Detects execution of JavaScript code in MongoDB</description>
    <match>db\.eval\(.*\)</match>
    <group>Execution</group>
    <mitre>
      <id>T1059.007</id>
    </mitre>
  </rule>
  <rule id="101169" level="3">
    <description>Detects unauthorized access to MongoDB collections</description>
    <match>db\.runCommand\({.*&quot;listCollections&quot;.*})</match>
    <group>Discovery</group>
    <mitre>
      <id>T1010</id>
    </mitre>
  </rule>
  <rule id="101170" level="9">
    <description>Detect large amounts of data being read from MongoDB collections</description>
    <match>find\(\{\}, \{.*\}\)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101171" level="8">
    <description>Identify unauthorized MongoDB administrative commands</description>
    <match>(?i)\b(eval|db\.(runCommand|shutdownServer|dropDatabase|repairDatabase))\b</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101172" level="7">
    <description>Monitor for MongoDB queries with excessively broad filters</description>
    <match>find\(\{\s*\}\)</match>
    <group>Suspicious Query</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101173" level="8">
    <description>Detect unusual data export operations from MongoDB</description>
    <match>(?i)\b(mongoexport|db\.(collection\.)?find.*)\b</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="101174" level="6">
    <description>Identify high volume of MongoDB queries within a short timeframe</description>
    <match>find\(.*\)</match>
    <group>Suspicious Activity</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101175" level="9">
    <description>Detects unauthorized role addition to a user, which may indicate privilege escalation.</description>
    <match>^.*\&quot;roles\&quot;:\[\{&quot;role\&quot;:\&quot;.*\&quot;,\&quot;db\&quot;:\&quot;admin\&quot;\}\].*\&quot;user\&quot;:\&quot;.*\&quot;.*$</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101176" level="8">
    <description>Detects changes to user roles from a non-admin user, indicating potential misuse of privileges.</description>
    <match>^.*\&quot;updateUser\&quot;:\&quot;.*\&quot;,.*\&quot;roles\&quot;:\[.*\].*\&quot;performedBy\&quot;:\&quot;.*\&quot;.*$</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101177" level="9">
    <description>Identifies the creation of new users with administrative roles, which could be a sign of privilege escalation.</description>
    <match>^.*\&quot;createUser\&quot;:\&quot;.*\&quot;,.*\&quot;roles\&quot;:\[\{&quot;role\&quot;:\&quot;root\&quot;,\&quot;db\&quot;:\&quot;admin\&quot;\}\].*$</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="101178" level="7">
    <description>Detects unauthorized access attempts to the MongoDB admin database, which could indicate an attempt to escalate privileges.</description>
    <match>^.*\&quot;ns\&quot;:\&quot;admin\.system\.users\&quot;.*\&quot;command\&quot;:\{&quot;find\&quot;.*$</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101179" level="8">
    <description>Detects modifications to MongoDB user credentials, which could indicate an attempt to gain higher privileges.</description>
    <match>^.*\&quot;updateUser\&quot;:\&quot;.*\&quot;,.*\&quot;pwd\&quot;:\&quot;.*\&quot;.*$</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101180" level="10">
    <description>Detects unauthorized admin user creation which may indicate privilege escalation attempts.</description>
    <match>.*\bcreateUser\b.*\broles\b.*\badmin\b.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="101181" level="9">
    <description>Monitors for large number of deletions indicating potential data destruction or ransomware activity.</description>
    <match>.*\bdeleteMany\b.*</match>
    <group>Data Destruction</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="101182" level="8">
    <description>Detects unusual bulk updates which may indicate a mass data manipulation attempt.</description>
    <match>.*\bupdateMany\b.*</match>
    <group>Data Manipulation</group>
    <mitre>
      <id>T1491</id>
    </mitre>
  </rule>
  <rule id="101183" level="7">
    <description>Detects unauthorized direct access to sensitive collections such as admin or config.</description>
    <match>.*\b(admin|config)\b.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101184" level="6">
    <description>Monitors for unusual database role modifications which may indicate privilege escalation attempts.</description>
    <match>.*\bgrantRolesToUser\b.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.004</id>
    </mitre>
  </rule>
  <rule id="101185" level="5">
    <description>Detect unauthorized addition of admin roles to a user.</description>
    <match>.*\&quot;roles\&quot;:\[.*\&quot;role\&quot;:\&quot;admin\&quot;.*\].*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101186" level="5">
    <description>Detect unauthorized creation of new user with admin privileges.</description>
    <match>.*\&quot;createUser\&quot;:.*\&quot;roles\&quot;:\[.*\&quot;role\&quot;:\&quot;admin\&quot;.*\].*</match>
    <group>Account Creation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="101187" level="4">
    <description>Detect unauthorized role modifications for existing users.</description>
    <match>.*\&quot;updateUser\&quot;:.*\&quot;roles\&quot;:\[.*\&quot;role\&quot;:.*\].*</match>
    <group>Privilege Modification</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101188" level="3">
    <description>Detect unauthorized removal of roles from users.</description>
    <match>.*\&quot;updateUser\&quot;:.*\&quot;roles\&quot;:\[\].*</match>
    <group>Privilege Modification</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101189" level="4">
    <description>Detect unauthorized deletion of users.</description>
    <match>.*\&quot;dropUser\&quot;:.*</match>
    <group>Account Deletion</group>
    <mitre>
      <id>T1488</id>
    </mitre>
  </rule>
  <rule id="101190" level="10">
    <description>Detect unauthorized root access to MongoDB instances</description>
    <match>.*\&quot;user\&quot;:\&quot;root\&quot;.*\&quot;action\&quot;:\&quot;authenticate\&quot;.*</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101191" level="9">
    <description>Detect creation of hidden admin users in MongoDB</description>
    <match>.*\&quot;createUser\&quot;:\&quot;.*admin.*\&quot;.*\&quot;roles\&quot;:\[\{\&quot;role\&quot;:\&quot;root\&quot;.*\}\].*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="101192" level="8">
    <description>Detect large number of failed login attempts to MongoDB</description>
    <match>.*\&quot;action\&quot;:\&quot;authenticate\&quot;.*\&quot;result\&quot;:\&quot;fail\&quot;.*</match>
    <group>Brute Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="101193" level="7">
    <description>Detect unauthorized IP addresses accessing MongoDB instances</description>
    <match>.*\&quot;remote_ip\&quot;:\&quot;(?!192\.168\.1\.|10\.|172\.(1[6-9]|2[0-9]|3[0-1]))[^\&quot;]+\&quot;.*</match>
    <group>Network Intrusion</group>
    <mitre>
      <id>T1049</id>
    </mitre>
  </rule>
  <rule id="101194" level="7">
    <description>Detect execution of potentially malicious scripts in MongoDB</description>
    <match>.*\&quot;eval\&quot;:\&quot;.*\&quot;.*</match>
    <group>Command Execution</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="101195" level="10">
    <description>Detect unauthorized addition of admin roles to a user</description>
    <match>.*\{&quot;createUser&quot;:\s*&quot;.+&quot;,\s*&quot;roles&quot;:\s*\[\{&quot;role&quot;:\s*&quot;admin&quot;</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101196" level="9">
    <description>Detect unauthorized modification of existing user roles</description>
    <match>.*\{&quot;updateUser&quot;:\s*&quot;.+&quot;,\s*&quot;roles&quot;:\s*\[\{&quot;role&quot;:\s*&quot;.+&quot;</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101197" level="8">
    <description>Detect unauthorized removal of roles from a user</description>
    <match>.*\{&quot;updateUser&quot;:\s*&quot;.+&quot;,\s*&quot;roles&quot;:\s*\[\]</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101198" level="10">
    <description>Detect unauthorized creation of a user with elevated roles</description>
    <match>.*\{&quot;createUser&quot;:\s*&quot;.+&quot;,\s*&quot;roles&quot;:\s*\[\{&quot;role&quot;:\s*&quot;dbOwner&quot;</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101199" level="7">
    <description>Detect unauthorized granting of 'readWrite' roles to a user</description>
    <match>.*\{&quot;grantRolesToUser&quot;:\s*&quot;.+&quot;,\s*&quot;roles&quot;:\s*\[\{&quot;role&quot;:\s*&quot;readWrite&quot;</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101200" level="10">
    <description>Detects unauthorized creation of admin users, indicating potential privilege escalation.</description>
    <match>.*\&quot;createUser\&quot;\s*:\s*\{\s*\&quot;roles\&quot;\s*:\s*\[.*\&quot;role\&quot;\s*:\s*\&quot;root\&quot;.*\]\}</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101201" level="9">
    <description>Detects unauthorized role assignment to existing users, indicating potential privilege escalation.</description>
    <match>.*\&quot;grantRolesToUser\&quot;\s*:\s*\{\s*\&quot;roles\&quot;\s*:\s*\[.*\&quot;role\&quot;\s*:\s*\&quot;root\&quot;.*\]\}</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101202" level="8">
    <description>Detects unauthorized access to system collections, indicating potential privilege escalation.</description>
    <match>.*\&quot;find\&quot;\s*:\s*\&quot;system\..*\&quot;</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1087</id>
    </mitre>
  </rule>
  <rule id="101203" level="7">
    <description>Detects unauthorized changes to user roles, indicating potential privilege escalation.</description>
    <match>.*\&quot;updateUser\&quot;\s*:\s*\{.*\&quot;roles\&quot;\s*:\s*\[.*\&quot;role\&quot;\s*:\s*\&quot;root\&quot;.*\]\}</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101204" level="10">
    <description>Detects unauthorized dropping of databases, indicating potential privilege escalation or data destruction.</description>
    <match>.*\&quot;dropDatabase\&quot;\s*:\s*1</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="101205" level="5">
    <description>Detect unauthorized addition of user roles with admin privileges</description>
    <match>.*\{&quot;roles&quot;\:.*&quot;role&quot;\:&quot;admin&quot;.*\}</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101206" level="4">
    <description>Detect unauthorized removal of user roles</description>
    <match>.*\{&quot;dropRole&quot;\:.*\}</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1070.004</id>
    </mitre>
  </rule>
  <rule id="101207" level="4">
    <description>Detect unauthorized modification of user roles</description>
    <match>.*\{&quot;updateRole&quot;\:.*\}</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1087.003</id>
    </mitre>
  </rule>
  <rule id="101208" level="3">
    <description>Detect creation of high-privilege roles during non-working hours</description>
    <match>.*\{&quot;createRole&quot;\:.*\&quot;roles&quot;\:.*\&quot;role&quot;\:.*\&quot;admin&quot;.*\}</match>
    <group>Anomalous Activity</group>
    <mitre>
      <id>T1078.001</id>
    </mitre>
  </rule>
  <rule id="101209" level="3">
    <description>Detect multiple failed attempts to modify user roles</description>
    <match>.*\{&quot;updateRole&quot;\:.*\}(?=.*&quot;ok&quot;\:0)</match>
    <group>Brute Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="101210" level="10">
    <description>Detects unauthorized access attempts to Kubernetes API server</description>
    <match>Unauthorized.*access.*Kubernetes.*API</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101211" level="9">
    <description>Detects suspicious use of kubectl exec command</description>
    <match>kubectl.*exec.*-it.*sh</match>
    <group>Command Execution</group>
    <mitre>
      <id>T1059.004</id>
    </mitre>
  </rule>
  <rule id="101212" level="8">
    <description>Detects abnormal creation of ClusterRoleBinding</description>
    <match>create.*ClusterRoleBinding</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078.003</id>
    </mitre>
  </rule>
  <rule id="101213" level="7">
    <description>Detects modification of Kubernetes network policies</description>
    <match>patch.*NetworkPolicy</match>
    <group>Network Policy Modification</group>
    <mitre>
      <id>T1557.003</id>
    </mitre>
  </rule>
  <rule id="101214" level="9">
    <description>Detects potential container escape attempts via mounting sensitive directories</description>
    <match>mount.*(/host|/etc|/var/run)</match>
    <group>Container Escape</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101215" level="10">
    <description>Detects a high volume of requests from a single IP address in a short time frame, indicating a potential DDoS attack.</description>
    <match>(\d+\.\d+\.\d+\.\d+).*(GET|POST).*</match>
    <group>DDoS</group>
    <mitre>
      <id>T1498</id>
    </mitre>
  </rule>
  <rule id="101216" level="9">
    <description>Identifies multiple requests with unusual user-agent strings, which can indicate bot traffic as part of a DDoS attack.</description>
    <match>.*&quot;User-Agent&quot;: &quot;(?!Mozilla|Chrome|Safari|Edge).*&quot;.*</match>
    <group>DDoS</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101217" level="8">
    <description>Detects a large number of requests to a single resource, indicating a potential HTTP flood attack.</description>
    <match>.*GET /resource/path.*</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="101218" level="7">
    <description>Monitors for frequent requests with incomplete HTTP headers, which can be indicative of a Slowloris attack.</description>
    <match>.*&quot;GET / HTTP/1.1&quot;.*\r\n\r\n$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1498.001</id>
    </mitre>
  </rule>
  <rule id="101219" level="6">
    <description>Tracks high frequency of POST requests with large payloads, signaling a potential DDoS attack via large payload requests.</description>
    <match>.*POST /.*Content-Length: ([0-9]{5,}).*</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499.003</id>
    </mitre>
  </rule>
  <rule id="101220" level="10">
    <description>Detect network communication to known malicious IP addresses</description>
    <match>.*dst_ip: (192\.0\.2\.|198\.51\.100\.|203\.0\.113\.).*</match>
    <group>Network Threats</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="101221" level="9">
    <description>Unusual spike in network traffic between pods indicating possible data exfiltration</description>
    <match>.*src_pod: .* dst_pod: .* bytes_transferred: ([1-9][0-9]{6,}).*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="101222" level="8">
    <description>Detection of port scanning activity from one pod to multiple other pods</description>
    <match>.*src_pod: .* dst_pod: .* dst_port: (22|80|443|8080).*</match>
    <group>Reconnaissance</group>
    <mitre>
      <id>T1046</id>
    </mitre>
  </rule>
  <rule id="101223" level="8">
    <description>Pods communicating over non-standard network ports indicating possible command and control activity</description>
    <match>.*src_pod: .* dst_pod: .* dst_port: ([3-9][0-9]{3,5}).*</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1071.004</id>
    </mitre>
  </rule>
  <rule id="101224" level="7">
    <description>Detection of lateral movement between Kubernetes pods using remote services</description>
    <match>.*src_pod: .* dst_pod: .* service: (ssh|rdp|smb).*</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>
  <rule id="101225" level="4">
    <description>Detects brute force login attempts to MongoDB by monitoring multiple failed authentication attempts in a short period.</description>
    <match>.*Authentication\s+failed\s+for\s+user.*</match>
    <group>Authentication,Brute Force</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="101226" level="3">
    <description>Detects unauthorized access by monitoring successful logins from unusual IP addresses or geolocations.</description>
    <match>.*Successful\s+authentication\s+from\s+unknown\s+IP\s+address.*</match>
    <group>Authentication,Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101227" level="5">
    <description>Detects creation of new administrative accounts which could indicate privilege escalation.</description>
    <match>.*createUser\s+.*role\s+:\s+\[\s+.*'dbAdminAnyDatabase'.*</match>
    <group>Privilege Escalation,Account Creation</group>
    <mitre>
      <id>T1136</id>
    </mitre>
  </rule>
  <rule id="101228" level="5">
    <description>Detects data exfiltration attempts by monitoring large amounts of data being read or exported from the database.</description>
    <match>.*find\s+.*\{\s+\$export\s+:\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="101229" level="4">
    <description>Detects potentially malicious activity by monitoring for the use of 'eval' function which is often used in injection attacks.</description>
    <match>.*\&quot;\$where\&quot;\s*:\s*\&quot;function\(\)\s*\{.*</match>
    <group>Code Execution,Injection</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="101230" level="9">
    <description>Detect changes to Docker container configurations through unauthorized 'docker exec' commands.</description>
    <match>docker exec.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1611</id>
    </mitre>
  </rule>
  <rule id="101231" level="8">
    <description>Monitor for unauthorized modifications to Docker daemon configuration files.</description>
    <match>.*(/etc/docker/daemon.json).*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1612</id>
    </mitre>
  </rule>
  <rule id="101232" level="7">
    <description>Detect the usage of 'docker cp' command to alter container files by unauthorized users.</description>
    <match>docker cp.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1082</id>
    </mitre>
  </rule>
  <rule id="101233" level="6">
    <description>Catch unauthorized attempts to restart Docker containers using 'docker restart'.</description>
    <match>docker restart.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1613</id>
    </mitre>
  </rule>
  <rule id="101234" level="5">
    <description>Identify unauthorized changes to Docker network settings through 'docker network' commands.</description>
    <match>docker network.*</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1608</id>
    </mitre>
  </rule>
  <rule id="101235" level="9">
    <description>Detect unauthorized changes to the main Apache configuration file (httpd.conf)</description>
    <match>.*(/etc/apache2|/usr/local/apache2)/httpd\.conf.*</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1220</id>
    </mitre>
  </rule>
  <rule id="101236" level="8">
    <description>Detect unauthorized modifications to Apache virtual host configuration files (vhost.conf)</description>
    <match>.*(/etc/apache2/sites-available|/usr/local/apache2/conf/extra)/vhost\.conf.*</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1220</id>
    </mitre>
  </rule>
  <rule id="101237" level="7">
    <description>Detect suspicious changes in Apache .htaccess files which override server configuration</description>
    <match>.*\.htaccess.*</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1220</id>
    </mitre>
  </rule>
  <rule id="101238" level="8">
    <description>Detect unauthorized updates to Apache SSL/TLS configuration files (ssl.conf)</description>
    <match>.*(/etc/apache2|/usr/local/apache2)/conf/extra/ssl\.conf.*</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1220</id>
    </mitre>
  </rule>
  <rule id="101239" level="6">
    <description>Detect unauthorized changes to Apache logging configuration files (log.conf)</description>
    <match>.*(/etc/apache2|/usr/local/apache2)/conf/extra/log\.conf.*</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1220</id>
    </mitre>
  </rule>
  <rule id="101240" level="5">
    <description>Detects creation of a new IAM user with administrative privileges, which is a common sign of unauthorized access and privilege escalation.</description>
    <match>CreateUser.*?\&quot;GroupName\&quot;: \&quot;Admin\&quot;</match>
    <group>privilege_escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101241" level="4">
    <description>Monitors for the attachment of an existing IAM policy to a user that grants administrative privileges, indicating a potential privilege escalation attempt.</description>
    <match>AttachUserPolicy.*?\&quot;PolicyArn\&quot;: \&quot;arn:aws:iam::aws:policy/AdministratorAccess\&quot;</match>
    <group>privilege_escalation</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="101242" level="3">
    <description>Identifies the creation of a new IAM policy that grants full administrative privileges, which may indicate an attempt to escalate privileges.</description>
    <match>CreatePolicy.*?\&quot;PolicyDocument\&quot;: .*\&quot;Effect\&quot;: \&quot;Allow\&quot;,.*\&quot;Action\&quot;: \&quot;*\&quot;,.*\&quot;Resource\&quot;: \&quot;*\&quot;</match>
    <group>privilege_escalation</group>
    <mitre>
      <id>T1069</id>
    </mitre>
  </rule>
  <rule id="101243" level="4">
    <description>Detects unauthorized changes to IAM roles that grant administrative access, suggesting a privilege escalation attempt.</description>
    <match>UpdateAssumeRolePolicy.*?\&quot;PolicyDocument\&quot;: .*\&quot;Effect\&quot;: \&quot;Allow\&quot;,.*\&quot;Action\&quot;: \&quot;sts:AssumeRole\&quot;,.*\&quot;Resource\&quot;: \&quot;arn:aws:iam::[0-9]{12}:role/admin\&quot;</match>
    <group>privilege_escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101244" level="4">
    <description>Monitors for the creation of a new IAM access key for an existing user with administrative privileges, which can be a sign of unauthorized access.</description>
    <match>CreateAccessKey.*?\&quot;UserName\&quot;: \&quot;admin\&quot;</match>
    <group>privilege_escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101245" level="9">
    <description>Detects unauthorized role assignments indicating potential privilege escalation.</description>
    <match>.*\&quot;role\&quot;:\&quot;root\&quot;.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1069.001</id>
    </mitre>
  </rule>
  <rule id="101246" level="8">
    <description>Detects creation of admin or user with elevated privileges.</description>
    <match>.*\&quot;createUser\&quot;:.*\&quot;roles\&quot;:.*\&quot;admin\&quot;.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101247" level="8">
    <description>Detects changes to user roles that grant excessive permissions.</description>
    <match>.*\&quot;updateUser\&quot;:.*\&quot;roles\&quot;:.*\&quot;dbOwner\&quot;.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101248" level="7">
    <description>Detects suspicious use of the 'grantRolesToUser' action.</description>
    <match>.*\&quot;grantRolesToUser\&quot;:.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101249" level="9">
    <description>Detects direct modifications to the system.roles collection.</description>
    <match>.*\&quot;update\&quot;:\&quot;system.roles\&quot;.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101250" level="5">
    <description>Detects large data dumps by monitoring for SELECT statements with large result sets</description>
    <match>SELECT\s+.*\s+FROM\s+.*\s+LIMIT\s+\d{5,}</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101251" level="5">
    <description>Detects export operations to external files using SELECT INTO OUTFILE</description>
    <match>SELECT\s+.*\s+INTO\s+OUTFILE\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1041</id>
    </mitre>
  </rule>
  <rule id="101252" level="4">
    <description>Monitors for the creation of new users with suspicious privileges</description>
    <match>CREATE\s+USER\s+.*\s+IDENTIFIED\s+BY\s+.*\s+GRANT\s+ALL\s+PRIVILEGES</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101253" level="4">
    <description>Detects unauthorized changes to database schema using ALTER statements</description>
    <match>ALTER\s+TABLE\s+.*\s+ADD\s+COLUMN\s+.*</match>
    <group>Unauthorized Changes</group>
    <mitre>
      <id>T1222</id>
    </mitre>
  </rule>
  <rule id="101254" level="3">
    <description>Identifies suspicious connections from unusual IP addresses</description>
    <match>CONNECT\s+.*\s+FROM\s+&quot;(?!192\.168|10\.|172\.(1[6-9]|2[0-9]|3[0-1]))[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}&quot;</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101255" level="9">
    <description>Detects unauthorized container image downloads from untrusted sources</description>
    <match>docker pull (?!trusted.registry.com)</match>
    <group>Suspicious Downloads</group>
    <mitre>
      <id>T1587.001</id>
    </mitre>
  </rule>
  <rule id="101256" level="8">
    <description>Detects startup of containers with privileged access</description>
    <match>docker run.*--privileged</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101257" level="7">
    <description>Detects use of custom entrypoint scripts from unapproved sources</description>
    <match>docker run.*-v /path/to/suspicious_script:/entrypoint.sh</match>
    <group>Suspicious Behavior</group>
    <mitre>
      <id>T1543.003</id>
    </mitre>
  </rule>
  <rule id="101258" level="6">
    <description>Detects containers starting with sensitive environment variables</description>
    <match>docker run.*-e (AWS_ACCESS_KEY_ID|AWS_SECRET_ACCESS_KEY)</match>
    <group>Sensitive Data Exposure</group>
    <mitre>
      <id>T1552.001</id>
    </mitre>
  </rule>
  <rule id="101259" level="5">
    <description>Detects containers being run with host network mode</description>
    <match>docker run.*--network host</match>
    <group>Network Misconfiguration</group>
    <mitre>
      <id>T1021.004</id>
    </mitre>
  </rule>
  <rule id="101260" level="4">
    <description>Detects creation of a new IAM policy with admin privileges</description>
    <match>\{&quot;eventName&quot;: &quot;CreatePolicy&quot;, .*&quot;policyDocument&quot;: &quot;.*iam:.*AdminAccess.*&quot;\}</match>
    <group>IAM Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101261" level="5">
    <description>Detects attaching an existing high-privilege policy to a user or role</description>
    <match>\{&quot;eventName&quot;: &quot;AttachUserPolicy&quot;, .*&quot;policyArn&quot;: &quot;.*iam::aws:policy/AdministratorAccess&quot;\}</match>
    <group>IAM Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101262" level="5">
    <description>Detects the creation of an access key for the root account</description>
    <match>\{&quot;eventName&quot;: &quot;CreateAccessKey&quot;, .*&quot;userName&quot;: &quot;root&quot;\}</match>
    <group>IAM Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101263" level="4">
    <description>Detects modification of IAM policy to include wildcard permissions</description>
    <match>\{&quot;eventName&quot;: &quot;PutUserPolicy&quot;, .*&quot;policyDocument&quot;: &quot;.*\*&quot;\}</match>
    <group>IAM Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101264" level="4">
    <description>Detects the assignment of an inline policy granting full access to a user</description>
    <match>\{&quot;eventName&quot;: &quot;PutUserPolicy&quot;, .*&quot;policyDocument&quot;: &quot;.*Action&quot;:\[&quot;*\&quot;]&quot;,&quot;Effect&quot;:&quot;Allow&quot;,&quot;Resource&quot;:&quot;\*&quot;\}</match>
    <group>IAM Privilege Escalation</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>
  <rule id="101265" level="5">
    <description>Detects brute force login attempts on MySQL server.</description>
    <match>Access denied for user .*@.* \(using password: YES\)</match>
    <group>Authentication</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>
  <rule id="101266" level="4">
    <description>Identifies SQL injection attempts in MySQL queries.</description>
    <match>(SELECT .* FROM .* WHERE .*='.*' OR '1'='1')|(UNION SELECT .* FROM .* WHERE .*)</match>
    <group>Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="101267" level="4">
    <description>Monitors for unauthorized data export operations.</description>
    <match>SELECT .* INTO OUTFILE .*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="101268" level="3">
    <description>Detects the creation of new MySQL administrative accounts.</description>
    <match>GRANT ALL PRIVILEGES ON .* TO '.*'@'.*' IDENTIFIED BY '.*'</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101269" level="3">
    <description>Detects the use of suspicious or unauthorized MySQL commands.</description>
    <match>(DROP DATABASE .*)|(DROP TABLE .*)</match>
    <group>Command Execution</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="101270" level="9">
    <description>Detects HTTP GET flood attacks by monitoring for a high volume of GET requests from a single IP address within a short time frame.</description>
    <match>^GET .* HTTP/1.1$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499.001</id>
    </mitre>
  </rule>
  <rule id="101271" level="9">
    <description>Detects HTTP POST flood attacks by monitoring for a high volume of POST requests from a single IP address within a short time frame.</description>
    <match>^POST .* HTTP/1.1$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499.002</id>
    </mitre>
  </rule>
  <rule id="101272" level="8">
    <description>Detects Slowloris attacks by monitoring for incomplete HTTP headers that are sent slowly to keep connections open.</description>
    <match>^GET .* HTTP/1.1
(.*
)*$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499.003</id>
    </mitre>
  </rule>
  <rule id="101273" level="7">
    <description>Detects DNS amplification attacks by monitoring for large volumes of DNS response traffic to a single IP address.</description>
    <match>^.*:53 -&gt; .*:.*$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499.004</id>
    </mitre>
  </rule>
  <rule id="101274" level="8">
    <description>Detects SYN flood attacks by monitoring for a high volume of SYN packets without corresponding ACK responses from a single IP address.</description>
    <match>^.*: SYN .* -&gt; .*:.*$</match>
    <group>DDoS</group>
    <mitre>
      <id>T1499.005</id>
    </mitre>
  </rule>
  <rule id="101275" level="9">
    <description>Detects unauthorized dumping of the entire database using 'db.copyDatabase' command</description>
    <match>db\.copyDatabase\s*\(</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101276" level="8">
    <description>Identifies use of 'db.collection.find' with excessive data retrieval, indicating potential data exfiltration</description>
    <match>db\.[a-zA-Z0-9_]+\.find\s*\(\s*\{[^\}]*\}\s*\)\s*\.limit\s*\(\s*10000\s*\)</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101277" level="7">
    <description>Flags 'db.collection.aggregate' queries with suspicious stages that could indicate data aggregation for exfiltration</description>
    <match>db\.[a-zA-Z0-9_]+\.aggregate\s*\(\s*\[\s*\{\s*\$match\s*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101278" level="8">
    <description>Detects unauthorized user creation with 'db.createUser' command, which may precede data exfiltration</description>
    <match>db\.createUser\s*\(</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101279" level="9">
    <description>Identifies suspiciously large data exports using 'mongoexport' command</description>
    <match>mongoexport\s+--db\s+[a-zA-Z0-9_]+\s+--collection\s+[a-zA-Z0-9_]+\s+--out\s+</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="101280" level="5">
    <description>Detects abnormal spike in network traffic between Kubernetes pods indicating a potential DDoS attack</description>
    <match>.*network traffic spike.*</match>
    <group>Network Anomaly</group>
    <mitre>
      <id>T1499</id>
    </mitre>
  </rule>
  <rule id="101281" level="4">
    <description>Monitors for unauthorized access attempts between Kubernetes pods suggesting potential lateral movement</description>
    <match>.*unauthorized access.*</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101282" level="4">
    <description>Detects unusual DNS queries from Kubernetes pods which may indicate DNS tunneling</description>
    <match>.*unusual DNS queries.*</match>
    <group>Exfiltration</group>
    <mitre>
      <id>T1071.004</id>
    </mitre>
  </rule>
  <rule id="101283" level="4">
    <description>Monitors for abnormal data transfer volumes between Kubernetes pods indicating potential data exfiltration</description>
    <match>.*abnormal data transfer.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="101284" level="5">
    <description>Detects unexpected communication with external IP addresses from Kubernetes pods suggesting potential command and control</description>
    <match>.*unexpected external communication.*</match>
    <group>Command and Control</group>
    <mitre>
      <id>T1071.001</id>
    </mitre>
  </rule>
  <rule id="101285" level="9">
    <description>Detects unauthorized user creation indicating a potential privilege escalation attempt.</description>
    <match>CREATE\s+USER\s+.*</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101286" level="8">
    <description>Monitors for modifications to critical tables which may indicate data tampering or integrity violations.</description>
    <match>ALTER\s+TABLE\s+(.*critical_table.*|.*sensitive_data.*)</match>
    <group>Data Tampering</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="101287" level="9">
    <description>Detects attempts to disable or modify logging configurations, which can indicate log tampering to cover tracks.</description>
    <match>SET\s+GLOBAL\s+general_log\s*=\s*OFF</match>
    <group>Log Tampering</group>
    <mitre>
      <id>T1070</id>
    </mitre>
  </rule>
  <rule id="101288" level="8">
    <description>Detects bulk data export operations that may indicate data exfiltration.</description>
    <match>SELECT\s+.*\s+INTO\s+OUTFILE\s+.*</match>
    <group>Data Exfiltration</group>
    <mitre>
      <id>T1048</id>
    </mitre>
  </rule>
  <rule id="101289" level="7">
    <description>Monitors for unauthorized changes to database user passwords, indicating potential account compromise.</description>
    <match>SET\s+PASSWORD\s+FOR\s+.*</match>
    <group>Account Compromise</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101290" level="5">
    <description>Detects attempts to access the Docker socket by unauthorized users</description>
    <match>(/var/run/docker.sock|/run/docker.sock)</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101291" level="4">
    <description>Detects suspicious Docker command executions such as creating privileged containers</description>
    <match>docker (run|create).*(--privileged|--cap-add=SYS_ADMIN)</match>
    <group>Suspicious Command Execution</group>
    <mitre>
      <id>T1203</id>
    </mitre>
  </rule>
  <rule id="101292" level="4">
    <description>Detects modifications to Docker daemon configuration files</description>
    <match>(/etc/docker/daemon.json|/etc/docker/docker.conf)</match>
    <group>Configuration Change</group>
    <mitre>
      <id>T1036</id>
    </mitre>
  </rule>
  <rule id="101293" level="5">
    <description>Detects unauthorized access to Docker API endpoints</description>
    <match>(POST|GET|DELETE|PUT) /v[0-9.]+/(containers|images|volumes|networks)</match>
    <group>Unauthorized API Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101294" level="3">
    <description>Detects execution of Docker images from untrusted registries</description>
    <match>docker (pull|run).*(untrusted-registry|unauthorized-registry)</match>
    <group>Untrusted Source</group>
    <mitre>
      <id>T1195</id>
    </mitre>
  </rule>
  <rule id="101295" level="10">
    <description>Detects unauthorized access attempts to Docker socket (docker.sock) which can lead to container escape and host takeover.</description>
    <match>(/var/run/docker.sock)</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1610</id>
    </mitre>
  </rule>
  <rule id="101296" level="9">
    <description>Detects suspicious modifications to Docker configurations which can indicate an attempt to compromise Docker security settings.</description>
    <match>(docker\s+config\s+set|docker\s+update)</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1602</id>
    </mitre>
  </rule>
  <rule id="101297" level="8">
    <description>Detects excessive or unusual Docker exec commands which can be used to gain unauthorized access to running containers.</description>
    <match>(docker\s+exec)</match>
    <group>Command Execution</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>
  <rule id="101298" level="9">
    <description>Detects the creation of privileged containers which can lead to potential container escapes and host compromises.</description>
    <match>(docker\s+run.*--privileged)</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101299" level="7">
    <description>Detects network connections from containers to internal services which can indicate lateral movement attempts within the Docker network.</description>
    <match>(docker\s+network\s+connect|docker\s+network\s+create)</match>
    <group>Lateral Movement</group>
    <mitre>
      <id>T1021</id>
    </mitre>
  </rule>
  <rule id="101300" level="9">
    <description>Detects basic SQL injection attempt with tautology 'OR 1=1'</description>
    <match>('.+\s+OR\s+1\s*=\s*1.*')</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="101301" level="8">
    <description>Detects SQL injection attempt with UNION SELECT to extract data</description>
    <match>(UNION\s+SELECT\s+.*\s+FROM\s+.*)</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="101302" level="7">
    <description>Detects SQL injection attempt using stacked queries</description>
    <match>('.+;\s*DROP\s+TABLE.*')</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="101303" level="8">
    <description>Detects SQL injection attempt with comment sequence to bypass authentication</description>
    <match>('.+--\s*$')</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="101304" level="9">
    <description>Detects blind SQL injection using time delay functions</description>
    <match>(SLEEP\(\d+\)|BENCHMARK\(\d+,.*\))</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="101305" level="5">
    <description>Detect unauthorized modifications to Kubernetes ConfigMaps</description>
    <match>kubectl apply.*configmap</match>
    <group>Unauthorized Modification</group>
    <mitre>
      <id>T1003</id>
    </mitre>
  </rule>
  <rule id="101306" level="5">
    <description>Detect unauthorized changes to Kubernetes Secrets</description>
    <match>kubectl apply.*secret</match>
    <group>Unauthorized Modification</group>
    <mitre>
      <id>T1552</id>
    </mitre>
  </rule>
  <rule id="101307" level="4">
    <description>Detect unauthorized modifications to Kubernetes Network Policies</description>
    <match>kubectl apply.*networkpolicy</match>
    <group>Unauthorized Modification</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101308" level="4">
    <description>Detect unauthorized changes to Kubernetes RoleBindings</description>
    <match>kubectl apply.*rolebinding</match>
    <group>Unauthorized Modification</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101309" level="3">
    <description>Detect suspicious modifications to Kubernetes Service Accounts</description>
    <match>kubectl apply.*serviceaccount</match>
    <group>Suspicious Modification</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101310" level="5">
    <description>Detect unauthorized changes to the Windows Security Center service registry key</description>
    <match>HKLM\\SYSTEM\\CurrentControlSet\\Services\\wscsvc</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1088</id>
    </mitre>
  </rule>
  <rule id="101311" level="5">
    <description>Detect modifications to the Windows Defender registry key</description>
    <match>HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1562.001</id>
    </mitre>
  </rule>
  <rule id="101312" level="4">
    <description>Identify unauthorized changes to the User Account Control (UAC) registry settings</description>
    <match>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\EnableLUA</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1548.002</id>
    </mitre>
  </rule>
  <rule id="101313" level="4">
    <description>Monitor for changes to the registry key controlling Windows Firewall settings</description>
    <match>HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1562.004</id>
    </mitre>
  </rule>
  <rule id="101314" level="3">
    <description>Detect alterations to the registry key for automatic logon settings</description>
    <match>HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AutoAdminLogon</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="101315" level="5">
    <description>Detects use of encoded PowerShell commands which can be used to obfuscate malicious scripts.</description>
    <match>powershell.exe\s+-e\s+[A-Za-z0-9+/=]+</match>
    <group>Execution</group>
    <mitre>
      <id>T1059.001</id>
    </mitre>
  </rule>
  <rule id="101316" level="4">
    <description>Detects execution of PowerShell scripts from the command line which is uncommon in regular user activity.</description>
    <match>powershell.exe\s+-File\s+.+\.ps1</match>
    <group>Execution</group>
    <mitre>
      <id>T1059.001</id>
    </mitre>
  </rule>
  <rule id="101317" level="4">
    <description>Detects attempts to bypass PowerShell execution policy which can be used to run unsigned scripts.</description>
    <match>powershell.exe\s+-ExecutionPolicy\s+Bypass</match>
    <group>Defense Evasion</group>
    <mitre>
      <id>T1086</id>
    </mitre>
  </rule>
  <rule id="101318" level="5">
    <description>Detects downloading and executing PowerShell scripts from remote locations.</description>
    <match>powershell.exe\s+-Command\s+\&quot;\s*\$wc=New-Object\s+System.Net.WebClient;\s*\$wc.DownloadFile\(</match>
    <group>Execution</group>
    <mitre>
      <id>T1204.001</id>
    </mitre>
  </rule>
  <rule id="101319" level="4">
    <description>Detects suspicious use of PowerShell to access Windows Management Instrumentation (WMI).</description>
    <match>powershell.exe\s+-Command\s+Get-WmiObject\s+.*</match>
    <group>Discovery</group>
    <mitre>
      <id>T1047</id>
    </mitre>
  </rule>
  <rule id="101320" level="9">
    <description>Detects the unauthorized stopping of multiple EC2 instances in a short period of time, which could indicate a denial-of-service attack.</description>
    <match>StopInstances\s.*\s--instance-ids</match>
    <group>Denial of Service</group>
    <mitre>
      <id>T1489</id>
    </mitre>
  </rule>
  <rule id="101321" level="8">
    <description>Identifies unauthorized API calls attempting to start an EC2 instance, which may indicate compromised credentials.</description>
    <match>RunInstances\s.*\s--image-id</match>
    <group>Credential Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101322" level="7">
    <description>Detects unusual patterns in EC2 instance starts, such as instances being started outside of normal business hours or from unusual IP addresses.</description>
    <match>RunInstances\s.*\s--subnet-id</match>
    <group>Anomalous Activity</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101323" level="6">
    <description>Monitors for attempts to modify EC2 instance metadata or configurations without proper authorization.</description>
    <match>ModifyInstanceAttribute\s.*\s--instance-id</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101324" level="5">
    <description>Flags unauthorized attempts to terminate EC2 instances, which could disrupt services and lead to data loss.</description>
    <match>TerminateInstances\s.*\s--instance-ids</match>
    <group>Service Disruption</group>
    <mitre>
      <id>T1485</id>
    </mitre>
  </rule>
  <rule id="101325" level="9">
    <description>Detect unauthorized access attempts to Docker socket.</description>
    <match>docker.sock.*permission denied</match>
    <group>Unauthorized Access</group>
    <mitre>
      <id>T1078</id>
    </mitre>
  </rule>
  <rule id="101326" level="8">
    <description>Identify abnormal Docker container starts indicating potential compromise.</description>
    <match>docker run.*--privileged</match>
    <group>Privilege Escalation</group>
    <mitre>
      <id>T1068</id>
    </mitre>
  </rule>
  <rule id="101327" level="7">
    <description>Monitor for changes to critical Docker configuration files.</description>
    <match>chmod.*docker.*config</match>
    <group>Configuration Tampering</group>
    <mitre>
      <id>T1082</id>
    </mitre>
  </rule>
  <rule id="101328" level="8">
    <description>Detect attempts to stop or remove critical Docker containers.</description>
    <match>docker (stop|rm) .*critical-container</match>
    <group>Denial of Service</group>
    <mitre>
      <id>T1489</id>
    </mitre>
  </rule>
  <rule id="101329" level="7">
    <description>Identify unauthorized network connections from Docker containers.</description>
    <match>docker network connect.*unauthorized-network</match>
    <group>Network Intrusion</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101330" level="10">
    <description>Detects HTTP requests attempting to exploit the Apache Struts vulnerability (CVE-2017-5638) via malicious Content-Type header.</description>
    <match>.*Content-Type:.*multipart/form-data.*(\${.*:.*}).*</match>
    <group>Apache Struts Exploit</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>
  <rule id="101331" level="9">
    <description>Detects suspicious HTTP requests aiming to exploit the Apache HTTP Server Path Traversal vulnerability (CVE-2021-41773).</description>
    <match>.*GET.*(\\..\\).*</match>
    <group>Path Traversal</group>
    <mitre>
      <id>T1006</id>
    </mitre>
  </rule>
  <rule id="101332" level="10">
    <description>Detects HTTP requests attempting to perform a Remote Code Execution (RCE) by exploiting Apache Log4j vulnerability (CVE-2021-44228).</description>
    <match>.*\$\{jndi:ldap://.*\}.*</match>
    <group>Remote Code Execution</group>
    <mitre>
      <id>T1210</id>
    </mitre>
  </rule>
  <rule id="101333" level="8">
    <description>Detects HTTP requests with SQL injection patterns targeting Apache web applications.</description>
    <match>.*\b(SELECT|UNION|INSERT|UPDATE|DELETE|DROP)\b.*</match>
    <group>SQL Injection</group>
    <mitre>
      <id>T1505</id>
    </mitre>
  </rule>
  <rule id="101334" level="7">
    <description>Detects HTTP requests attempting to exploit the Apache HTTP Server mod_proxy vulnerability (CVE-2016-5387) via Proxy header injection.</description>
    <match>.*Proxy:.*</match>
    <group>Proxy Injection</group>
    <mitre>
      <id>T1071</id>
    </mitre>
  </rule>
  <rule id="101335" level="9">
    <description>Detects execution of suspicious PowerShell scripts via scheduled tasks, commonly used by malware.</description>
    <match>.*(schtasks.exe.*powershell.exe).*</match>
    <group>Malware Execution</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="101336" level="8">
    <description>Identifies creation of scheduled tasks with obfuscated command lines, often used to evade detection.</description>
    <match>.*(schtasks.exe.*\s/c\s.*&quot;\s*\w{20,}&quot;).*</match>
    <group>Evasion</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="101337" level="7">
    <description>Detects the use of schtasks.exe to run executables from unusual directories, indicating potential malware.</description>
    <match>.*(schtasks.exe.*\\AppData\\|\\Temp\\|\\ProgramData\\).*</match>
    <group>Persistence</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="101338" level="8">
    <description>Monitors scheduled tasks that include encoded commands, a technique used to hide malicious activity.</description>
    <match>.*(schtasks.exe.*-encodedCommand).*</match>
    <group>Obfuscation</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
  <rule id="101339" level="9">
    <description>Detects modification of existing scheduled tasks, which may indicate an attempt to gain persistence.</description>
    <match>.*(schtasks.exe.*\/change).*</match>
    <group>Persistence</group>
    <mitre>
      <id>T1053.005</id>
    </mitre>
  </rule>
</group>